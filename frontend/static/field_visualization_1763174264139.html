<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Field Visualization - displacement</title>
<style>
body {
	margin: 0;
	padding: 0;
	background-color: #1a1a1a;
	font-family: 'Courier New', monospace;
	overflow: hidden;
}

#container {
	width: 100vw;
	height: 100vh;
	position: relative;
}

#vtk-container {
	display: block;
	width: 100%;
	height: 100%;
	background: #1a1a1a;
}

#info {
	position: absolute;
	top: 10px;
	left: 10px;
	background: rgba(0, 0, 0, 0.8);
	color: white;
	padding: 10px;
	border-radius: 5px;
	font-size: 12px;
	z-index: 100;
}

#controls {
	position: absolute;
	top: 10px;
	right: 10px;
	background: rgba(0, 0, 0, 0.9);
	color: #00ff00;
	padding: 10px;
	border-radius: 5px;
	font-size: 12px;
	z-index: 100;
	width: 200px;
}

.control-group {
	margin-bottom: 6px;
}

.control-group label {
	display: block;
	margin-bottom: 3px;
	color: #00ff00;
	font-size: 10px;
}

.control-group input, .control-group select {
	width: 100%;
	padding: 2px;
	background: #001100;
	color: #00ff00;
	border: 1px solid #00ff00;
	border-radius: 2px;
}

#time-controls .time-row {
	display: flex;
	align-items: center;
	gap: 6px;
	margin-top: 4px;
}

#time-controls .time-row:first-of-type {
	margin-top: 0;
}

#time-slider {
	flex: 1;
}

#time-display {
	min-width: 90px;
	font-weight: bold;
	font-size: 11px;
	color: #00ff00;
}

#playback-speed {
	width: auto;
}

#loop-toggle {
	margin-left: 4px;
}

.btn {
	padding: 4px 8px;
	margin: 2px;
	border: 1px solid #00ff00;
	border-radius: 2px;
	background: #001100;
	color: #00ff00;
	cursor: pointer;
	font-size: 10px;
	transition: all 0.2s ease;
}

.btn:hover {
	background: #003300;
	border: 2px solid #00ff00;
}

.btn-secondary {
	background: #001100;
	color: #00ff00;
}

.btn-primary {
	background: #003300;
	color: #00ff00;
}

#view-controls {
	display: flex;
	gap: 5px;
	width: 100%;
}

#view-controls .btn {
	flex: 1;
	width: 100%;
	padding: 4px;
	background: #001100;
	color: #00ff00;
	border: 1px solid #00ff00;
	border-radius: 2px;
	cursor: pointer;
	font-size: 10px;
	transition: all 0.2s ease;
}

#view-controls .btn:hover {
	background: #003300;
	border: 2px solid #00ff00;
}

#colorbar {
	position: absolute;
	left: 10px;
	bottom: 10px;
	width: 200px;
	height: 20px;
	background: rgba(0, 0, 0, 0.8);
	border-radius: 5px;
	z-index: 100;
}

#colorbar-gradient {
	width: 100%;
	height: 100%;
	border-radius: 5px;
}

#colorbar-labels {
	position: absolute;
	left: 0;
	bottom: 25px;
	width: 200px;
	height: 20px;
	display: flex;
	flex-direction: row;
	justify-content: space-between;
	align-items: center;
	color: white;
	font-size: 10px;
}

#loading {
	position: absolute;
	top: 50%;
	left: 50%;
	transform: translate(-50%, -50%);
	color: white;
	font-size: 18px;
	z-index: 200;
}

#error {
	position: absolute;
	top: 50%;
	left: 50%;
	transform: translate(-50%, -50%);
	color: #ff4444;
	font-size: 16px;
	text-align: center;
	z-index: 200;
}
</style>
</head>
<body>
<div id="container">
<div id="loading">Loading field visualization...</div>
<div id="error" style="display: none;"></div>
<div id="info">
<div><strong>Field: displacement</strong></div>
<div>Units: m</div>
<div>Min: <span id="field-min">-</span></div>
<div>Max: <span id="field-max">-</span></div>
<div>Mean: <span id="field-mean">-</span></div>
</div>
<div id="controls">
<div class="control-group">
<label>Field Display:</label>
<select id="field-display-select" onchange="changeFieldDisplay(this.value)">
<option value="none">None (Mesh Only)</option>
<option value="field" selected>displacement Field</option>
</select>
</div>
<div class="control-group">
<label>Representation:</label>
<select id="representation-select" onchange="changeRepresentation(this.value);">
<option value="0">Points</option>
<option value="1">Wireframe</option>
<option value="2" id="surface-option">Surface</option>
</select>
</div>
<div class="control-group" id="view-controls" style="display: none;">
<button id="surfaceViewBtn" onclick="showSurfaceView()" class="btn btn-secondary">Surface View</button>
<button id="volumeViewBtn" onclick="showVolumeView()" class="btn btn-secondary">Volume View</button>
</div>
<div class="control-group">
    <button id="fit-view" class="btn btn-secondary" style="width: 100%;" onclick="fitToView();">Fit to View</button>
</div>
<div class="control-group" id="time-controls" style="display: none;">
<label>Time Controls:</label>
<div class="time-row">
	<button id="play-pause-btn" class="btn btn-secondary" onclick="togglePlayback()">Play</button>
	<button id="step-backward-btn" class="btn btn-secondary" onclick="stepBackward()">Prev</button>
	<button id="step-forward-btn" class="btn btn-secondary" onclick="stepForward()">Next</button>
</div>
<div class="time-row">
	<input type="range" id="time-slider" min="0" max="0" value="0" step="1" onchange="onTimeSliderChange(this.value)" />
</div>
<div class="time-row">
	<span id="time-display">t = 0.000</span>
	<select id="playback-speed" onchange="updatePlaybackSpeed(this.value)">
		<option value="0.25">0.25x</option>
		<option value="0.5">0.5x</option>
		<option value="1" selected>1x</option>
		<option value="2">2x</option>
		<option value="4">4x</option>
	</select>
	<label style="display: flex; align-items: center; gap: 4px; font-size: 10px;">
		<input type="checkbox" id="loop-toggle" onchange="toggleLoop(this.checked)" />
		Loop
	</label>
</div>
<div class="time-row">
	<button id="steady-state-btn" class="btn btn-primary" style="width: 100%;" onclick="showSteadyState()">Show Steady-State</button>
</div>
</div>
</div>
<div id="colorbar" style="display: none;">
<div id="colorbar-gradient"></div>
<div id="colorbar-labels">
<span id="max-label">Max</span>
<span id="min-label">Min</span>
</div>
</div>
<div id="vtk-container"></div>
</div>

<script src="/static/js/vtk.js" onerror="console.error('Failed to load VTK.js script');"></script>
<script>
// Lightweight logging (disabled by default for clean console)
const DEBUG = false;
const log = (...args) => { if (DEBUG) console.log(...args); };
// Data
const meshData = {"vertices": [[0.6017861799438448, 0.0007380013577569334, 5.67119175140199], [-0.6769136646659963, 0.03483060860412979, 5.5711896802598995], [0.6027989961072883, 0.10326749118366936, 5.702755556328057], [-0.6759034310874935, 0.1323007716597473, 5.602755762814708], [1.9910336447488581, -0.10450949078238242, -0.8612584720495328], [1.920008247079984, -0.0897324729624645, -0.9612584720788144], [1.9990485079625984, -0.0045094907343654345, -0.846481454281849], [1.9280231102907466, 0.010267527018550243, -0.946481454276491], [-0.03756392637966046, 0.01778490463578031, 5.619078130797167], [0.602769643924284, 0.05200269064893993, 5.687126223372208], [-0.03655186334455992, 0.11778407394880185, 5.650642683634364], [-0.676886953344376, 0.08356600832630606, 5.587126806509401], [1.9555209459219212, -0.09712098186360932, -0.9112584720700772], [1.9950410763646895, -0.05450949075578679, -0.8538699631755289], [1.9635358091261093, 0.0028790181411879334, -0.8964814542851749], [1.9240156786829292, -0.03973247297138888, -0.9538699631787696], [-0.41577304566961276, 0.04057074829850932, 3.073030482371098], [-0.03562176906211567, 0.047764422796338524, 1.0577586056177768], [0.45425628183348066, 0.04726455671734221, 0.0013092864662136478], [0.7202131687586529, 0.006247636245294424, -0.10837158399396712], [0.9200065731121859, -0.0095721051705035, -0.25100403471200594], [1.120008216879979, -0.02561284386289655, -0.3930554035105046], [1.3200082413570107, -0.04164326698343007, -0.5351060922827533], [1.5200082462441036, -0.05767301957456856, -0.6771568811156937], [1.7200082470715112, -0.07370274649003679, -0.8192076767470757], [-0.5585887739279648, 0.03702292126181976, 4.290698168077095], [-0.2376113825507481, 0.04404011066374587, 1.9755098272056515], [0.20008641045212944, 0.048314395875434464, 0.3829317747896498], [0.6150773001080134, 0.017176810510626223, -0.04770752497313428], [0.8199807918581933, -0.0016728402757522627, -0.17983448909314942], [1.0200069177300348, -0.01759988876594841, -0.32202792324066354], [1.2200081767794246, -0.03362846502349344, -0.46408057982268097], [1.420008243568657, -0.04965816100335939, -0.6061314747061097], [1.620008246879688, -0.06568788347977464, -0.748182278796991], [1.820008247075079, -0.08171760976665386, -0.8902330743815642], [0.7406347359945675, -0.009043557916933061, 3.173059911232357], [0.7605195614357105, -0.01990564268785317, 1.1586520462383219], [0.6607736511914516, -0.01942851979709916, 0.11604689499959812], [0.7925153380760621, -0.010474678246390845, -0.008218244579544537], [0.9910537819079278, -0.0244325802226383, -0.15096130657589166], [1.1910342410642853, -0.04039421721606637, -0.2930528982952457], [1.3910336716067442, -0.056420470382901135, -0.4351059672162165], [1.5910336478626228, -0.07245004429926101, -0.5771568758234731], [1.791033644811035, -0.08847976460849598, -0.7192076764918413], [0.6834607398442307, -0.0034767636311319075, 4.390698677065678], [0.7624998963909511, -0.014534723712311104, 2.0755284539684644], [0.7227873296804437, -0.025324965504403642, 0.4806637326407245], [0.6944335107733729, -0.002588091531536972, 0.054116319737439564], [0.8912859865879543, -0.016426311438988032, -0.07998672428735618], [1.0910393890340777, -0.032375566603391984, -0.22202923903170693], [1.2910339625204694, -0.04840548167841952, -0.364080614326196], [1.4910336591087192, -0.06443517759987195, -0.50613147751421], [1.6910336456646422, -0.08046490122077224, -0.6481822788383741], [1.8910336447854348, -0.09649462754419287, -0.7902330743891953], [-0.4147644701818502, 0.12250041350200161, 3.1046131223559366], [-0.034644052106822254, 0.11096479027551023, 1.0897598123005385], [0.4571655654844262, 0.09869006674113348, 0.04004682208894477], [0.7278147221389993, 0.10600665956630999, -0.09211671188493868], [0.9280151875767645, 0.09038715248691333, -0.23617221996277377], [1.1280227838928971, 0.07438438316123402, -0.3782760983568739], [1.3280230908505857, 0.05835661838052202, -0.5203289782785643], [1.5280231075675226, 0.04232697629355739, -0.6623798597521754], [1.7280231102508743, 0.02629725328754319, -0.8044306587925447], [-0.557575740474516, 0.12808647288426833, 4.322262205592064], [-0.23656751474135684, 0.11701553572844794, 2.0070729384191486], [0.20207984246621852, 0.10812810062653319, 0.4139920074004334], [0.6232749254013464, 0.11162607704881458, -0.03183705519073935], [0.8278337351766681, 0.09845219224684199, -0.16504897280168296], [1.0280182091611016, 0.08240111762348432, -0.30725119899846215], [1.2280228320629294, 0.06637150863080488, -0.4493035575686721], [1.428023097650212, 0.050341839440120745, -0.5913544575869021], [1.6280231095176056, 0.03431211656033936, -0.7334052610243642], [1.8280231102694344, 0.018282390235724463, -0.8754560566004446], [0.7416534709794873, 0.10900282891085437, 3.2046212457842627], [0.7616734864473678, 0.11582784790120784, 1.1902012541957523], [0.6630864870696936, 0.12211999606757301, 0.13741475433338268], [0.8000821549367145, 0.09342092478851363, 0.005069990381292369], [0.9990547321426395, 0.07569753827166878, -0.1362348255703714], [1.199048636221693, 0.05961185281382001, -0.2782780278180075], [1.399048516673085, 0.043579791166795716, -0.42032904073944666], [1.5990485090496336, 0.027549965580339314, -0.5623798614880307], [1.7990485079870486, 0.011520235841135554, -0.7044306588763343], [0.6844731318365248, 0.10545745383038435, 4.422262954852105], [0.7635243680992749, 0.1124511110529089, 2.1070975174701085], [0.723825534175315, 0.12026399249403424, 0.5109371803785642], [0.7035426655525057, 0.1038709281295061, 0.06942630285777693], [0.8991494290657347, 0.08367437926112721, -0.06523400707328578], [1.0990506415756778, 0.06762297448338914, -0.20725196589938957], [1.2990486177552287, 0.05159449034214242, -0.34930359903106845], [1.4990485133068314, 0.03556482048777014, -0.4913544590638419], [1.6990485083197409, 0.019535098744921875, -0.6334052610280806], [1.8990485079780122, 0.0035053724482183163, -0.7754560566037407], [-0.03705762305324815, 0.06778448163309, 5.634107770321985], [0.2808397669332608, 0.034467849453889365, 5.65233416707578], [-0.35546073336222395, 0.05110119170742208, 5.602333589980759], [0.2813460817547187, 0.08531947628727664, 5.668116274145296], [-0.35495508074688503, 0.10024914285191873, 5.618116438480977], [1.9595283775269978, -0.0471209818615808, -0.9038699631793473], [1.939768312303022, -0.06842672741330408, -0.932564217628381], [1.9752810111450936, -0.07581523631699366, -0.8825642176180528], [1.9792884427483919, -0.025815236300883185, -0.8751757087315104], [1.943775743905624, -0.01842672741869822, -0.9251757087306721], [1.8555209459231705, -0.08910611865873469, -0.8402330743814039], [0.6541463557043015, 0.009782405022912973, 0.00024712297056760785], [1.2555209719559883, -0.041017016059749674, -0.4140805215932392], [1.655520946007449, -0.07307639235631089, -0.6981822789725993], [0.06243668087667409, 0.016771846151303924, 4.338472971548082], [0.4634266359846887, 0.012941820818783482, 0.4189058020297369], [0.26242715282656204, 0.014714898903751194, 2.0187825330613007], [0.8555008329810325, -0.008923771024941194, -0.12987624133772951], [1.4555209468232457, -0.057046670407686864, -0.5561314731470204], [1.0555213901741622, -0.024988292231691682, -0.2720270924795307], [-0.30283827244181727, 0.026355679370540428, 4.948672008498449], [0.3277100461536291, 0.008200623884080006, 4.998671161878589], [0.4127381978194106, 0.004881005180528834, 3.744976508047295], [-0.18786307544590347, 0.027652536802327675, 3.6949713988124944], [1.9232772953452815, -0.09680780470678732, -0.8507457732332802], [1.8877645965044139, -0.08941929581036025, -0.9007457732290384], [1.8232772953574365, -0.08879294154121138, -0.7797203754988198], [1.7877645964930367, -0.08140443260951395, -0.8297203755423324], [0.08741849327471074, 0.029990417132555132, 1.5116991580869008], [-0.05762121993960018, 0.028809488497649666, 2.5241749151647226], [0.16242542172507005, 0.01576823437098724, 3.118307855506334], [0.4824606368827632, 0.0016731357298151275, 2.5741458049859625], [0.42233400346309047, 0.03256001073979653, 0.16919325847754674], [0.24733121516294593, 0.03132295091274657, 0.701497719383891], [0.36236353149992934, 0.013845021067475519, 1.0992146696279017], [0.5772189092565863, -0.00514345832637034, 0.7503171886166202], [0.5375293540932461, -0.0014672477990672853, 1.5619010080711], [0.6885404372991093, 0.006320725618372, -0.05065382299210847], [0.5696061982568721, 0.023295054215824867, -0.0021329312158302957], [0.5602340616749146, 0.014016583756701182, 0.06604689499959812], [0.6393368620134261, 0.007116214403273629, 0.05162728290599981], [0.6033756998773092, -0.00516376462549233, 0.22137495231970228], [0.887770502857647, -0.009278688299171063, -0.1904736109816296], [0.7877678870458875, -0.0013442663800991841, -0.11914725272214655], [0.7555642436139104, -0.0010039033314971008, -0.05879244740511379], [0.7225332973794945, -0.0013629524110097633, -0.0002951670586569255], [0.8235727403673129, -0.008991163508039217, -0.06936509418753023], [1.087765175036153, -0.025300878637367016, -0.33254149032463004], [0.9877629576916503, -0.01728661986430285, -0.2615137678326233], [0.9555228876805724, -0.016984683153700244, -0.20099447173761692], [0.9232944810116728, -0.016646275635815874, -0.1404491213558162], [1.02328385364717, -0.024685510478108734, -0.21150908910504185], [1.2877646291007174, -0.04133014167110217, -0.4745933083374776], [1.187764518501126, -0.03331531913261136, -0.4035678345521303], [1.1555211876943194, -0.03300285708729106, -0.3430546702808722], [1.223277527557859, -0.0407043952114106, -0.35356743770924964], [1.123278403053768, -0.032688756500725384, -0.28254204505147873], [1.4877645982235677, -0.05735984538282642, -0.6166441762270931], [1.3877645911171348, -0.04934498429389178, -0.5456187747135158], [1.3555209566812894, -0.04903182628622024, -0.4851060567953332], [1.3232773635758086, -0.0487186289599686, -0.4245933738155939], [1.4232773039815676, -0.056733517365995065, -0.4956187555081472], [1.68776459655045, -0.07338956936854012, -0.7586949778487299], [1.5877645962218792, -0.06537470619327616, -0.6876695799893119], [1.555520947152939, -0.06506152965029863, -0.6271568795381941], [1.6232772962451547, -0.0727632165772142, -0.6376695790660426], [1.5232772993182895, -0.06474835364514232, -0.5666441798734805], [1.7555209459342076, -0.08109125549932908, -0.7692076766704452], [1.7232772955395774, -0.08077807830616975, -0.7086949779002771], [0.662359792612272, 0.10320404551288624, 0.013979058169362277], [1.2635357612516853, 0.05898293413575928, -0.3993035026556822], [0.06344908185971426, 0.11677258891541502, 4.370036785720738], [0.26344633700307746, 0.11476389912590296, 2.0503459934750614], [0.4644190167004791, 0.11191191952383582, 0.44997023923521634], [0.8635193525429864, 0.090920012984292, -0.11509572431755301], [1.4635358068231517, 0.04295332792591736, -0.5413544553649815], [1.86353580912379, 0.010893881337306718, -0.8254560565969608], [1.0635351159777096, 0.07501003145157162, -0.2572500613034047], [1.6635358090594645, 0.02692360760737765, -0.6834052611814538], [0.3287225540707928, 0.11057447164289615, 5.03023506285689], [-0.3018260686278725, 0.1239831425281843, 4.980235527551122], [0.41375095535747924, 0.11186934806929244, 3.7765407425569975], [-0.1868518008138621, 0.12065929714013232, 3.7265396385848963], [1.8957794597035713, 0.010580704184704512, -0.8859687554464565], [1.9312921585455465, 0.003192195295844344, -0.8359687554442758], [1.8312921585594306, 0.011207058514318274, -0.7649433577478391], [1.7957794596968415, 0.01859556736851395, -0.8149433577297432], [-0.056594179222943186, 0.11747727632720192, 2.555723659764237], [0.0884198999227021, 0.11420206676675311, 1.5433531134413487], [0.1634393183710394, 0.11575183992387714, 3.14987725741118], [0.48348182696960734, 0.11305198395131395, 2.6057101116610397], [0.24860915438531173, 0.11083258967301901, 0.7326357048425811], [0.4242353805434144, 0.1054615112718993, 0.2015451535824227], [0.5385622141043567, 0.11414187261015526, 1.593479738625776], [0.3634143788084478, 0.11360044271518346, 1.1308989658096673], [0.5784250022571176, 0.11566775633063386, 0.7820686219718815], [0.5774805076322044, 0.10037460648327999, 0.016461453866931243], [0.6927241188014432, 0.10484076760711282, -0.036622568633487756], [0.6460035087538959, 0.10642067742927919, 0.06528887169293814], [0.563644417596507, 0.10718650421929296, 0.08173183582412627], [0.6035520076228301, 0.11538251741697943, 0.24948909930878568], [0.7957542495198566, 0.09858654161245244, -0.10405567020053283], [0.8957283384620233, 0.09071260846880377, -0.17573417886806297], [0.7311187870613803, 0.09896022789424734, 0.01367150402798046], [0.7631104260135216, 0.098828497111065, -0.04411105955120312], [0.8315232969876751, 0.09150707270012909, -0.05491950303921356], [0.9957787357672543, 0.08270805532084942, -0.24672674750379278], [1.0957777020387067, 0.07469929689120985, -0.31776623278117644], [0.9312475230712185, 0.08330306737335595, -0.12563329922873828], [0.9635295102336193, 0.08303943181164893, -0.18621552005371717], [1.0312983678608236, 0.07533065953473868, -0.19674076501922744], [1.1957793482448504, 0.0666843233227205, -0.3887903798376999], [1.2957793767761308, 0.058669864549047934, -0.4598163693651665], [1.2312923249781078, 0.059296403732319855, -0.3387908158143375], [1.163535552723438, 0.06699819887734451, -0.3282776052046253], [1.1312910543012102, 0.0673102360193483, -0.2677635233992527], [1.395779453477638, 0.0506550008972222, -0.5308417395623833], [1.4957794556730861, 0.042640155008073326, -0.6018671619625326], [1.331292114611532, 0.05128133623027485, -0.4098162829808877], [1.3635357997657842, 0.05096820568382562, -0.47032903718087743], [1.4312921656077053, 0.0432665169984247, -0.48084175380545674], [1.5957794589637664, 0.03462529293272203, -0.6728925615131894], [1.695779459553284, 0.02661043054819079, -0.7439179601138863], [1.5312921568690094, 0.03525164555439479, -0.5518671587803619], [1.5635358081685211, 0.03493847083660816, -0.6123798617122259], [1.6312921589575482, 0.027236785579503847, -0.6228925619200352], [1.7635358091176252, 0.018908744558480267, -0.754430658884245], [1.731292158546917, 0.019221921703256248, -0.6939179600683603], [1.8240156786753983, -0.031717609767356714, -0.8828445654885263], [1.0240134486016568, 0.03239992333873959, -0.31463876939625474], [0.6244418400314595, 0.0627346149870593, -0.03856232923464972], [1.2240155766214076, 0.01637148283651485, -0.45669200464319043], [-0.5593567007355883, 0.08255437799911343, 4.308817394558162], [-0.2391201750464006, 0.08052452386019246, 1.9980767108222852], [0.20043187550417213, 0.0782960400452326, 0.4071122160968843], [0.8239563621497239, 0.04839855421933194, -0.1725434086434538], [1.4240156742344445, 0.0003418377724398458, -0.598742964694742], [1.624015678517876, -0.015687883380954934, -0.7407937698803935], [-0.6209740062884652, 0.10665096170002866, 4.9493808930659124], [-0.6214798373294077, 0.059470412138516164, 4.933598755941041], [-0.49106191568654056, 0.060291019616476836, 3.6824451645452463], [-0.49055583935176594, 0.10380291136995828, 3.6982295860402807], [1.872011962875985, -0.06072504136790629, -0.9220515187862023], [1.8760193944790906, -0.010725041363402549, -0.9146630098925068], [1.7720119628834068, -0.05271017815369856, -0.8510261210848318], [1.7760193944744849, -0.0027101781922147794, -0.8436376121738013], [-0.3307956517739, 0.06166799800539922, 2.5158772901847395], [-0.1408213201388147, 0.062945925283658, 1.5060683919674511], [-0.41602366220963866, 0.08153840738729853, 3.093297809523133], [-0.3302852597890452, 0.10040939433336922, 2.5316590913231636], [0.0797196937785381, 0.0642161052910943, 0.7001197866210361], [0.32484834479682567, 0.061099276612548936, 0.16609257586056073], [-0.03567607443967835, 0.07942517984435521, 1.0828324734504111], [-0.14030530160963167, 0.09702600828372644, 1.521914370331677], [0.0802808878548168, 0.09384258111450888, 0.7158150536037581], [0.5567593446219085, 0.04865513015033365, -0.018775250030434235], [0.6748832795296246, 0.034985006234864634, -0.0722234829112482], [0.45373905236956535, 0.07366112756888493, -0.01794790090082316], [0.5591454271748115, 0.08634217206804587, -0.008624503387664241], [0.3261787022222336, 0.09236733040762624, 0.18282727630949247], [0.7720305435617929, 0.027304171948110703, -0.14056341163067038], [0.871969594427446, 0.0193981596098399, -0.211784882582491], [0.7241183589456677, 0.056289331664875285, -0.10113118278925028], [0.6770034857228446, 0.08296843278833271, -0.06456925165656481], [0.7758933722610467, 0.07741314307546612, -0.13283330321822695], [0.9720119219180989, 0.011409395778935967, -0.282817084436157], [1.0720105461550928, 0.0033928780057696194, -0.35384790610059574], [0.9240105697679846, 0.04041163510487372, -0.24361104149200122], [0.9760161533245718, 0.06140255847341798, -0.27542164464544505], [0.8759648768824118, 0.06941054683962056, -0.20440471330116172], [1.1720119638331477, -0.00462093437659657, -0.4248734341680361], [1.2720118787126826, -0.012635929740654125, -0.4958990930290604], [1.1240152856307613, 0.024386155776167363, -0.3856663203266951], [1.0760176326061366, 0.05339383428964892, -0.3464593126252198], [1.1760192563544039, 0.04537853413997634, -0.41748463475168157], [1.3720119634904644, -0.020650725753668664, -0.5669245153033872], [1.4720119583844504, -0.028665592960638198, -0.6379499239023595], [1.3240156639980873, 0.00835668996429123, -0.5277175646415356], [1.276019285456742, 0.03736416484579321, -0.4885105907181719], [1.3760193885031045, 0.029349254001470017, -0.5595359937977896], [1.5720119626976108, -0.03668045170748049, -0.7089753255095931], [1.6720119627561958, -0.044695314968300724, -0.7800007234030129], [1.5240156767742914, -0.007673021084597921, -0.6697683716546701], [1.4760193887667363, 0.021334411587949423, -0.6305614152665072], [1.5760193937276612, 0.013319547512280774, -0.7015868158323294], [1.7240156786674423, -0.023702746575482048, -0.8118191677933825], [1.6760193942807955, 0.005304685072558268, -0.772612214486212], [1.0950418898150205, 0.01762293188065507, -0.21463748673520153], [1.2950411166308913, 0.0015944660385619827, -0.3566919667963221], [1.695041076505295, -0.03046490115983004, -0.6407937698607181], [0.7649777667401534, 0.048955463373830124, 2.0980407764384967], [0.7242749235704535, 0.046907164062898875, 0.5079274025856718], [0.8950195898434679, 0.03363184125584484, -0.07246637244302334], [0.6852408883375004, 0.05099015284692819, 4.408815559594349], [1.495041078247832, -0.014435180007100049, -0.4987429632888153], [0.70543490860575, 0.05066298540127216, 0.0806634224333744], [1.8950410763692116, -0.046494627552113685, -0.7828445654857402], [0.6468599593055772, 0.025085462565664136, 5.033598582837891], [0.6473660296271766, 0.07790723673804276, 5.04938069096366], [0.7164351932627613, 0.022244241890831393, 3.782449388699112], [0.7169426432462056, 0.07872507966946408, 3.798231440609679], [1.9470447921753153, -0.025502059156509063, -0.8146630098905243], [1.9430373605716569, -0.07550205914627661, -0.8220515187833581], [1.8430373605736932, -0.0674871959925134, -0.7510261210572063], [1.8470447921632265, -0.017487195916865844, -0.7436376121859554], [0.766108062099691, 0.01564211818903804, 1.6061763558203053], [0.7561787572056339, 0.018806197918607714, 2.61587886472874], [0.7566843539457474, 0.08012779488487763, 2.631662869700387], [0.7419079615565882, 0.04997982332160173, 3.1932990255359135], [0.6940224204514405, 0.012492580880477293, 0.2712008377220688], [0.7462856199916668, 0.01162819417477591, 0.7995235451926302], [0.7666427139569885, 0.08126707047328495, 1.6219650299058812], [0.7617684251806017, 0.04797536765465339, 1.1833147336586205], [0.746683441243978, 0.08281869524893881, 0.8153996115442832], [0.7462674167294205, 0.018489407310735295, 0.031209401840402717], [0.6462036484929116, 0.029380578194516963, 0.0869190072052704], [0.6953995225249304, 0.08399351700575512, 0.2853778595911096], [0.6659426900925368, 0.05373092070503968, 0.14078959872980362], [0.6460035087538959, 0.08418085250547623, 0.0980534809102893], [0.9431000246148469, 0.004692387637375547, -0.11178303945147142], [0.8432501146590263, 0.012229084792760693, -0.04041568554077121], [0.847060685497203, 0.06301635279717477, -0.03336499928793382], [0.7955999103251683, 0.04152366034236095, -0.001405496265867806], [0.7488010308268787, 0.07223451877250259, 0.04178425336644598], [1.1430400261241356, -0.011381741475327799, -0.2538475861764796], [1.043038816730529, -0.0033828538717183554, -0.18281157332332384], [1.047041786940619, 0.04664223110550035, -0.175429256812324], [0.9950498118611107, 0.02563701850191518, -0.1436187247847876], [0.9470910104584436, 0.05456039332889795, -0.10438587638745572], [1.3430374967475833, -0.027412794490569197, -0.39589908742379476], [1.2430374115083314, -0.019398779159559332, -0.32487314622572705], [1.1470471911632931, 0.03861424906338181, -0.24645910828410447], [1.1950418940642837, 0.009609179736642, -0.28566655400139473], [1.2470446718291128, 0.03060238113954849, -0.31748490462514256], [1.543037367343498, -0.04344260398498052, -0.5379499235484874], [1.4430373635708804, -0.03542777677120819, -0.4669244995526487], [1.3470449069141965, 0.02258698837308458, -0.388510569721052], [1.3950411034172443, -0.006420325990810348, -0.42771755978183], [1.4470447878474577, 0.014572270763461882, -0.4595360024693913], [1.743037360834878, -0.05947233265623177, -0.6800007233967439], [1.64303736134221, -0.05145747079304105, -0.6089753243010259], [1.647044792342548, -0.0014574689192853457, -0.6015868161456208], [1.5950410788139142, -0.022450038826698965, -0.5697683717829533], [1.5470447978250998, 0.006557386840482682, -0.5305614143343879], [1.7470447923648216, -0.00947233281129993, -0.6726122145273373], [1.7950410763947355, -0.038479764359828, -0.7118191677487917], [0.3594638639848011, 0.06409514453397895, 1.1193040239203689], [1.4616149454850689, -0.007223826598266578, -0.550226142018342], [0.6349925052320367, 0.06096329170911253, 0.04304230212016949], [-0.10070921629107363, 0.07096402096559448, 4.3286415172759884], [0.26952568499068824, 0.06455818856377793, 2.034796430228431], [1.6570029640344122, -0.022856032322613837, -0.6890404163458312], [1.873960823420388, -0.04153452667893932, -0.8220281294666563], [1.0595516513291436, 0.038398603698114056, -0.26193462398230966], [0.4645507463016614, 0.06256135042872335, 0.43928958413565017], [0.8590305810336855, 0.041050850894054115, -0.12214182220175832], [1.2602080265259263, 0.008928415621768979, -0.40717485371691414], [0.7007125145641601, 0.04876657770622991, -0.02250110835983353], [0.22906137792599646, 0.06255119308350282, 4.356482370710602], [1.0574174072693567, 0.0117912068375551, -0.26586250815379264], [1.8263741372451496, -0.035432917312193134, -0.8260502318018632], [0.6768598766671421, 0.03823717413175932, 0.032878624893190656], [0.00366533058973649, 0.06737342549892786, 5.1087772129786], [1.915193062428365, -0.043334757974875966, -0.8762242411758832], [1.3597693937608173, 0.0009499932889122722, -0.4778881189521508], [0.1304869215949278, 0.0660614929503627, 3.547117826879934], [1.7549099632407175, -0.03061373368054466, -0.7602602041323603], [1.1243501294089089, 0.01981729136997999, -0.31068071156357113], [0.18011721790286422, 0.06555627947481024, 2.9601687155848744], [0.9876416604864079, 0.030766077761621786, -0.2135685346557995], [1.1744547233001936, 0.015801254531570344, -0.3462676632901018], [1.4303317237630981, 0.01817793669191784, -0.4852775829563598], [1.530331728994617, 0.010163068039180989, -0.5563030033877884], [1.4625753757004476, 0.01786474995750112, -0.545790296806399], [1.3908115954670237, -0.024433565679788934, -0.5426660990372494], [1.4908115955224268, -0.03244842317358315, -0.6136915119083403], [1.4428153099370704, -0.003440995353725787, -0.5744845529815041], [0.5572005970693831, 0.07907024088588861, 0.01666450461115144], [0.676339078315681, 0.08469873261073516, -0.02881998693929833], [0.6477451598019965, 0.08196976603514244, 0.02538578346523941], [-0.38631904656472216, 0.10149936119800593, 4.959574342847324], [-0.26722922176943764, 0.09899782055836223, 3.7072934099077486], [-0.018716984671843837, 0.09356110590487941, 4.349810018283783], [1.4263242906879599, -0.03182209932242577, -0.4926660798284672], [1.5263243004533054, -0.039836932214982315, -0.5636915121866501], [1.4585679456780054, -0.03213524809769268, -0.5531788057189326], [0.9937884833280975, 0.06439968979738289, -0.24906794088475248], [1.041782678691152, 0.03539930032926862, -0.2882868709933033], [1.0235955251364541, 0.03458301495169877, -0.23775134569933376], [1.0058280382185885, 0.03158476367095287, -0.2641056595688254], [0.9578278246077153, 0.060580711107022525, -0.22488268991713709], [0.7104557710174313, 0.02751498825252384, -0.06541470294382942], [0.6789189496045999, 0.028498664334378438, -0.009841897675404117], [0.6042454347302223, 0.03815228154825642, -0.010482577965455937], [1.058484330499876, 0.025094911613405543, -0.2638981369287354], [1.0407155688487937, 0.022095317493413397, -0.2902503296106793], [1.0225276727484738, 0.02127912387348678, -0.23971543775553736], [1.0908838675079284, 0.015804563688297208, -0.288272035916715], [1.0919510294234522, 0.029108482849099133, -0.2863080904994191], [1.077296780667004, 0.028010118408199447, -0.23828577779339344], [1.109696526009508, 0.018720422039224173, -0.26266080924215474], [1.07622965925965, 0.014707670573714717, -0.24025022811712182], [0.7317415197463316, 0.013252450100180509, 0.010139911134893403], [0.6651783660885794, 0.024362567948594004, 0.01428436954615752], [0.6474741245320402, 0.02030605773454535, 0.07069611829806785], [0.7140021754625039, 0.07800329433348832, 0.025022684389557355], [0.6295816124076371, 0.08619850578031323, 0.07597279970441162], [0.5416315599612307, 0.08546099610709658, 1.5880206948232212], [0.2664753199316413, 0.08970803529270639, 2.044257332514474], [0.4871614350750427, 0.08491360394670955, 2.599072329729683], [0.41394737046860147, 0.08304284215827272, 5.023508071427741], [0.4948588791938797, 0.08351633054115427, 3.771198671493075], [0.14633971968591125, 0.08996909275605797, 4.363730742756504], [0.09030211417774037, 0.051157139508935016, 1.5220286568739108], [-0.05419476309377602, 0.0506393987590389, 2.533221954063663], [0.2659664456815121, 0.03958934634719465, 2.028475966167492], [1.0937860366329737, 0.056393706686108686, -0.32010752473372944], [0.09078490514800264, 0.09281985533474715, 1.537889116100406], [-0.05367981707838071, 0.09547137611703498, 2.5489979029855436], [0.016276858828645213, 0.07253832863021936, 2.014714998187685], [1.588505605563729, -0.04026452612697695, -0.6830986488971731], [1.656261955011907, -0.047966212271453354, -0.6936113476808305], [1.6885056055559595, -0.048279389293101854, -0.7541240467559647], [1.8324972340847219, -0.06500714555752529, -0.7706179030366811], [1.8647408846713154, -0.06532032266530564, -0.8311306019256832], [1.9324972340996296, -0.07302200871399425, -0.8416433007726887], [1.2256207206612693, -0.01573175221074892, -0.35011438651077076], [1.2296281794397879, 0.0342690635385527, -0.34272615625921], [1.217331275487797, 0.012364800371118631, -0.3767211999892483], [1.186751763867765, 0.03770610339849268, -0.31227286692053097], [1.1827447230845363, -0.012295821319734519, -0.3196607393750492], [1.1293010481995251, 0.049004202968786506, -0.2701074479107668], [1.0293014850350712, 0.057023723206265, -0.1990760858978346], [1.0615434007328763, 0.056704001015221314, -0.25959222711915264], [1.161699665812992, 0.039714095010871434, -0.29447953345181754], [1.157693158842889, -0.010287773042982985, -0.30186745455984476], [1.1494024490274297, 0.01780918996416874, -0.32847406175350385], [0.24788472222383262, 0.05095291930627473, 0.7128480349809085], [0.42522136932474597, 0.05167718637527638, 0.1793831560354923], [0.46391378688686813, 0.03791928101331447, 0.4314515928390504], [0.2486501088366122, 0.09129205220281719, 0.7284591910727143], [0.4121873789138893, 0.0634165664025588, 0.7437230624893162], [0.16349079258158258, 0.05140152181725404, 1.0886940334374111], [0.16403093033066335, 0.09205980915970356, 1.1045767098848895], [1.1242276142027041, -0.014298762281594612, -0.2794603849476171], [1.0242268115189719, -0.006297360043319811, -0.2084214484123218], [1.0564692385314112, -0.006598289868466483, -0.26894472812224135], [0.9250903211867805, 0.008372030781426194, -0.1366141449765642], [0.8250690139390805, 0.016026063859132494, -0.06512288415885685], [0.8572415161626499, 0.01610169491291403, -0.12598493432862873], [1.0887126272290766, -0.006911167834238754, -0.3294593324147769], [1.1221790429955365, -0.0028980143007424006, -0.3518679895162412], [1.8731911921622273, -0.06258269513730333, -0.8936543519433098], [1.8409475415798748, -0.0622695179869233, -0.8331416530916231], [1.7731911921618906, -0.05456783193249559, -0.8226289542423291], [0.7895316459193167, 0.023686962595114405, -0.11535805594369039], [0.8895073004115802, 0.01574451436981228, -0.18658108544420163], [1.7280257361624132, -0.0056678982465685895, -0.6967355379327156], [1.6280257361115291, 0.002346965822543387, -0.6257101393104267], [1.6602693865508624, 0.0020337876622869844, -0.6862228387791173], [1.2941154881684571, 0.03364259466984799, -0.46375200504300984], [1.194115620701002, 0.04165695675739802, -0.3927259285869119], [1.261871882445753, 0.03395565844825501, -0.40323914109345943], [1.1901081324005642, -0.008342665438875144, -0.4001147548129871], [1.290108122325612, -0.016357419878280877, -0.4711405051398999], [1.2421118075849853, 0.012649932127485893, -0.43193342174482513], [0.6025536137535248, 0.0844255191904287, 0.24827429275048035], [0.46444192906556103, 0.0869674521413881, 0.4471121404127212], [0.579029879685051, 0.08521605032214954, 0.7782323165431915], [1.1261855885594836, 0.04710132702812159, -0.34447890955789423], [1.0741817577461343, 0.026108923264551342, -0.3126605721631107], [1.1512385156140152, 0.045093279581066334, -0.36227225354376175], [1.3296283161573206, 0.02625407183073429, -0.4137520102512958], [0.79360119984074, 0.07351528168032007, -0.10756999020257063], [0.7804903585357648, 0.04475066651821111, -0.0718783304515418], [0.7140356419626334, 0.07711123251308431, -0.05840082637698453], [1.8707835998362503, -0.03938383764098348, -0.8511372364941153], [1.8945769429245802, -0.04243464232654492, -0.8491261853239165], [1.8501674803309134, -0.038483721995664744, -0.8240391806344793], [1.8853570041762449, -0.06622043831388881, -0.8582286577816476], [1.3256209504549614, -0.023745918281500404, -0.42114052463962837], [1.2578644832934984, -0.016044291052591364, -0.41062765136427276], [0.578443168136328, 0.025420353803575938, 0.7626711712648792], [0.5582876169690729, 0.02663567411979069, 1.1388936395089162], [0.5588635435314157, 0.08548508280185074, 1.1546303339334072], [0.3004880973137943, 0.0343588709860326, 5.388718444108076], [0.11747337118818207, 0.06496239863576043, 4.730448680206187], [0.41344107416763815, 0.03151094220787358, 5.007726052975873], [0.14583358596419915, 0.039354380409715714, 4.347948472640951], [0.03305065160328938, 0.042073019801798534, 4.722380846221489], [-0.33438667181472803, 0.05079904023731298, 5.338717579224177], [-0.38682525210627405, 0.053031548298999594, 4.943792538226888], [-0.019223166385107793, 0.044175119511947206, 4.334028162489116], [-0.049633971595727355, 0.06916875841316097, 4.716520532996704], [1.9571207852011747, -0.023922124360065022, -0.8613528477302352], [1.9365046656988472, -0.02302200871592948, -0.8342547918799783], [1.8687483162718943, -0.01532032267381886, -0.8237420930309086], [1.8893644357754202, -0.016220438316819047, -0.850840148889185], [1.9216080863542677, -0.016533615475221114, -0.9113528477287105], [1.8771986237612477, -0.012582695133677685, -0.8862658430544859], [1.8449549731831187, -0.012269517985089878, -0.8257531442002646], [0.9887126057622037, 0.0011025226993328432, -0.258428895279722], [1.6925130369930905, 0.0017206106944017002, -0.7467355378892427], [1.5925130370827933, 0.009735472872263035, -0.6757101390610349], [-0.11392749171273805, 0.05077700625425685, 3.016012024102524], [0.2249664448182263, 0.06506030001718442, 2.4828236143460494], [0.45650353706681523, 0.03052366678633328, 3.0660339413208013], [0.4866505574269954, 0.029623835497686574, 2.583293864898708], [0.09698917514900765, 0.09142060918097941, 3.9545908365084275], [0.01627246331624052, 0.06851243153007337, 3.9338494694617343], [-0.14568024586702844, 0.09642494558307659, 3.324607352983853], [1.9531133535998664, -0.07392212437062247, -0.8687413566186309], [0.5411070893368458, 0.027032612138485044, 1.5722232738360207], [0.42561772622985894, 0.08610539981948184, 0.19631233356180053], [0.6022246835474858, 0.025191702980788305, 0.23334342727138435], [0.06417246845558539, 0.06675757870971177, 4.34240322927239], [0.17843292475062364, 0.06430641827854824, 3.947761435088924], [1.8127113226072664, -0.011956340808188318, -0.7652404453287339], [1.8365046656878545, -0.015007145494281948, -0.7632293941648318], [1.494819024038733, 0.01755157686949025, -0.6063030030137999], [1.39481902932726, 0.025566419616266947, -0.5352775769153326], [1.0413390651199526, 0.024196706093641218, -0.21410472373046724], [0.9893468478302939, 0.003179427983653775, -0.1822724604499048], [1.1472314304490758, -0.004906038601941318, -0.3696614569235501], [0.6577511276532103, 0.05137280060124288, 0.039780732604897825], [0.628807600885001, 0.03242655510764831, 0.06921529734650302], [0.6440242133794715, 0.0388148967355921, 0.018853368354116398], [0.9290591092811478, 0.058372586613191293, -0.12921173745597886], [0.9933483367237711, 0.053223679216453275, -0.17490197519628115], [0.9233375121730397, 0.03595121990425057, -0.16789979982029324], [0.6886343942124384, 0.04185857420862481, 0.0047498884074538145], [0.6660023888780547, 0.055298682518663336, 0.010517658002357322], [1.343896224814045, 0.029653322317689135, -0.4991085659527905], [1.3398888134305018, -0.020346641192845273, -0.506497106869327], [1.3099887238243955, 0.004939241613538245, -0.4425315554757885], [0.8934723379939672, 0.0657797707829796, -0.17921353558015313], [1.6240183046396146, -0.04765303678993864, -0.6330986473313815], [1.7240183047228261, -0.05566789814193712, -0.7041240468454903], [1.2776245798633472, 0.005261424566568404, -0.38193340198966097], [0.7010092547076914, 0.048251839542943764, 0.029697571941791734], [0.6564806516140818, 0.056548496337252716, 0.056003621512100366], [0.6917009168647853, 0.04401993974213135, 0.06444053352617185], [1.4106921620959483, -0.003136921632479854, -0.5140571210006235], [1.3794089638236564, 0.022264876497298337, -0.4491085858165551], [1.375401553467848, -0.027735211167624757, -0.4564970646781751], [1.6405093212968653, -0.01927195784525817, -0.7149170931860032], [0.1553050529102123, 0.06580810350893854, 3.2504933097266844], [0.43908808032136726, 0.0306394812036527, 3.3588391627076026], [-0.14618561955691828, 0.05117362674736929, 3.3088192756742725], [0.4570131839678591, 0.0850115719671849, 3.0818147242315743], [0.4395964098579608, 0.08540199632110579, 3.3746211427406427], [-0.11341916977034164, 0.09631819785548404, 3.0317990798222034], [-0.26773409817332805, 0.05350442323721799, 3.6915083338069654], [0.09648343960887566, 0.041413153161494444, 3.9388081346093027], [1.9176006547528643, -0.0665336154700683, -0.9187413566254036], [0.7470457614001569, 0.019538759516122002, -0.015883654727806507], [0.5162147370780166, 0.056756057443651156, 2.0647638659944176], [1.6760220202650433, -0.026660466728653083, -0.6649170932046546], [0.33426037451290724, 0.0703982866358429, 0.4200472574598982], [1.5593089555113495, -0.015039928366444952, -0.6196332813477943], [0.3139416849220182, 0.06431403933423929, 1.5521441981939474], [0.8415156620411676, 0.04470905249677917, -0.1473580261485409], [0.8612692997548038, 0.06596032924024267, -0.1185891754907582], [0.8290521842290849, 0.06646795861305481, -0.05809916352887988], [0.5532796989134033, 0.05179226115525229, 0.007255149843397035], [0.5470392263613962, 0.06346071956279628, 0.10976282079912772], [0.9538241088057068, 0.010597471330771189, -0.2322911487286734], [1.4783280119495923, -0.010829504223646813, -0.5244845523869185], [0.3009944402539864, 0.08501712489035523, 5.404500426025389], [0.03355691528462565, 0.09207294872214711, 4.738162731997815], [-0.33388083477173813, 0.10014053589954941, 5.354500095772501], [0.7509586932100183, 0.07031013459823837, -0.00829527962278201], [1.7059564636962126, -0.026734882861080972, -0.7246503105169939], [1.7414665366946689, -0.002158240165216707, -0.7823454314886751], [1.7769792356389011, -0.009546748953345327, -0.7323454315146782], [1.7906420502278055, -0.033023325513969665, -0.7931552179331829], [1.7374591051437698, -0.05215824009720901, -0.7897339404344852], [1.7729718040877198, -0.05954674909315408, -0.7397339403559532], [1.8087038910072053, -0.0619563408819864, -0.7726289541934546], [1.7771986237649966, -0.004567831976623929, -0.815240445315702], [0.49435193565757607, 0.029013214346096286, 3.75541610606314], [0.8770231186138087, 0.03732944746357037, -0.09729288375773161], [1.9373607199782126, -0.045227869918695277, -0.8900471021764393], [1.8845009498938632, -0.0440145771158386, -0.8024363474763534], [-0.016696199804561215, 0.06757891993634621, 5.371583610133029], [0.45649569057068506, 0.056770648902434766, 4.382328978822561], [0.5929667103752566, 0.054633372307484905, 0.4707886141718829], [0.6222462278660464, 0.06394185288584414, -0.0014374996208524303], [1.825194907961777, -0.03357526353944487, -0.8544473986457948], [-0.3293717197328745, 0.07675914939095738, 4.318410111553957], [0.6624616986644486, 0.05602406464639735, -0.03039800070818878]], "faces": [[1, 0, 92], [0, 2, 92], [3, 1, 92], [2, 3, 92], [5, 97, 4], [4, 97, 6], [7, 97, 5], [6, 97, 7], [0, 1, 106], [35, 0, 106], [1, 16, 106], [5, 4, 102], [4, 43, 102], [24, 5, 102], [16, 17, 108], [16, 35, 106], [35, 16, 108], [17, 18, 107], [36, 17, 107], [17, 36, 108], [18, 19, 103], [37, 18, 103], [18, 37, 107], [19, 20, 109], [19, 38, 103], [38, 19, 109], [20, 21, 111], [20, 39, 109], [39, 20, 111], [21, 22, 104], [40, 21, 104], [21, 40, 111], [22, 23, 110], [22, 41, 104], [41, 22, 110], [23, 24, 105], [42, 23, 105], [23, 42, 110], [43, 24, 102], [24, 43, 105], [36, 35, 108], [37, 36, 107], [38, 37, 103], [39, 38, 109], [40, 39, 111], [41, 40, 104], [42, 41, 110], [43, 42, 105], [2, 163, 3], [73, 163, 2], [3, 163, 54], [7, 168, 6], [6, 168, 81], [62, 168, 7], [54, 164, 55], [54, 163, 73], [73, 164, 54], [55, 165, 56], [55, 164, 74], [74, 165, 55], [56, 161, 57], [75, 161, 56], [56, 165, 75], [57, 166, 58], [57, 161, 76], [76, 166, 57], [58, 169, 59], [58, 166, 77], [77, 169, 58], [59, 162, 60], [78, 162, 59], [59, 169, 78], [60, 167, 61], [60, 162, 79], [79, 167, 60], [61, 170, 62], [61, 167, 80], [80, 170, 61], [81, 168, 62], [62, 170, 81], [74, 164, 73], [75, 165, 74], [76, 161, 75], [77, 166, 76], [78, 169, 77], [79, 162, 78], [80, 167, 79], [81, 170, 80], [1, 3, 224], [16, 1, 224], [3, 54, 224], [7, 5, 220], [5, 24, 220], [62, 7, 220], [17, 16, 225], [54, 16, 224], [16, 54, 225], [18, 17, 226], [55, 17, 225], [17, 55, 226], [19, 18, 222], [18, 56, 222], [56, 18, 226], [20, 19, 227], [57, 19, 222], [19, 57, 227], [21, 20, 221], [20, 58, 221], [58, 20, 227], [22, 21, 223], [59, 21, 221], [21, 59, 223], [23, 22, 228], [60, 22, 223], [22, 60, 228], [24, 23, 229], [61, 23, 228], [23, 61, 229], [24, 62, 220], [62, 24, 229], [54, 55, 225], [55, 56, 226], [56, 57, 222], [57, 58, 227], [58, 59, 221], [59, 60, 223], [60, 61, 228], [61, 62, 229], [0, 285, 2], [35, 285, 0], [2, 285, 73], [6, 288, 4], [4, 288, 43], [81, 288, 6], [36, 282, 35], [35, 282, 73], [73, 285, 35], [37, 283, 36], [74, 282, 36], [36, 283, 74], [38, 287, 37], [75, 283, 37], [37, 287, 75], [39, 284, 38], [38, 284, 76], [76, 287, 38], [40, 279, 39], [39, 279, 77], [77, 284, 39], [41, 280, 40], [78, 279, 40], [40, 280, 78], [42, 286, 41], [79, 280, 41], [41, 286, 79], [43, 281, 42], [42, 281, 80], [80, 286, 42], [81, 281, 43], [43, 288, 81], [73, 282, 74], [74, 283, 75], [75, 287, 76], [76, 284, 77], [77, 279, 78], [78, 280, 79], [79, 286, 80], [80, 281, 81]], "cells": {"triangle_2nd": [[1, 0, 92, 8, 93, 94], [0, 2, 92, 9, 95, 93], [3, 1, 92, 11, 94, 96], [2, 3, 92, 10, 96, 95], [5, 97, 4, 98, 99, 12], [4, 97, 6, 99, 100, 13], [7, 97, 5, 101, 98, 15], [6, 97, 7, 100, 101, 14], [0, 1, 106, 8, 112, 113], [35, 0, 106, 44, 113, 114], [1, 16, 106, 25, 115, 112], [5, 4, 102, 12, 116, 117], [4, 43, 102, 53, 118, 116], [24, 5, 102, 34, 117, 119], [16, 17, 108, 26, 120, 121], [16, 35, 106, 122, 114, 115], [35, 16, 108, 122, 121, 123], [17, 18, 107, 27, 124, 125], [36, 17, 107, 126, 125, 127], [17, 36, 108, 126, 128, 120], [18, 19, 103, 28, 129, 130], [37, 18, 103, 131, 130, 132], [18, 37, 107, 131, 133, 124], [19, 20, 109, 29, 134, 135], [19, 38, 103, 136, 137, 129], [38, 19, 109, 136, 135, 138], [20, 21, 111, 30, 139, 140], [20, 39, 109, 141, 142, 134], [39, 20, 111, 141, 140, 143], [21, 22, 104, 31, 144, 145], [40, 21, 104, 146, 145, 147], [21, 40, 111, 146, 148, 139], [22, 23, 110, 32, 149, 150], [22, 41, 104, 151, 152, 144], [41, 22, 110, 151, 150, 153], [23, 24, 105, 33, 154, 155], [42, 23, 105, 156, 155, 157], [23, 42, 110, 156, 158, 149], [43, 24, 102, 159, 119, 118], [24, 43, 105, 159, 160, 154], [36, 35, 108, 45, 123, 128], [37, 36, 107, 46, 127, 133], [38, 37, 103, 47, 132, 137], [39, 38, 109, 48, 138, 142], [40, 39, 111, 49, 143, 148], [41, 40, 104, 50, 147, 152], [42, 41, 110, 51, 153, 158], [43, 42, 105, 52, 157, 160], [2, 163, 3, 171, 172, 10], [73, 163, 2, 173, 171, 82], [3, 163, 54, 172, 174, 63], [7, 168, 6, 175, 176, 14], [6, 168, 81, 176, 177, 91], [62, 168, 7, 178, 175, 72], [54, 164, 55, 179, 180, 64], [54, 163, 73, 174, 173, 181], [73, 164, 54, 182, 179, 181], [55, 165, 56, 183, 184, 65], [55, 164, 74, 180, 185, 186], [74, 165, 55, 187, 183, 186], [56, 161, 57, 188, 189, 66], [75, 161, 56, 190, 188, 191], [56, 165, 75, 184, 192, 191], [57, 166, 58, 193, 194, 67], [57, 161, 76, 189, 195, 196], [76, 166, 57, 197, 193, 196], [58, 169, 59, 198, 199, 68], [58, 166, 77, 194, 200, 201], [77, 169, 58, 202, 198, 201], [59, 162, 60, 203, 204, 69], [78, 162, 59, 205, 203, 206], [59, 169, 78, 199, 207, 206], [60, 167, 61, 208, 209, 70], [60, 162, 79, 204, 210, 211], [79, 167, 60, 212, 208, 211], [61, 170, 62, 213, 214, 71], [61, 167, 80, 209, 215, 216], [80, 170, 61, 217, 213, 216], [81, 168, 62, 177, 178, 218], [62, 170, 81, 214, 219, 218], [74, 164, 73, 185, 182, 83], [75, 165, 74, 192, 187, 84], [76, 161, 75, 195, 190, 85], [77, 166, 76, 200, 197, 86], [78, 169, 77, 207, 202, 87], [79, 162, 78, 210, 205, 88], [80, 167, 79, 215, 212, 89], [81, 170, 80, 219, 217, 90], [1, 3, 224, 11, 230, 231], [16, 1, 224, 25, 231, 232], [3, 54, 224, 63, 233, 230], [7, 5, 220, 15, 234, 235], [5, 24, 220, 34, 236, 234], [62, 7, 220, 72, 235, 237], [17, 16, 225, 26, 238, 239], [54, 16, 224, 240, 232, 233], [16, 54, 225, 240, 241, 238], [18, 17, 226, 27, 242, 243], [55, 17, 225, 244, 239, 245], [17, 55, 226, 244, 246, 242], [19, 18, 222, 28, 247, 248], [18, 56, 222, 249, 250, 247], [56, 18, 226, 249, 243, 251], [20, 19, 227, 29, 252, 253], [57, 19, 222, 254, 248, 255], [19, 57, 227, 254, 256, 252], [21, 20, 221, 30, 257, 258], [20, 58, 221, 259, 260, 257], [58, 20, 227, 259, 253, 261], [22, 21, 223, 31, 262, 263], [59, 21, 221, 264, 258, 265], [21, 59, 223, 264, 266, 262], [23, 22, 228, 32, 267, 268], [60, 22, 223, 269, 263, 270], [22, 60, 228, 269, 271, 267], [24, 23, 229, 33, 272, 273], [61, 23, 228, 274, 268, 275], [23, 61, 229, 274, 276, 272], [24, 62, 220, 277, 237, 236], [62, 24, 229, 277, 273, 278], [54, 55, 225, 64, 245, 241], [55, 56, 226, 65, 251, 246], [56, 57, 222, 66, 255, 250], [57, 58, 227, 67, 261, 256], [58, 59, 221, 68, 265, 260], [59, 60, 223, 69, 270, 266], [60, 61, 228, 70, 275, 271], [61, 62, 229, 71, 278, 276], [0, 285, 2, 289, 290, 9], [35, 285, 0, 291, 289, 44], [2, 285, 73, 290, 292, 82], [6, 288, 4, 293, 294, 13], [4, 288, 43, 294, 295, 53], [81, 288, 6, 296, 293, 91], [36, 282, 35, 297, 298, 45], [35, 282, 73, 298, 299, 300], [73, 285, 35, 292, 291, 300], [37, 283, 36, 301, 302, 46], [74, 282, 36, 303, 297, 304], [36, 283, 74, 302, 305, 304], [38, 287, 37, 306, 307, 47], [75, 283, 37, 308, 301, 309], [37, 287, 75, 307, 310, 309], [39, 284, 38, 311, 312, 48], [38, 284, 76, 312, 313, 314], [76, 287, 38, 315, 306, 314], [40, 279, 39, 316, 317, 49], [39, 279, 77, 317, 318, 319], [77, 284, 39, 320, 311, 319], [41, 280, 40, 321, 322, 50], [78, 279, 40, 323, 316, 324], [40, 280, 78, 322, 325, 324], [42, 286, 41, 326, 327, 51], [79, 280, 41, 328, 321, 329], [41, 286, 79, 327, 330, 329], [43, 281, 42, 331, 332, 52], [42, 281, 80, 332, 333, 334], [80, 286, 42, 335, 326, 334], [81, 281, 43, 336, 331, 337], [43, 288, 81, 295, 296, 337], [73, 282, 74, 299, 303, 83], [74, 283, 75, 305, 308, 84], [75, 287, 76, 310, 315, 85], [76, 284, 77, 313, 320, 86], [77, 279, 78, 318, 323, 87], [78, 280, 79, 325, 328, 88], [79, 286, 80, 330, 335, 89], [80, 281, 81, 333, 336, 90]], "tetrahedron_2nd": [[339, 79, 80, 167, 363, 89, 364, 365, 215, 212], [23, 22, 339, 228, 32, 366, 367, 268, 368, 267], [56, 340, 57, 161, 369, 370, 66, 188, 189, 371], [3, 341, 54, 163, 372, 373, 63, 172, 174, 374], [41, 339, 42, 110, 375, 376, 51, 153, 158, 377], [345, 58, 221, 361, 378, 260, 379, 380, 381, 382], [19, 18, 103, 349, 28, 130, 129, 383, 384, 385], [351, 345, 221, 361, 386, 379, 387, 388, 381, 380], [345, 351, 359, 279, 386, 389, 390, 391, 392, 393], [38, 353, 103, 37, 394, 395, 137, 47, 132, 396], [76, 75, 161, 340, 85, 190, 195, 397, 371, 398], [74, 73, 164, 342, 83, 182, 185, 399, 400, 401], [2, 163, 73, 350, 171, 173, 82, 402, 403, 404], [16, 17, 342, 108, 26, 405, 406, 121, 407, 120], [58, 345, 221, 59, 378, 379, 260, 68, 265, 408], [54, 55, 342, 225, 64, 409, 410, 241, 411, 245], [23, 343, 105, 24, 412, 413, 155, 33, 154, 414], [43, 4, 102, 344, 53, 116, 118, 415, 416, 417], [348, 40, 78, 362, 418, 324, 419, 420, 421, 422], [78, 345, 77, 169, 423, 424, 87, 207, 202, 425], [78, 362, 40, 359, 421, 422, 324, 426, 427, 428], [346, 17, 18, 107, 429, 27, 430, 431, 124, 125], [346, 55, 17, 338, 432, 244, 429, 433, 434, 435], [351, 40, 39, 111, 436, 49, 437, 438, 143, 148], [39, 109, 38, 347, 142, 138, 48, 439, 440, 441], [21, 351, 40, 359, 442, 436, 146, 443, 427, 389], [352, 5, 102, 24, 444, 117, 445, 446, 119, 34], [109, 19, 347, 20, 135, 447, 441, 134, 448, 29], [80, 81, 343, 170, 90, 449, 450, 217, 451, 219], [60, 162, 59, 348, 204, 203, 69, 452, 453, 454], [22, 21, 348, 223, 31, 455, 456, 263, 457, 262], [75, 74, 165, 346, 84, 187, 192, 458, 459, 460], [359, 345, 59, 221, 390, 408, 461, 462, 265, 379], [59, 362, 78, 359, 463, 421, 206, 461, 426, 428], [348, 78, 79, 162, 419, 88, 464, 454, 210, 205], [59, 345, 78, 169, 408, 423, 206, 199, 207, 425], [345, 359, 351, 221, 390, 389, 386, 379, 387, 462], [347, 57, 19, 349, 465, 254, 447, 466, 383, 467], [352, 355, 344, 102, 468, 469, 470, 445, 416, 471], [41, 40, 348, 104, 50, 418, 472, 152, 473, 147], [36, 346, 17, 338, 474, 429, 126, 475, 434, 433], [55, 346, 74, 338, 432, 460, 186, 435, 476, 433], [0, 354, 350, 106, 477, 478, 479, 113, 480, 481], [1, 354, 106, 341, 482, 481, 112, 483, 484, 485], [6, 355, 344, 168, 486, 469, 487, 176, 488, 489], [7, 355, 168, 352, 490, 489, 175, 491, 492, 468], [21, 351, 20, 111, 442, 493, 30, 139, 140, 438], [62, 343, 170, 61, 494, 451, 214, 71, 213, 495], [58, 345, 59, 169, 378, 408, 68, 198, 199, 425], [21, 351, 221, 20, 442, 387, 258, 30, 257, 493], [360, 16, 342, 35, 496, 406, 497, 498, 499, 122], [163, 357, 341, 54, 500, 501, 374, 174, 373, 502], [344, 4, 102, 355, 417, 116, 416, 469, 471, 503], [35, 342, 36, 108, 499, 504, 45, 123, 128, 407], [346, 55, 165, 56, 432, 183, 459, 505, 184, 65], [352, 344, 355, 168, 470, 469, 468, 492, 489, 488], [54, 342, 55, 164, 410, 409, 64, 179, 180, 400], [346, 107, 37, 36, 431, 133, 506, 474, 46, 127], [350, 341, 163, 357, 507, 374, 404, 508, 500, 501], [352, 81, 344, 168, 509, 510, 470, 492, 488, 177], [61, 339, 167, 60, 511, 365, 209, 70, 208, 512], [23, 339, 22, 110, 367, 366, 32, 149, 150, 377], [279, 361, 351, 39, 513, 388, 393, 317, 437, 514], [348, 59, 21, 362, 453, 264, 455, 420, 515, 463], [340, 353, 37, 103, 516, 396, 517, 518, 132, 395], [39, 347, 77, 361, 439, 519, 319, 514, 520, 521], [349, 353, 340, 103, 522, 516, 523, 384, 518, 395], [77, 58, 345, 361, 201, 378, 424, 520, 380, 382], [60, 348, 22, 356, 452, 456, 269, 524, 525, 526], [339, 79, 167, 60, 363, 212, 365, 512, 208, 211], [22, 348, 21, 104, 456, 455, 31, 144, 145, 473], [279, 361, 39, 77, 513, 514, 317, 318, 319, 520], [347, 77, 361, 58, 519, 520, 521, 527, 382, 201], [359, 345, 279, 78, 390, 391, 392, 426, 323, 423], [60, 22, 348, 223, 269, 456, 452, 270, 457, 263], [42, 43, 105, 343, 52, 160, 157, 528, 413, 529], [348, 78, 40, 280, 419, 324, 418, 530, 322, 325], [349, 287, 340, 353, 531, 532, 523, 522, 516, 533], [59, 362, 359, 21, 463, 428, 461, 264, 443, 515], [339, 41, 79, 356, 375, 329, 363, 534, 535, 536], [62, 343, 61, 229, 494, 495, 71, 278, 276, 537], [58, 345, 169, 77, 378, 425, 198, 201, 202, 424], [40, 359, 279, 78, 427, 392, 316, 324, 323, 426], [35, 342, 108, 16, 499, 407, 123, 122, 121, 406], [74, 164, 55, 342, 185, 180, 186, 399, 409, 400], [360, 16, 35, 357, 496, 122, 498, 538, 539, 540], [360, 35, 73, 357, 498, 300, 541, 538, 542, 539], [360, 16, 357, 54, 496, 540, 538, 543, 502, 240], [347, 39, 109, 20, 439, 142, 441, 448, 134, 141], [342, 35, 73, 360, 499, 300, 401, 497, 541, 498], [341, 357, 16, 54, 501, 540, 544, 373, 240, 502], [16, 357, 341, 106, 540, 501, 544, 115, 484, 545], [352, 102, 5, 355, 445, 117, 444, 468, 546, 471], [38, 349, 103, 353, 547, 384, 137, 394, 395, 522], [342, 73, 35, 282, 401, 300, 499, 548, 298, 299], [281, 43, 42, 343, 331, 52, 332, 549, 528, 529], [61, 343, 170, 80, 495, 451, 213, 216, 217, 450], [346, 55, 56, 226, 432, 65, 505, 550, 251, 246], [107, 18, 346, 37, 124, 430, 431, 133, 506, 131], [102, 4, 5, 355, 116, 12, 117, 471, 546, 503], [80, 281, 42, 343, 333, 332, 334, 450, 528, 549], [80, 42, 339, 343, 334, 376, 364, 450, 551, 528], [17, 55, 342, 338, 244, 409, 405, 434, 552, 435], [75, 165, 56, 346, 192, 184, 191, 458, 505, 459], [348, 21, 59, 223, 455, 264, 453, 457, 266, 262], [347, 58, 227, 57, 527, 261, 553, 465, 256, 67], [60, 22, 339, 356, 269, 366, 512, 524, 534, 525], [342, 54, 73, 164, 410, 181, 401, 400, 182, 179], [38, 349, 353, 287, 547, 522, 394, 306, 533, 531], [75, 340, 287, 37, 398, 532, 310, 309, 307, 517], [166, 57, 347, 76, 193, 465, 554, 197, 555, 196], [340, 18, 349, 103, 556, 385, 523, 518, 384, 130], [37, 346, 75, 340, 506, 458, 309, 517, 398, 557], [60, 348, 79, 162, 452, 464, 211, 204, 210, 454], [356, 339, 41, 22, 534, 375, 536, 525, 151, 366], [22, 41, 348, 104, 151, 472, 456, 144, 473, 152], [347, 361, 20, 58, 521, 558, 448, 527, 259, 382], [21, 348, 40, 104, 455, 418, 146, 145, 147, 473], [348, 356, 79, 41, 526, 535, 464, 472, 329, 536], [167, 80, 339, 61, 215, 364, 365, 209, 511, 216], [110, 339, 42, 23, 377, 376, 158, 149, 156, 367], [339, 79, 41, 286, 363, 329, 375, 559, 327, 330], [42, 343, 105, 23, 528, 413, 157, 156, 155, 412], [166, 77, 347, 58, 200, 519, 554, 194, 527, 201], [166, 57, 58, 347, 193, 67, 194, 554, 527, 465], [2, 3, 163, 354, 10, 172, 171, 560, 561, 562], [339, 41, 22, 110, 375, 151, 366, 377, 150, 153], [347, 76, 349, 38, 555, 563, 466, 440, 547, 314], [59, 162, 78, 348, 203, 205, 206, 453, 419, 454], [348, 22, 356, 41, 456, 525, 526, 472, 536, 151], [347, 19, 109, 38, 447, 135, 441, 440, 138, 136], [62, 343, 358, 81, 494, 564, 565, 218, 566, 449], [351, 361, 221, 20, 388, 381, 387, 493, 257, 558], [347, 76, 57, 349, 555, 196, 465, 466, 467, 563], [343, 43, 105, 24, 529, 160, 413, 414, 154, 159], [24, 352, 358, 43, 446, 567, 568, 159, 569, 570], [344, 6, 168, 81, 487, 176, 488, 510, 177, 91], [352, 7, 62, 168, 491, 72, 571, 492, 178, 175], [354, 0, 1, 106, 477, 8, 482, 481, 112, 113], [341, 1, 16, 106, 483, 25, 544, 484, 115, 112], [1, 354, 341, 3, 482, 485, 483, 11, 372, 562], [350, 0, 106, 35, 479, 113, 480, 572, 114, 44], [355, 6, 7, 168, 486, 14, 490, 489, 175, 176], [7, 355, 352, 5, 490, 468, 491, 15, 444, 546], [280, 78, 79, 348, 325, 88, 328, 530, 464, 419], [347, 227, 58, 20, 553, 261, 527, 448, 259, 253], [361, 58, 221, 20, 382, 260, 381, 558, 257, 259], [81, 43, 343, 358, 337, 529, 449, 566, 564, 569], [21, 351, 111, 40, 442, 438, 139, 146, 148, 436], [342, 36, 338, 74, 504, 475, 552, 399, 476, 304], [106, 16, 357, 35, 115, 540, 545, 114, 539, 122], [39, 347, 361, 20, 439, 521, 514, 141, 558, 448], [60, 348, 59, 223, 452, 453, 69, 270, 266, 457], [347, 76, 38, 284, 555, 314, 440, 573, 312, 313], [17, 342, 55, 225, 405, 409, 244, 239, 245, 411], [351, 361, 20, 39, 388, 558, 493, 437, 141, 514], [343, 23, 61, 229, 412, 274, 495, 537, 276, 272], [352, 81, 62, 358, 509, 218, 571, 567, 565, 566], [352, 81, 168, 62, 509, 177, 492, 571, 178, 218], [221, 59, 359, 21, 265, 461, 462, 258, 443, 264], [74, 346, 36, 338, 460, 474, 304, 476, 475, 433], [56, 75, 346, 340, 191, 458, 505, 369, 557, 398], [75, 340, 56, 161, 398, 369, 191, 190, 188, 371], [340, 18, 103, 37, 556, 130, 518, 517, 132, 131], [24, 62, 343, 358, 277, 494, 414, 568, 564, 565], [340, 287, 37, 353, 532, 307, 517, 516, 396, 533], [24, 352, 62, 358, 446, 571, 277, 568, 565, 567], [21, 351, 359, 221, 442, 389, 443, 258, 462, 387], [339, 23, 228, 61, 367, 268, 368, 511, 275, 274], [343, 42, 339, 23, 528, 376, 551, 412, 367, 156], [57, 340, 76, 161, 370, 397, 196, 189, 195, 371], [349, 38, 76, 287, 547, 314, 563, 531, 315, 306], [24, 352, 43, 102, 446, 570, 159, 119, 118, 445], [59, 362, 348, 78, 463, 420, 453, 206, 419, 421], [352, 81, 358, 43, 509, 566, 567, 570, 569, 337], [359, 362, 40, 21, 428, 422, 427, 443, 146, 515], [347, 166, 76, 77, 554, 197, 555, 519, 86, 200], [347, 19, 57, 227, 447, 254, 465, 553, 256, 252], [3, 341, 163, 354, 372, 374, 172, 562, 561, 485], [347, 77, 76, 284, 519, 86, 555, 573, 313, 320], [355, 7, 6, 97, 490, 14, 486, 574, 100, 101], [344, 6, 288, 4, 487, 293, 575, 417, 294, 13], [354, 1, 0, 92, 482, 8, 477, 576, 93, 94], [2, 3, 354, 92, 10, 562, 560, 95, 576, 96], [1, 354, 3, 92, 482, 562, 11, 94, 96, 576], [355, 4, 5, 97, 503, 12, 546, 574, 98, 99], [7, 355, 5, 97, 490, 546, 15, 101, 98, 574], [350, 0, 285, 2, 479, 289, 577, 402, 290, 9], [37, 346, 283, 75, 506, 578, 301, 309, 308, 458], [36, 17, 346, 107, 126, 429, 474, 127, 431, 125], [346, 17, 55, 226, 429, 244, 432, 550, 246, 242], [80, 81, 281, 343, 90, 336, 333, 450, 549, 449], [163, 357, 54, 73, 500, 502, 174, 173, 181, 542], [55, 74, 346, 165, 186, 460, 432, 183, 459, 187], [74, 36, 346, 283, 304, 474, 460, 305, 578, 302], [38, 287, 353, 37, 306, 533, 394, 47, 396, 307], [286, 79, 80, 339, 330, 89, 335, 559, 364, 363], [61, 80, 339, 343, 216, 364, 511, 495, 551, 450], [73, 35, 285, 350, 300, 291, 292, 403, 577, 572], [75, 74, 346, 283, 84, 460, 458, 308, 578, 305], [56, 222, 57, 340, 250, 255, 66, 369, 370, 579], [37, 18, 346, 340, 131, 430, 506, 517, 557, 556], [350, 341, 357, 106, 507, 501, 508, 480, 545, 484], [24, 62, 352, 220, 277, 571, 446, 236, 580, 237], [340, 18, 56, 222, 556, 249, 369, 579, 250, 247], [3, 224, 54, 341, 230, 233, 63, 372, 373, 581], [352, 7, 220, 62, 491, 235, 580, 571, 237, 72], [350, 0, 35, 285, 479, 44, 572, 577, 291, 289], [341, 1, 3, 224, 483, 11, 372, 581, 230, 231], [74, 73, 342, 282, 83, 401, 399, 303, 548, 299], [342, 36, 74, 282, 504, 304, 399, 548, 303, 297], [62, 343, 81, 170, 494, 449, 218, 214, 219, 451], [60, 339, 22, 228, 512, 366, 269, 271, 267, 368], [360, 54, 73, 342, 543, 181, 541, 497, 401, 410], [23, 229, 343, 24, 272, 537, 412, 33, 414, 273], [39, 77, 347, 284, 319, 519, 439, 311, 573, 320], [36, 342, 17, 108, 504, 405, 126, 128, 120, 407], [24, 343, 62, 229, 414, 494, 277, 273, 278, 537], [43, 4, 344, 288, 53, 417, 415, 295, 575, 294], [6, 355, 97, 4, 486, 574, 100, 13, 99, 503], [80, 42, 286, 339, 334, 326, 335, 364, 559, 376], [6, 355, 4, 344, 486, 503, 13, 487, 417, 469], [78, 279, 77, 345, 323, 318, 87, 423, 424, 391], [41, 40, 280, 348, 50, 322, 321, 472, 530, 418], [59, 345, 359, 78, 408, 390, 461, 206, 426, 423], [226, 17, 18, 346, 242, 27, 243, 550, 430, 429], [35, 342, 282, 36, 499, 548, 298, 45, 297, 504], [350, 341, 354, 163, 507, 485, 478, 404, 561, 374], [346, 56, 18, 226, 505, 249, 430, 550, 243, 251], [279, 361, 345, 351, 513, 380, 391, 393, 386, 388], [39, 347, 38, 284, 439, 440, 48, 311, 312, 573], [20, 351, 39, 111, 493, 437, 141, 140, 143, 438], [18, 56, 346, 340, 249, 505, 430, 556, 557, 369], [41, 286, 42, 339, 327, 326, 51, 375, 376, 559], [60, 79, 348, 356, 211, 464, 452, 524, 526, 535], [280, 348, 79, 41, 530, 464, 328, 321, 329, 472], [21, 362, 40, 348, 515, 422, 146, 455, 418, 420], [23, 61, 339, 343, 274, 511, 367, 412, 551, 495], [61, 339, 60, 228, 511, 512, 70, 275, 271, 368], [339, 79, 60, 356, 363, 211, 512, 534, 524, 535], [352, 344, 43, 102, 470, 415, 570, 445, 118, 416], [19, 18, 349, 222, 28, 385, 383, 248, 582, 247], [57, 349, 340, 222, 467, 523, 370, 255, 579, 582], [340, 18, 222, 349, 556, 247, 579, 523, 582, 385], [57, 349, 222, 19, 467, 582, 255, 254, 248, 383], [352, 81, 43, 344, 509, 337, 570, 470, 415, 510], [349, 287, 76, 340, 531, 315, 563, 523, 397, 532], [341, 1, 224, 16, 483, 231, 581, 544, 232, 25], [16, 341, 54, 224, 544, 373, 240, 232, 233, 581], [76, 75, 340, 287, 85, 398, 397, 315, 532, 310], [338, 342, 74, 55, 552, 399, 476, 435, 186, 409], [350, 357, 163, 73, 508, 500, 404, 403, 173, 542], [57, 349, 76, 340, 467, 563, 196, 370, 397, 523], [2, 350, 73, 285, 402, 403, 82, 290, 292, 577], [0, 354, 92, 2, 477, 576, 93, 9, 95, 560], [342, 17, 338, 36, 405, 434, 552, 504, 475, 126], [0, 354, 2, 350, 477, 560, 9, 479, 402, 478], [16, 17, 225, 342, 26, 239, 238, 406, 411, 405], [350, 341, 106, 354, 507, 484, 480, 478, 481, 485], [38, 349, 19, 103, 547, 383, 136, 137, 129, 384], [54, 16, 225, 342, 240, 238, 241, 410, 411, 406], [350, 357, 35, 106, 508, 539, 572, 480, 114, 545], [354, 163, 2, 350, 561, 171, 560, 478, 402, 404], [344, 6, 81, 288, 487, 91, 510, 575, 296, 293], [344, 81, 43, 288, 510, 337, 415, 575, 295, 296], [279, 40, 39, 351, 316, 49, 317, 393, 437, 436], [40, 359, 351, 279, 427, 389, 436, 316, 393, 392], [279, 361, 77, 345, 513, 520, 318, 391, 424, 380], [54, 357, 360, 73, 502, 538, 543, 181, 541, 542], [360, 16, 54, 342, 496, 240, 543, 497, 410, 406], [346, 36, 37, 283, 474, 46, 506, 578, 301, 302], [35, 357, 350, 73, 539, 508, 572, 300, 403, 542], [220, 5, 352, 24, 234, 444, 580, 236, 446, 34], [81, 343, 43, 281, 449, 529, 337, 336, 331, 549], [358, 343, 24, 43, 564, 414, 568, 569, 159, 529], [352, 7, 5, 220, 491, 15, 444, 580, 234, 235], [347, 19, 227, 20, 447, 252, 553, 448, 253, 29], [347, 349, 19, 38, 466, 383, 447, 440, 136, 547]], "line_2nd": [[1, 0, 8], [0, 2, 9], [3, 2, 10], [1, 3, 11], [5, 4, 12], [4, 6, 13], [7, 6, 14], [5, 7, 15], [1, 16, 25], [16, 17, 26], [17, 18, 27], [18, 19, 28], [19, 20, 29], [20, 21, 30], [21, 22, 31], [22, 23, 32], [23, 24, 33], [24, 5, 34], [0, 35, 44], [35, 36, 45], [36, 37, 46], [37, 38, 47], [38, 39, 48], [39, 40, 49], [40, 41, 50], [41, 42, 51], [42, 43, 52], [43, 4, 53], [3, 54, 63], [54, 55, 64], [55, 56, 65], [56, 57, 66], [57, 58, 67], [58, 59, 68], [59, 60, 69], [60, 61, 70], [61, 62, 71], [62, 7, 72], [2, 73, 82], [73, 74, 83], [74, 75, 84], [75, 76, 85], [76, 77, 86], [77, 78, 87], [78, 79, 88], [79, 80, 89], [80, 81, 90], [81, 6, 91]]}};

const fieldData = {"values": [5.603599261359344, 5.612270461599448, 5.6350906940502306, 5.643470645423708, 0.9669645698147812, 0.9687458115431896, 0.952234363111381, 0.9534462400413176, 5.569233212779047, 5.61954755209882, 5.600790192619904, 5.628080363368911, 0.9671756414924497, 0.9595909186888648, 0.9521498126025583, 0.9610897150871214, 3.134380126113084, 1.1449458648880908, 0.15322168233556005, 0.13471960367945782, 0.2636163860315916, 0.4019294134126926, 0.5426521658797373, 0.6842998608052805, 0.8263969948021885, 4.341105923538706, 2.047829242730337, 0.48879360285078177, 0.0989086230584806, 0.19684083807387137, 0.33228095437794486, 0.47212323604176043, 0.6134003412785244, 0.7553080834395801, 0.8975474221481717, 3.1202668029716842, 1.118532406232917, 0.06579062927024354, 0.10898131724455887, 0.25230648662443317, 0.39522482016706, 0.538146876487717, 0.6810806405005378, 0.8240208016146866, 4.330188640255536, 2.028997310198825, 0.44179228772344015, 0.04629250624585633, 0.18094468396979424, 0.32377662153576425, 0.46668436558126053, 0.6096127093613328, 0.752550143316921, 0.8954923424614891, 3.1649746068350075, 1.1732911519153841, 0.1483480352682502, 0.11718482370814162, 0.24708609337448165, 0.385914091544554, 0.5269317719779508, 0.6687704608555852, 0.8110002788756153, 4.372087062068784, 2.0776274946357245, 0.5101096631864454, 0.0838778923372071, 0.18014307899634302, 0.31606075074148315, 0.4562732459610954, 0.597784829089833, 0.7398505576753409, 0.8822027813599734, 3.1515302018745674, 1.148737135387452, 0.07660980954585023, 0.09515775168781546, 0.23748346466573828, 0.3804291969027252, 0.5233798390482161, 0.6663309941217963, 0.8092825581605427, 4.3616047134659, 2.059963668277418, 0.46837790869995993, 0.031020727276211503, 0.16604073734152827, 0.30895459797802133, 0.45190455031531135, 0.5948553554776065, 0.7378067379565425, 0.8807584376703961, 5.584259050741082, 5.5844083864000575, 5.588710368152801, 5.6001974755733865, 5.604425226815763, 0.9596553256243224, 0.9639946267901288, 0.9631739049341681, 0.9557335182662675, 0.9564118348448898, 0.8957863659135253, 0.06836373977434661, 0.4680080235043398, 0.7530572806450505, 4.288670274743131, 0.37094014672545944, 1.9691960058820297, 0.18551353522715439, 0.6104326920435053, 0.32604326364995756, 4.936368656776554, 4.931503607448907, 3.679372603369219, 3.6855944145609816, 0.9311772605983754, 0.9321342674544849, 0.8597355463767904, 0.8608407793926687, 1.5100075693354016, 2.5182009566699044, 3.0685784302034054, 2.5099343620226495, 0.19532141910581768, 0.7068981029347979, 1.0499807671247614, 0.6872149672970216, 1.4986807596234721, 0.09767666227430552, 0.08798874283676597, 0.04511426947442722, 0.026657586603258752, 0.15588860275560618, 0.22447156033806584, 0.157012972082489, 0.11752166132206161, 0.0801600871663013, 0.1470391835283923, 0.36379833039977105, 0.29370464044558536, 0.2554699939815867, 0.21773517660215744, 0.28880890748609445, 0.5051483898193784, 0.43434266939710925, 0.3969376867338919, 0.43132468859041595, 0.36002626643692853, 0.6472021677828039, 0.5761197441932849, 0.5391854943361887, 0.5026739930269383, 0.5740544909787554, 0.7895803269078766, 0.7183627411937684, 0.6817278256668953, 0.7168727345274069, 0.6454561995960625, 0.8244121514660212, 0.7883000819831447, 0.05219731190594023, 0.4526429916592879, 4.32022396633973, 2.00073442430714, 0.4017263900631614, 0.16932182963524167, 0.5952176509973309, 0.880734264481454, 0.31041389541345676, 0.7379383940917459, 4.963078944542852, 4.967767698594261, 3.710944531609841, 3.7168927396798894, 0.9169513350520876, 0.9162891507483953, 0.8448307605750157, 0.8456189406802191, 2.5492876824736164, 1.5407861709380488, 3.100132870526233, 2.541491252606147, 0.7358151319893331, 0.2168288700009159, 1.530207965528171, 1.0816034643104786, 0.7188076905337006, 0.07302139325818574, 0.08426921480046058, 0.012308657681780721, 0.04878815040110035, 0.18316900704024847, 0.13999987614521667, 0.20814869553610452, 0.06417761094225476, 0.10108958708874397, 0.13150131420743585, 0.2776227334977703, 0.34794952724353867, 0.20219832766249976, 0.2396153780777007, 0.2734983926404231, 0.41865533776060493, 0.4895865276777951, 0.4162086004711364, 0.3814612973708746, 0.3448267366248462, 0.5606557197080693, 0.6318167914764254, 0.48761698229103934, 0.5239046303347238, 0.5590426874887691, 0.7030417816956793, 0.7743130667219533, 0.6304797915519504, 0.6665656164736592, 0.7019248511575743, 0.8093294223483591, 0.7733756594183949, 0.8898684799709872, 0.32416241901103354, 0.08578029606326677, 0.46418972076922155, 4.359096051474298, 2.069756713246597, 0.5062431072039455, 0.18856412000270423, 0.6055845841906098, 0.7475720196929351, 4.994755161680827, 4.979203758220376, 3.7379952147764897, 3.753404249757105, 0.9293061497417997, 0.9216454493869198, 0.8581179781887065, 0.8504330793559837, 2.582306463312304, 1.5844833425542428, 3.154198973106059, 2.597436115620181, 0.7929773790644642, 0.2821048907209419, 1.1675639805196014, 1.5990959272193435, 0.8058774445995064, 0.09800966794898633, 0.10468263240655613, 0.14924557248484643, 0.09196510386637122, 0.2895227287574479, 0.1607563934494962, 0.22577192318810058, 0.12659026532179354, 0.09778126240341713, 0.15212594117443579, 0.2936875007469175, 0.3629842466053816, 0.2553677148450171, 0.2855093384184901, 0.21747121248891457, 0.4329861067057988, 0.5034029407307961, 0.39391402166974276, 0.3549285454660466, 0.42502235461655063, 0.5740814651706061, 0.6449358385993694, 0.5347837063893917, 0.4955120578309905, 0.5662487526193386, 0.7159138385773466, 0.7869820197379956, 0.6765275060232523, 0.637150551001064, 0.7081678250762735, 0.8186916838089167, 0.7792690170401388, 0.31633780276099666, 0.45927686505925086, 0.7451674984225641, 2.051431782665554, 0.4655250506223691, 0.1733129271856453, 4.348378939833451, 0.6022205737230861, 0.020096791116625667, 0.8881161696972433, 4.969571087619752, 4.985300778234138, 3.725760314714279, 3.7414373742271136, 0.9201727114025817, 0.9275387568889767, 0.8560653120481013, 0.8486972577761422, 1.5626262202230201, 2.5663011825230564, 2.581873779764108, 3.14040811051477, 0.2240728005860172, 0.75980073972308, 1.5779759122122783, 1.142125783246151, 0.7745184313503947, 0.06919874558250681, 0.014307834307798561, 0.23576864788430144, 0.07762827777611742, 0.010200437812863873, 0.21286630682071278, 0.1411567284022676, 0.1339345750920901, 0.10185422816979743, 0.058293726674487824, 0.35578109364052984, 0.2843174818262645, 0.2769010465660389, 0.24488393637773082, 0.20542596283744316, 0.4987098178155339, 0.42724339621942864, 0.34837703090798705, 0.38780754511913174, 0.41984941123567143, 0.6416486369106343, 0.5701783779700667, 0.4913231452843798, 0.5307482140736011, 0.562797283041574, 0.7845923666643543, 0.713120069584984, 0.7057467948175119, 0.6736937515415355, 0.6342718831568852, 0.7772219388949249, 0.8166416721848294, 1.0706871108959464, 0.604304154733435, 0.033188682106406665, 4.296752768404021, 1.9845066945241272, 0.7436987195984252, 0.8912697353498379, 0.31539845992320703, 0.39124658340585866, 0.1770855700596222, 0.4607967803541959, 0.08132059434548608, 4.295077106150006, 0.3195550677337198, 0.8704688126877658, 0.04361993150548226, 5.0589491317116035, 0.929335607483492, 0.531704880419356, 3.4971806856788605, 0.8141692738788822, 0.3641974964835048, 2.9102601006323825, 0.26735090596089917, 0.39979442364267115, 0.5635321155946847, 0.6349614150644839, 0.5997583495004565, 0.5729888180550267, 0.644092258489952, 0.6046718081352559, 0.07685421661904776, 0.0789356181346695, 0.043710600067098225, 4.960580647013039, 3.7126142749844067, 4.30815956073389, 0.5710379349775109, 0.642449554128805, 0.6073656654164504, 0.2802003694833508, 0.31926341839122246, 0.2913471276595012, 0.2954858699984932, 0.2565366659600574, 0.10800465419175231, 0.07263414348068885, 0.07850524548709087, 0.31747530047210437, 0.3213841230680686, 0.29343491947429323, 0.3418603379525612, 0.3397895478778141, 0.31537327412383315, 0.3398666213666264, 0.31740162183162407, 0.07622966901353183, 0.05790879822473083, 0.014307834307798561, 0.05386803752512211, 0.008535662519821212, 1.5248080670934419, 1.994305285114309, 2.534883509801643, 4.9551930589934585, 3.7055746366031603, 4.307334884834895, 1.519382816838233, 2.5264813505318324, 1.9785345459525348, 0.3504836735897224, 1.5348081391560253, 2.5420336587087187, 2.0097268249626348, 0.7136334615256701, 0.7483759177645788, 0.7848641808844294, 0.8575844736165105, 0.8935003724560923, 0.9290414610951393, 0.4277760514991428, 0.4202179456173486, 0.4302852055911541, 0.38961529563485553, 0.39718898162214766, 0.3472349124818699, 0.2759190300707384, 0.31290378657983076, 0.3717382615316709, 0.37932233299775586, 0.3819908048849603, 0.7176013119315031, 0.2007313680988234, 0.3834465876544907, 0.7320882632306446, 0.6951931415669794, 1.0902925232100642, 1.1054986365258026, 0.35685561353000567, 0.28560991659589086, 0.3227973344004328, 0.21370890597593867, 0.14257615924762307, 0.18127661588324856, 0.3605165748986534, 0.38266930682976635, 0.9195200925385257, 0.8831235158830849, 0.8482437620394586, 0.15274401054828873, 0.2201960035503359, 0.7762031689670383, 0.7047576896146936, 0.7408161093002705, 0.493710576317136, 0.4228094975224194, 0.45671669426940964, 0.43065316102732715, 0.5014914703602066, 0.46214032657646215, 0.18112220137417612, 0.3989510374522331, 0.7149271260224292, 0.3747724990689767, 0.3434766406942803, 0.39247347432078855, 0.4916133216172734, 0.14398600726479374, 0.12629649533479256, 0.1002258112266656, 0.8998902011028043, 0.9102876808296021, 0.8808168724497188, 0.9125589145257744, 0.4991418695764834, 0.4643992043720704, 0.6994437143124892, 1.0758153894559586, 1.0915156163148847, 5.321106325057554, 4.674041828311957, 4.9394142156162095, 4.291546134010031, 4.6725642091690425, 5.325613895890144, 4.944913796438349, 4.292400724940393, 4.674776438394817, 0.9405418780742906, 0.9216190685829722, 0.8859960743645875, 0.9050329729675037, 0.9412802314530174, 0.9119104756260572, 0.8755785206190662, 0.29038254782510187, 0.7772301393446394, 0.7059724972010051, 3.008280047508032, 2.43271910143514, 3.0012912199230013, 2.519111370885833, 3.904714368173425, 3.8922394339013238, 3.315918082997149, 0.9479876432736122, 1.5090358557663412, 0.21241121460658224, 0.16652431164961495, 4.29258693899699, 3.891306965156205, 0.8395521732195851, 0.8501554823200759, 0.6363998563219255, 0.5652571583983836, 0.2911418524593854, 0.2593760820264985, 0.40034972849871425, 0.033889161432776836, 0.008516493217617513, 0.051475356161498086, 0.20594485619394418, 0.25170252020544837, 0.22208435446006675, 0.06273077464471244, 0.05547131345203692, 0.5290628031442255, 0.5368179578178632, 0.49624179684745523, 0.2120380593990429, 0.7122319286567678, 0.7836656321975004, 0.4596799483935471, 0.04793850295519256, 0.03333209881029026, 0.021795765155731204, 0.5679981688847505, 0.5271621752491598, 0.5346787331692129, 0.7454174772379173, 3.2005687841245365, 3.293748719651895, 3.300292991965056, 3.017071556489018, 3.309534015560926, 3.0238877925647927, 3.697019331906429, 3.888937143067102, 0.9488701971017957, 0.09171548075053229, 2.0011579294018293, 0.7442112285833308, 0.4291684706563861, 0.6739874298630872, 1.502617515375408, 0.18201676722226406, 0.17317351067322945, 0.13498275586215022, 0.08546002058237406, 0.07092577293613143, 0.26463982104134337, 0.6029906164731622, 5.3368942612682675, 4.688341481651646, 5.3413245552127036, 0.08330792774532773, 0.7789325347589222, 0.8124306624712906, 0.8114661461928689, 0.8423164633798155, 0.8200547655436632, 0.8189254630479766, 0.8470242992777774, 0.840613191855734, 3.689805767194211, 0.17426116007394005, 0.9444940881065733, 0.8895976229281952, 5.321744835927467, 4.315374507232637, 0.4064360432417159, 0.06764837695464222, 0.8800662531336526, 4.321592462997859, 0.08115861706826698], "field_name": "displacement", "field_units": "m", "field_type": "vector", "min_value": 0.008516493217617513, "max_value": 5.643470645423708, "lookup_table": {"number_of_colors": 256, "range": [0.008516493217617513, 5.643470645423708], "colors": [[0.267004, 0.004874, 0.329415, 1.0], [0.26851, 0.009605, 0.335427, 1.0], [0.269944, 0.014625, 0.341379, 1.0], [0.271305, 0.019942, 0.347269, 1.0], [0.272594, 0.025563, 0.353093, 1.0], [0.273809, 0.031497, 0.358853, 1.0], [0.274952, 0.037752, 0.364543, 1.0], [0.276022, 0.044167, 0.370164, 1.0], [0.277018, 0.050344, 0.375715, 1.0], [0.277941, 0.056324, 0.381191, 1.0], [0.278791, 0.062145, 0.386592, 1.0], [0.279566, 0.067836, 0.391917, 1.0], [0.280267, 0.073417, 0.397163, 1.0], [0.280894, 0.078907, 0.402329, 1.0], [0.281446, 0.08432, 0.407414, 1.0], [0.281924, 0.089666, 0.412415, 1.0], [0.282327, 0.094955, 0.417331, 1.0], [0.282656, 0.100196, 0.42216, 1.0], [0.28291, 0.105393, 0.426902, 1.0], [0.283091, 0.110553, 0.431554, 1.0], [0.283197, 0.11568, 0.436115, 1.0], [0.283229, 0.120777, 0.440584, 1.0], [0.283187, 0.125848, 0.44496, 1.0], [0.283072, 0.130895, 0.449241, 1.0], [0.282884, 0.13592, 0.453427, 1.0], [0.282623, 0.140926, 0.457517, 1.0], [0.28229, 0.145912, 0.46151, 1.0], [0.281887, 0.150881, 0.465405, 1.0], [0.281412, 0.155834, 0.469201, 1.0], [0.280868, 0.160771, 0.472899, 1.0], [0.280255, 0.165693, 0.476498, 1.0], [0.279574, 0.170599, 0.479997, 1.0], [0.278826, 0.17549, 0.483397, 1.0], [0.278012, 0.180367, 0.486697, 1.0], [0.277134, 0.185228, 0.489898, 1.0], [0.276194, 0.190074, 0.493001, 1.0], [0.275191, 0.194905, 0.496005, 1.0], [0.274128, 0.199721, 0.498911, 1.0], [0.273006, 0.20452, 0.501721, 1.0], [0.271828, 0.209303, 0.504434, 1.0], [0.270595, 0.214069, 0.507052, 1.0], [0.269308, 0.218818, 0.509577, 1.0], [0.267968, 0.223549, 0.512008, 1.0], [0.26658, 0.228262, 0.514349, 1.0], [0.265145, 0.232956, 0.516599, 1.0], [0.263663, 0.237631, 0.518762, 1.0], [0.262138, 0.242286, 0.520837, 1.0], [0.260571, 0.246922, 0.522828, 1.0], [0.258965, 0.251537, 0.524736, 1.0], [0.257322, 0.25613, 0.526563, 1.0], [0.255645, 0.260703, 0.528312, 1.0], [0.253935, 0.265254, 0.529983, 1.0], [0.252194, 0.269783, 0.531579, 1.0], [0.250425, 0.27429, 0.533103, 1.0], [0.248629, 0.278775, 0.534556, 1.0], [0.246811, 0.283237, 0.535941, 1.0], [0.244972, 0.287675, 0.53726, 1.0], [0.243113, 0.292092, 0.538516, 1.0], [0.241237, 0.296485, 0.539709, 1.0], [0.239346, 0.300855, 0.540844, 1.0], [0.237441, 0.305202, 0.541921, 1.0], [0.235526, 0.309527, 0.542944, 1.0], [0.233603, 0.313828, 0.543914, 1.0], [0.231674, 0.318106, 0.544834, 1.0], [0.229739, 0.322361, 0.545706, 1.0], [0.227802, 0.326594, 0.546532, 1.0], [0.225863, 0.330805, 0.547314, 1.0], [0.223925, 0.334994, 0.548053, 1.0], [0.221989, 0.339161, 0.548752, 1.0], [0.220057, 0.343307, 0.549413, 1.0], [0.21813, 0.347432, 0.550038, 1.0], [0.21621, 0.351535, 0.550627, 1.0], [0.214298, 0.355619, 0.551184, 1.0], [0.212395, 0.359683, 0.55171, 1.0], [0.210503, 0.363727, 0.552206, 1.0], [0.208623, 0.367752, 0.552675, 1.0], [0.206756, 0.371758, 0.553117, 1.0], [0.204903, 0.375746, 0.553533, 1.0], [0.203063, 0.379716, 0.553925, 1.0], [0.201239, 0.38367, 0.554294, 1.0], [0.19943, 0.387607, 0.554642, 1.0], [0.197636, 0.391528, 0.554969, 1.0], [0.19586, 0.395433, 0.555276, 1.0], [0.1941, 0.399323, 0.555565, 1.0], [0.192357, 0.403199, 0.555836, 1.0], [0.190631, 0.407061, 0.556089, 1.0], [0.188923, 0.41091, 0.556326, 1.0], [0.187231, 0.414746, 0.556547, 1.0], [0.185556, 0.41857, 0.556753, 1.0], [0.183898, 0.422383, 0.556944, 1.0], [0.182256, 0.426184, 0.55712, 1.0], [0.180629, 0.429975, 0.557282, 1.0], [0.179019, 0.433756, 0.55743, 1.0], [0.177423, 0.437527, 0.557565, 1.0], [0.175841, 0.44129, 0.557685, 1.0], [0.174274, 0.445044, 0.557792, 1.0], [0.172719, 0.448791, 0.557885, 1.0], [0.171176, 0.45253, 0.557965, 1.0], [0.169646, 0.456262, 0.55803, 1.0], [0.168126, 0.459988, 0.558082, 1.0], [0.166617, 0.463708, 0.558119, 1.0], [0.165117, 0.467423, 0.558141, 1.0], [0.163625, 0.471133, 0.558148, 1.0], [0.162142, 0.474838, 0.55814, 1.0], [0.160665, 0.47854, 0.558115, 1.0], [0.159194, 0.482237, 0.558073, 1.0], [0.157729, 0.485932, 0.558013, 1.0], [0.15627, 0.489624, 0.557936, 1.0], [0.154815, 0.493313, 0.55784, 1.0], [0.153364, 0.497, 0.557724, 1.0], [0.151918, 0.500685, 0.557587, 1.0], [0.150476, 0.504369, 0.55743, 1.0], [0.149039, 0.508051, 0.55725, 1.0], [0.147607, 0.511733, 0.557049, 1.0], [0.14618, 0.515413, 0.556823, 1.0], [0.144759, 0.519093, 0.556572, 1.0], [0.143343, 0.522773, 0.556295, 1.0], [0.141935, 0.526453, 0.555991, 1.0], [0.140536, 0.530132, 0.555659, 1.0], [0.139147, 0.533812, 0.555298, 1.0], [0.13777, 0.537492, 0.554906, 1.0], [0.136408, 0.541173, 0.554483, 1.0], [0.135066, 0.544853, 0.554029, 1.0], [0.133743, 0.548535, 0.553541, 1.0], [0.132444, 0.552216, 0.553018, 1.0], [0.131172, 0.555899, 0.552459, 1.0], [0.129933, 0.559582, 0.551864, 1.0], [0.128729, 0.563265, 0.551229, 1.0], [0.127568, 0.566949, 0.550556, 1.0], [0.126453, 0.570633, 0.549841, 1.0], [0.125394, 0.574318, 0.549086, 1.0], [0.124395, 0.578002, 0.548287, 1.0], [0.123463, 0.581687, 0.547445, 1.0], [0.122606, 0.585371, 0.546557, 1.0], [0.121831, 0.589055, 0.545623, 1.0], [0.121148, 0.592739, 0.544641, 1.0], [0.120565, 0.596422, 0.543611, 1.0], [0.120092, 0.600104, 0.54253, 1.0], [0.119738, 0.603785, 0.5414, 1.0], [0.119512, 0.607464, 0.540218, 1.0], [0.119423, 0.611141, 0.538982, 1.0], [0.119483, 0.614817, 0.537692, 1.0], [0.119699, 0.61849, 0.536347, 1.0], [0.120081, 0.622161, 0.534946, 1.0], [0.120638, 0.625828, 0.533488, 1.0], [0.12138, 0.629492, 0.531973, 1.0], [0.122312, 0.633153, 0.530398, 1.0], [0.123444, 0.636809, 0.528763, 1.0], [0.12478, 0.640461, 0.527068, 1.0], [0.126326, 0.644107, 0.525311, 1.0], [0.128087, 0.647749, 0.523491, 1.0], [0.130067, 0.651384, 0.521608, 1.0], [0.132268, 0.655014, 0.519661, 1.0], [0.134692, 0.658636, 0.517649, 1.0], [0.137339, 0.662252, 0.515571, 1.0], [0.14021, 0.665859, 0.513427, 1.0], [0.143303, 0.669459, 0.511215, 1.0], [0.146616, 0.67305, 0.508936, 1.0], [0.150148, 0.676631, 0.506589, 1.0], [0.153894, 0.680203, 0.504172, 1.0], [0.157851, 0.683765, 0.501686, 1.0], [0.162016, 0.687316, 0.499129, 1.0], [0.166383, 0.690856, 0.496502, 1.0], [0.170948, 0.694384, 0.493803, 1.0], [0.175707, 0.6979, 0.491033, 1.0], [0.180653, 0.701402, 0.488189, 1.0], [0.185783, 0.704891, 0.485273, 1.0], [0.19109, 0.708366, 0.482284, 1.0], [0.196571, 0.711827, 0.479221, 1.0], [0.202219, 0.715272, 0.476084, 1.0], [0.20803, 0.718701, 0.472873, 1.0], [0.214, 0.722114, 0.469588, 1.0], [0.220124, 0.725509, 0.466226, 1.0], [0.226397, 0.728888, 0.462789, 1.0], [0.232815, 0.732247, 0.459277, 1.0], [0.239374, 0.735588, 0.455688, 1.0], [0.24607, 0.73891, 0.452024, 1.0], [0.252899, 0.742211, 0.448284, 1.0], [0.259857, 0.745492, 0.444467, 1.0], [0.266941, 0.748751, 0.440573, 1.0], [0.274149, 0.751988, 0.436601, 1.0], [0.281477, 0.755203, 0.432552, 1.0], [0.288921, 0.758394, 0.428426, 1.0], [0.296479, 0.761561, 0.424223, 1.0], [0.304148, 0.764704, 0.419943, 1.0], [0.311925, 0.767822, 0.415586, 1.0], [0.319809, 0.770914, 0.411152, 1.0], [0.327796, 0.77398, 0.40664, 1.0], [0.335885, 0.777018, 0.402049, 1.0], [0.344074, 0.780029, 0.397381, 1.0], [0.35236, 0.783011, 0.392636, 1.0], [0.360741, 0.785964, 0.387814, 1.0], [0.369214, 0.788888, 0.382914, 1.0], [0.377779, 0.791781, 0.377939, 1.0], [0.386433, 0.794644, 0.372886, 1.0], [0.395174, 0.797475, 0.367757, 1.0], [0.404001, 0.800275, 0.362552, 1.0], [0.412913, 0.803041, 0.357269, 1.0], [0.421908, 0.805774, 0.35191, 1.0], [0.430983, 0.808473, 0.346476, 1.0], [0.440137, 0.811138, 0.340967, 1.0], [0.449368, 0.813768, 0.335384, 1.0], [0.458674, 0.816363, 0.329727, 1.0], [0.468053, 0.818921, 0.323998, 1.0], [0.477504, 0.821444, 0.318195, 1.0], [0.487026, 0.823929, 0.312321, 1.0], [0.496615, 0.826376, 0.306377, 1.0], [0.506271, 0.828786, 0.300362, 1.0], [0.515992, 0.831158, 0.294279, 1.0], [0.525776, 0.833491, 0.288127, 1.0], [0.535621, 0.835785, 0.281908, 1.0], [0.545524, 0.838039, 0.275626, 1.0], [0.555484, 0.840254, 0.269281, 1.0], [0.565498, 0.84243, 0.262877, 1.0], [0.575563, 0.844566, 0.256415, 1.0], [0.585678, 0.846661, 0.249897, 1.0], [0.595839, 0.848717, 0.243329, 1.0], [0.606045, 0.850733, 0.236712, 1.0], [0.616293, 0.852709, 0.230052, 1.0], [0.626579, 0.854645, 0.223353, 1.0], [0.636902, 0.856542, 0.21662, 1.0], [0.647257, 0.8584, 0.209861, 1.0], [0.657642, 0.860219, 0.203082, 1.0], [0.668054, 0.861999, 0.196293, 1.0], [0.678489, 0.863742, 0.189503, 1.0], [0.688944, 0.865448, 0.182725, 1.0], [0.699415, 0.867117, 0.175971, 1.0], [0.709898, 0.868751, 0.169257, 1.0], [0.720391, 0.87035, 0.162603, 1.0], [0.730889, 0.871916, 0.156029, 1.0], [0.741388, 0.873449, 0.149561, 1.0], [0.751884, 0.874951, 0.143228, 1.0], [0.762373, 0.876424, 0.137064, 1.0], [0.772852, 0.877868, 0.131109, 1.0], [0.783315, 0.879285, 0.125405, 1.0], [0.79376, 0.880678, 0.120005, 1.0], [0.804182, 0.882046, 0.114965, 1.0], [0.814576, 0.883393, 0.110347, 1.0], [0.82494, 0.88472, 0.106217, 1.0], [0.83527, 0.886029, 0.102646, 1.0], [0.845561, 0.887322, 0.099702, 1.0], [0.85581, 0.888601, 0.097452, 1.0], [0.866013, 0.889868, 0.095953, 1.0], [0.876168, 0.891125, 0.09525, 1.0], [0.886271, 0.892374, 0.095374, 1.0], [0.89632, 0.893616, 0.096335, 1.0], [0.906311, 0.894855, 0.098125, 1.0], [0.916242, 0.896091, 0.100717, 1.0], [0.926106, 0.89733, 0.104071, 1.0], [0.935904, 0.89857, 0.108131, 1.0], [0.945636, 0.899815, 0.112838, 1.0], [0.9553, 0.901065, 0.118128, 1.0], [0.964894, 0.902323, 0.123941, 1.0], [0.974417, 0.90359, 0.130215, 1.0], [0.983868, 0.904867, 0.136897, 1.0], [0.993248, 0.906157, 0.143936, 1.0]], "colormap_name": "viridis"}, "physics_type": "solid_mechanics", "field_info": {}, "is_transient": false, "time_steps": [], "time_series": [], "time_stepping": {}, "initial_conditions": {}};

// Debug: Log mesh data to verify deformed coordinates
console.log('Mesh data loaded:', {
	vertices_count: meshData.vertices ? meshData.vertices.length : 0,
	faces_count: meshData.faces ? meshData.faces.length : 0,
	first_vertex: meshData.vertices ? meshData.vertices[0] : null,
	physics_type: fieldData.physics_type || 'unknown'
});

const settings = {"colormap": "viridis", "opacity": 0.8, "show_colorbar": true, "background_color": [0.1, 0.1, 0.1]};

const isTransient = fieldData.is_transient === true;
const timeSeries = Array.isArray(fieldData.time_series)
	? fieldData.time_series
	: (Array.isArray(fieldData.solutions) ? fieldData.solutions : []);
const rawTimeSteps = Array.isArray(fieldData.time_steps) ? fieldData.time_steps : [];
const timeSteps = rawTimeSteps.length === timeSeries.length
	? rawTimeSteps
	: timeSeries.map((snapshot, index) => {
		if (snapshot && typeof snapshot.time === 'number') {
			return snapshot.time;
		}
		return index;
	});
// Initialize to first frame (t=0) for transient solutions, not the last frame
let currentTimeIndex = 0;
let isPlaying = false;
let playbackInterval = null;
let playbackSpeed = 1.0;
let loopPlayback = false;

// VTK.js setup
let renderWindow, renderer, actor;
let fieldMin, fieldMax, fieldMean;
let globalFieldMin, globalFieldMax; // Global min/max for transient solutions (fixed colorbar range)
let currentColormap = 'viridis';
let meshDimension = 1; // Default to 1D, will be updated based on mesh data
let currentViewMode = 'all'; // 'all', 'surface', 'volume'

function hideControlsFor1DMesh() {
	// Check if this is a 1D mesh
	if (meshData.cells && Array.isArray(meshData.cells) && meshData.cells.length > 0) {
		
		// Hide any surface/volume controls that might exist
		const surfaceControls = document.querySelectorAll('[id*="surface"], [id*="volume"], [class*="surface"], [class*="volume"]');
		surfaceControls.forEach(control => {
			control.style.display = 'none';
		});
		
		// Hide surface option in representation dropdown for 1D meshes
		const surfaceOption = document.getElementById('surface-option');
		if (surfaceOption) {
			surfaceOption.style.display = 'none';
		}
	}
}

function init() {
	// Calculate global min/max from all available data (transient frames + steady-state)
	// This ensures a fixed colorbar range for all frames (both transient and steady-state)
	if (isTransient && Array.isArray(timeSeries) && timeSeries.length > 0) {
		let minVal = Infinity;
		let maxVal = -Infinity;
		
		// Find min/max across all transient frames
		for (const snapshot of timeSeries) {
			if (snapshot && Array.isArray(snapshot.values) && snapshot.values.length > 0) {
				const frameMin = Math.min(...snapshot.values);
				const frameMax = Math.max(...snapshot.values);
				minVal = Math.min(minVal, frameMin);
				maxVal = Math.max(maxVal, frameMax);
			}
		}
		
		// Also include steady-state solution if available
		const timeStepping = fieldData.time_stepping || {};
		const steadyState = timeStepping.steady_state_solution;
		if (steadyState && Array.isArray(steadyState.values) && steadyState.values.length > 0) {
			const ssMin = Math.min(...steadyState.values);
			const ssMax = Math.max(...steadyState.values);
			minVal = Math.min(minVal, ssMin);
			maxVal = Math.max(maxVal, ssMax);
		}
		
		// Set global range if we found valid values
		if (isFinite(minVal) && isFinite(maxVal)) {
			globalFieldMin = minVal;
			globalFieldMax = maxVal;
			console.log('Calculated global min/max from all frames (transient + steady-state):', globalFieldMin, globalFieldMax);
		}
		// Fallback: Use fieldData min/max if available
		else if (typeof fieldData.min_value === 'number' && typeof fieldData.max_value === 'number') {
			globalFieldMin = fieldData.min_value;
			globalFieldMax = fieldData.max_value;
			console.log('Using fieldData min/max as global range:', globalFieldMin, globalFieldMax);
		}
	}

	// Calculate field statistics
	calculateFieldStats();

	// Hide inappropriate controls for 1D meshes
	hideControlsFor1DMesh();

	// Create render window and attach to VTK container (like mesh visualization)
	window.vtkContainer = document.getElementById('vtk-container');
	const mainContainer = document.getElementById('container');
	renderWindow = vtk.Rendering.Core.vtkRenderWindow.newInstance();
	
	// Create OpenGL render window and attach to VTK container only
	const openGLRenderWindow = vtk.Rendering.OpenGL.vtkRenderWindow.newInstance();
	openGLRenderWindow.setContainer(window.vtkContainer);
	
	// Enable high-quality rendering (using supported methods)
	openGLRenderWindow.setUseOffScreen(false);
	openGLRenderWindow.setSize(window.vtkContainer.clientWidth, window.vtkContainer.clientHeight);
	
	
	renderWindow.addView(openGLRenderWindow);

	// Create renderer
	renderer = vtk.Rendering.Core.vtkRenderer.newInstance();
	renderWindow.addRenderer(renderer);


	// Create interactor with mouse controls - bind only to VTK container
	const interactor = vtk.Rendering.Core.vtkRenderWindowInteractor.newInstance();
	interactor.setView(openGLRenderWindow);
	interactor.initialize();
	interactor.bindEvents(window.vtkContainer);
	
	// Set up mouse controls
	interactor.setInteractorStyle(vtk.Interaction.Style.vtkInteractorStyleTrackballCamera.newInstance());
	

	// For transient solutions, apply the first frame (t=0) before creating the field mesh
	if (isTransient && Array.isArray(timeSeries) && timeSeries.length > 0) {
		// Ensure we're at the first frame (t=0)
		currentTimeIndex = 0;
		const firstSnapshot = timeSeries[0];
		if (firstSnapshot && Array.isArray(firstSnapshot.values)) {
			// Apply the first frame's values
			fieldData.values = firstSnapshot.values.slice();
			
			// Update field statistics from first snapshot
			if (typeof firstSnapshot.min_value === 'number' && typeof firstSnapshot.max_value === 'number' && typeof firstSnapshot.mean_value === 'number') {
				// Always use global min/max for colorbar (calculated from all frames)
				if (typeof globalFieldMin === 'number' && typeof globalFieldMax === 'number') {
					fieldMin = globalFieldMin;
					fieldMax = globalFieldMax;
				} else {
					// Fallback if global range not set
					fieldMin = firstSnapshot.min_value;
					fieldMax = firstSnapshot.max_value;
				}
				fieldMean = firstSnapshot.mean_value;
			} else {
				calculateFieldStats(fieldData.values);
				// Use global range for colorbar if available
				if (typeof globalFieldMin === 'number' && typeof globalFieldMax === 'number') {
					fieldMin = globalFieldMin;
					fieldMax = globalFieldMax;
				}
			}
		}
	}

	// Create field mesh
	createFieldMesh('all');

	// Setup controls
	setupControls();
	
	// Ensure view controls are shown for 3D meshes (check after createFieldMesh sets meshDimension)
	// This will be handled in createFieldMesh, but we also check here as backup
	const viewControls = document.getElementById('view-controls');
	if (viewControls && typeof meshDimension !== 'undefined' && meshDimension === 3) {
		viewControls.style.display = 'flex';
		updateViewButtonStates();
	}

	// Update info
	updateInfo();

	// Show colorbar
		showColorbar();

	// Hide loading
	document.getElementById('loading').style.display = 'none';

	// Start animation
	renderWindow.render();
}

function createMeshOnly() {
	
	// Determine mesh dimension based on data (same logic as createFieldMesh)
	if (meshData.faces && meshData.faces.length > 0) {
		meshDimension = 3; // 3D mesh
	} else if (meshData.cells && typeof meshData.cells === 'object' && Object.keys(meshData.cells).length > 0) {
		// Check if we have line elements (1D mesh)
		if (meshData.cells.line_2nd || meshData.cells.line) {
			meshDimension = 1; // 1D mesh
		} else {
			meshDimension = 2; // 2D mesh
		}
	} else {
		meshDimension = 2; // Default to 2D
	}
	
	// Show/hide view controls based on mesh dimension
	const viewControls = document.getElementById('view-controls');
	if (viewControls) {
		if (meshDimension === 3) {
			viewControls.style.display = 'flex';
			updateViewButtonStates();
		} else {
			viewControls.style.display = 'none';
		}
	}
	
	// Clear existing actors from renderer
	if (renderer) {
		renderer.removeAllActors();
	}

	// Create VTK polydata
	const polydata = vtk.Common.DataModel.vtkPolyData.newInstance();
	const points = vtk.Common.Core.vtkPoints.newInstance();
	const cellArray = vtk.Common.Core.vtkCellArray.newInstance();
	const lineCellArray = vtk.Common.Core.vtkCellArray.newInstance();

	// Set vertices
	// For solid mechanics, meshData.vertices contains deformed coordinates (original + displacement)
	// For other physics types, meshData.vertices contains original coordinates
	const vertices = new Float32Array(meshData.vertices.flat());
	points.setData(vertices, 3); 
	polydata.setPoints(points);

	// Process all element types (same logic as createFieldMesh)
	let processedElements = 0;
	
	// Process volume elements (tetrahedrons) - only if viewMode allows volume elements
	if (meshData.cells && typeof meshData.cells === 'object' && (currentViewMode === 'all' || currentViewMode === 'volume')) {
    log('=== PROCESSING VOLUME ELEMENTS ===');
    log('View mode:', currentViewMode);
		if (meshData.cells.tetrahedron && meshData.cells.tetrahedron.length > 0) {
			for (let i = 0; i < meshData.cells.tetrahedron.length; i++) {
				const tetra = meshData.cells.tetrahedron[i];
				if (Array.isArray(tetra) && tetra.length === 4) {
					cellArray.insertNextCell(tetra);
					processedElements++;
				}
			}
		}
		
		if (meshData.cells.tetrahedron_2nd && meshData.cells.tetrahedron_2nd.length > 0) {
			for (let i = 0; i < meshData.cells.tetrahedron_2nd.length; i++) {
				const tetra_2nd = meshData.cells.tetrahedron_2nd[i];
				if (Array.isArray(tetra_2nd) && tetra_2nd.length === 10) {
					// Convert P2 tetrahedron to 8 P1 tetrahedrons
					cellArray.insertNextCell([tetra_2nd[0], tetra_2nd[4], tetra_2nd[6], tetra_2nd[7]]);
					cellArray.insertNextCell([tetra_2nd[4], tetra_2nd[1], tetra_2nd[5], tetra_2nd[8]]);
					cellArray.insertNextCell([tetra_2nd[6], tetra_2nd[5], tetra_2nd[2], tetra_2nd[9]]);
					cellArray.insertNextCell([tetra_2nd[7], tetra_2nd[8], tetra_2nd[9], tetra_2nd[3]]);
					cellArray.insertNextCell([tetra_2nd[4], tetra_2nd[5], tetra_2nd[6], tetra_2nd[7]]);
					cellArray.insertNextCell([tetra_2nd[4], tetra_2nd[5], tetra_2nd[8], tetra_2nd[7]]);
					cellArray.insertNextCell([tetra_2nd[5], tetra_2nd[6], tetra_2nd[9], tetra_2nd[7]]);
					cellArray.insertNextCell([tetra_2nd[4], tetra_2nd[6], tetra_2nd[8], tetra_2nd[9]]);
					processedElements += 8;
				}
			}
		}
	}
	
	// Process surface elements (triangles) - only if viewMode allows surface elements
	if (meshData.cells && typeof meshData.cells === 'object' && (currentViewMode === 'all' || currentViewMode === 'surface')) {
        log('=== PROCESSING SURFACE ELEMENTS FROM CELLS ===');
        log('View mode:', currentViewMode);
		if (meshData.cells.triangle && meshData.cells.triangle.length > 0) {
			for (let i = 0; i < meshData.cells.triangle.length; i++) {
				const triangle = meshData.cells.triangle[i];
				if (Array.isArray(triangle) && triangle.length === 3) {
					cellArray.insertNextCell(triangle);
					processedElements++;
				}
			}
		}
		
		if (meshData.cells.triangle_2nd && meshData.cells.triangle_2nd.length > 0) {
			for (let i = 0; i < meshData.cells.triangle_2nd.length; i++) {
				const triangle_2nd = meshData.cells.triangle_2nd[i];
				if (Array.isArray(triangle_2nd) && triangle_2nd.length === 6) {
					// Convert P2 triangle to 4 P1 triangles
					cellArray.insertNextCell([triangle_2nd[0], triangle_2nd[3], triangle_2nd[5]]);
					cellArray.insertNextCell([triangle_2nd[3], triangle_2nd[1], triangle_2nd[4]]);
					cellArray.insertNextCell([triangle_2nd[4], triangle_2nd[2], triangle_2nd[5]]);
					cellArray.insertNextCell([triangle_2nd[3], triangle_2nd[4], triangle_2nd[5]]);
					processedElements += 4;
				}
			}
		}
		
		if (meshData.cells.quad && meshData.cells.quad.length > 0) {
			log(`Processing ${meshData.cells.quad.length} quad elements`);
			for (let i = 0; i < meshData.cells.quad.length; i++) {
				const quad = meshData.cells.quad[i];
				if (Array.isArray(quad) && quad.length === 4) {
					// Split quad into two triangles
					cellArray.insertNextCell([quad[0], quad[1], quad[2]]);
					cellArray.insertNextCell([quad[0], quad[2], quad[3]]);
					processedElements += 2;
				}
			}
		}
	}
	
	// Process faces from meshData.faces (for 2D meshes) - only if viewMode allows surface elements
	if (meshData.faces && meshData.faces.length > 0 && (currentViewMode === 'all' || currentViewMode === 'surface')) {
	log('=== PROCESSING FACES FROM MESHDATA.FACES ===');
	log('View mode:', currentViewMode);
	log('Face cells length:', meshData.faces.length);
	log('First few elements:', meshData.faces.slice(0, 3));
		
		for (let i = 0; i < meshData.faces.length; i++) {
			const face = meshData.faces[i];
			if (Array.isArray(face) && face.length === 3) {
				// P1 triangle
				cellArray.insertNextCell(face);
				processedElements++;
			} else if (Array.isArray(face) && face.length === 6) {
				// P2 triangle - convert to 4 P1 triangles
				cellArray.insertNextCell([face[0], face[3], face[5]]);
				cellArray.insertNextCell([face[3], face[1], face[4]]);
				cellArray.insertNextCell([face[4], face[2], face[5]]);
				cellArray.insertNextCell([face[3], face[4], face[5]]);
				processedElements += 4;
			}
		}
	}
	
	// Process 1D elements (lines) - use separate cell array for lines
	let lineElements = 0;
	if (meshData.cells && typeof meshData.cells === 'object') {
		if (meshData.cells.line && meshData.cells.line.length > 0) {
			log(`Processing ${meshData.cells.line.length} line elements`);
			for (let i = 0; i < meshData.cells.line.length; i++) {
				const line = meshData.cells.line[i];
				if (Array.isArray(line) && line.length === 2) {
					lineCellArray.insertNextCell(line);
					lineElements++;
				}
			}
		}
		
		if (meshData.cells.line_2nd && meshData.cells.line_2nd.length > 0) {
			for (let i = 0; i < meshData.cells.line_2nd.length; i++) {
				const line_2nd = meshData.cells.line_2nd[i];
				if (Array.isArray(line_2nd) && line_2nd.length === 3) {
					// Convert P2 line to 2 P1 lines
					lineCellArray.insertNextCell([line_2nd[0], line_2nd[1]]);
					lineCellArray.insertNextCell([line_2nd[1], line_2nd[2]]);
					lineElements += 2;
				}
			}
		}
	}
	
	log(`Processed ${processedElements} poly elements and ${lineElements} line elements for mesh-only`);
	
	// Set the appropriate cell data based on what we have
	if (processedElements > 0) {
		polydata.setPolys(cellArray);
		log(`Set ${processedElements} poly elements for mesh-only`);
	}
	if (lineElements > 0) {
		polydata.setLines(lineCellArray);
		log(`Set ${lineElements} line elements for mesh-only`);
	}

	// Create mapper and actor (no field data)
	const mapper = vtk.Rendering.Core.vtkMapper.newInstance();
	mapper.setInputData(polydata);
	mapper.setScalarVisibility(false); // No field data to visualize
	
	actor = vtk.Rendering.Core.vtkActor.newInstance();
	actor.setMapper(mapper);

	// Set actor properties based on mesh dimension and current representation
	const actorProps = actor.getProperty();
	actorProps.setOpacity(0.8);
	
	// Get current representation from dropdown
	const representationSelect = document.getElementById('representation-select');
	const currentRepresentation = representationSelect ? parseInt(representationSelect.value) : 2;
	
	if (meshDimension === 1) {
		// 1D mesh - use thick lines
		actorProps.setColor(0.0, 1.0, 0.0); // Green color for mesh
		actorProps.setLineWidth(15); // Very thick lines
		actorProps.setRepresentation(1); // Wireframe
	} else {
		// 2D/3D mesh - use representation from dropdown
		actorProps.setColor(0.0, 1.0, 0.0); // Green color for mesh
		actorProps.setRepresentation(currentRepresentation); // Use selected representation
		
		// Set additional properties based on representation
		if (currentRepresentation === 0) {
			// Points representation
			actorProps.setPointSize(meshDimension === 2 ? 5 : 3);
		} else if (currentRepresentation === 1) {
			// Wireframe representation
			actorProps.setLineWidth(2);
			actorProps.setEdgeVisibility(true);
		} else if (currentRepresentation === 2) {
			// Surface representation
			actorProps.setOpacity(0.8);
			actorProps.setEdgeVisibility(true);
		}
	}

	// Add to renderer
	renderer.addActor(actor);

	// Reset camera to fit the mesh
	renderer.resetCamera();
	
	// Get camera for positioning
	const camera = renderer.getActiveCamera();
	
	// For 1D meshes, ensure proper camera positioning
	if (meshDimension === 1) {
		camera.setPosition(0, 0, 2); // Position camera to see the line
		camera.setFocalPoint(0.5, 0, 0); // Focus on center of line
		camera.setViewUp(0, 1, 0); // Set up direction
		renderer.resetCamera();
	}
	
	// Force render to ensure mesh is visible
	renderWindow.render();
}

function changeFieldDisplay(displayType) {
	log('Changing field display to:', displayType);
	
	// Clear all existing actors from renderer
	if (renderer) {
		renderer.removeAllActors();
		log('Cleared all actors from renderer');
	}

	if (isTransient && displayType === 'none') {
		stopPlayback();
	}
	
	if (displayType === 'none') {
		// Show mesh only
		createMeshOnly();
		// Hide field-related controls
		const colormapGroup = document.getElementById('colormap-group');
		if (colormapGroup) {
			colormapGroup.style.display = 'none';
		}
		document.getElementById('colorbar').style.display = 'none';
		document.getElementById('colorbar-labels').style.display = 'none';
	} else {
		// Show field visualization
		createFieldMesh(currentViewMode);
		// Show field-related controls
		const colormapGroup = document.getElementById('colormap-group');
		if (colormapGroup) {
			colormapGroup.style.display = 'block';
		}
		document.getElementById('colorbar').style.display = 'block';
		document.getElementById('colorbar-labels').style.display = 'block';
	}
	
	// Update button states for view controls
	updateViewButtonStates();
	
	// Render the changes
	renderWindow.render();
}

function calculateFieldStats(valuesOverride = null) {
	const values = Array.isArray(valuesOverride) ? valuesOverride : fieldData.values;
	if (!values || values.length === 0) {
		// Use global min/max if available (for both transient and steady-state)
		if (typeof globalFieldMin === 'number' && typeof globalFieldMax === 'number') {
			fieldMin = globalFieldMin;
			fieldMax = globalFieldMax;
		} else {
			fieldMin = 0;
			fieldMax = 0;
		}
		fieldMean = 0;
		return;
	}

	// Always use global min/max if available (calculated from all frames)
	// This ensures fixed colorbar range for both transient frames and steady-state
	if (typeof globalFieldMin === 'number' && typeof globalFieldMax === 'number') {
		fieldMin = globalFieldMin;
		fieldMax = globalFieldMax;
	} else {
		// Calculate from current values (fallback if global range not set)
		fieldMin = Math.min(...values);
		fieldMax = Math.max(...values);
		
		// For transient solutions, store calculated range as global if not already set
		if (isTransient && (typeof globalFieldMin !== 'number' || typeof globalFieldMax !== 'number')) {
			globalFieldMin = fieldMin;
			globalFieldMax = fieldMax;
		}
	}
	fieldMean = values.reduce((a, b) => a + b, 0) / values.length;
}

function initializeTimeControls() {
	const timeControls = document.getElementById('time-controls');
	if (!isTransient || !timeControls) {
		return;
	}

	if (!Array.isArray(timeSeries) || timeSeries.length === 0 || !Array.isArray(timeSeries[0].values)) {
		console.warn('Transient mode enabled but no time-series data available.');
		return;
	}

	timeControls.style.display = 'block';

	const slider = document.getElementById('time-slider');
	if (slider) {
		slider.max = timeSeries.length - 1;
	}
	
	// Show/hide steady-state button based on availability
	const steadyStateBtn = document.getElementById('steady-state-btn');
	if (steadyStateBtn) {
		const timeStepping = fieldData.time_stepping || {};
		const steadyState = timeStepping.steady_state_solution;
		if (steadyState && Array.isArray(steadyState.values)) {
			steadyStateBtn.style.display = 'block';
		} else {
			steadyStateBtn.style.display = 'none';
		}
	}

	currentTimeIndex = Math.min(Math.max(0, currentTimeIndex), timeSeries.length - 1);

		const snapshot = timeSeries[currentTimeIndex];
		if (snapshot && Array.isArray(snapshot.values)) {
			const needsUpdate =
				!Array.isArray(fieldData.values) ||
				fieldData.values.length !== snapshot.values.length;
			if (needsUpdate) {
				applyTimeStep(currentTimeIndex, { force: true, skipSlider: true });
			} else {
				if (typeof snapshot.min_value === 'number' && typeof snapshot.max_value === 'number' && typeof snapshot.mean_value === 'number') {
					// Always use global min/max for colorbar (calculated from all frames)
					// This ensures fixed colorbar range for both transient frames and steady-state
					if (typeof globalFieldMin === 'number' && typeof globalFieldMax === 'number') {
						fieldMin = globalFieldMin;
						fieldMax = globalFieldMax;
					} else {
						// Fallback if global range not available
						fieldMin = snapshot.min_value;
						fieldMax = snapshot.max_value;
					}
					fieldMean = snapshot.mean_value;
				} else {
					calculateFieldStats(snapshot.values);
				}
				updateInfo();
				updateTimeDisplay(currentTimeIndex, { skipSlider: true });
			}
		}

	updatePlayButton();

	const playButton = document.getElementById('play-pause-btn');
	if (playButton && timeSeries.length <= 1) {
		playButton.disabled = true;
		playButton.classList.add('disabled');
	}
}

function applyTimeStep(index, options = {}) {
	if (!isTransient || !Array.isArray(timeSeries) || timeSeries.length === 0) {
		return false;
	}

	let targetIndex = Number(index);
	if (!Number.isFinite(targetIndex)) {
		targetIndex = 0;
	}

	targetIndex = Math.max(0, Math.min(timeSeries.length - 1, targetIndex));

	if (!options.force && targetIndex === currentTimeIndex) {
		updateTimeDisplay(targetIndex, { skipSlider: options.skipSlider });
		return true;
	}

	const snapshot = timeSeries[targetIndex];
	if (!snapshot || !Array.isArray(snapshot.values)) {
		console.warn('Missing time-step snapshot values for index', targetIndex);
		return false;
	}

	currentTimeIndex = targetIndex;
	fieldData.values = snapshot.values.slice();

	if (typeof snapshot.min_value === 'number' && typeof snapshot.max_value === 'number' && typeof snapshot.mean_value === 'number') {
		// Always use global min/max for colorbar (calculated from all frames)
		// This ensures fixed colorbar range for both transient frames and steady-state
		if (typeof globalFieldMin === 'number' && typeof globalFieldMax === 'number') {
			fieldMin = globalFieldMin;
			fieldMax = globalFieldMax;
		} else {
			// Fallback if global range not available
			fieldMin = snapshot.min_value;
			fieldMax = snapshot.max_value;
		}
		fieldMean = snapshot.mean_value;
	} else {
		calculateFieldStats(fieldData.values);
	}

	updateInfo();
	createFieldMesh(currentViewMode);
	updateTimeDisplay(targetIndex, { skipSlider: options.skipSlider });

	return true;
}

function updateTimeDisplay(index, options = {}) {
	const slider = document.getElementById('time-slider');
	if (slider && !options.skipSlider) {
		slider.value = index;
	}

	const timeLabel = document.getElementById('time-display');
	if (timeLabel) {
		const timeValue = timeSteps[index] !== undefined ? timeSteps[index] :
			(timeSeries[index] && typeof timeSeries[index].time === 'number' ? timeSeries[index].time : index);
		const numericTime = Number(timeValue);
		const formatted = Number.isFinite(numericTime) ? numericTime.toFixed(3) : String(timeValue);
		timeLabel.textContent = `t = ${formatted} s`;
	}
}

function updatePlayButton() {
	const playButton = document.getElementById('play-pause-btn');
	if (!playButton) {
		return;
	}
	playButton.textContent = isPlaying ? 'Pause' : 'Play';
}

function startPlayback() {
	if (!isTransient || isPlaying || !Array.isArray(timeSeries) || timeSeries.length <= 1) {
		return;
	}

	isPlaying = true;
	updatePlayButton();

	const baseIntervalMs = 100;  // Reduced from 1000ms to 100ms for faster playback
	const intervalMs = Math.max(20, baseIntervalMs / playbackSpeed);  // Minimum 20ms instead of 50ms

	playbackInterval = setInterval(() => {
		const advanced = stepForward({ fromPlayback: true });
		if (!advanced) {
			if (loopPlayback) {
				applyTimeStep(0, { force: true });
			} else {
				stopPlayback();
			}
		}
	}, intervalMs);
}

function stopPlayback() {
	if (playbackInterval) {
		clearInterval(playbackInterval);
		playbackInterval = null;
	}
	if (isPlaying) {
		isPlaying = false;
		updatePlayButton();
	}
}

function togglePlayback() {
	if (isPlaying) {
		stopPlayback();
	} else {
		startPlayback();
	}
}

function onTimeSliderChange(value) {
	stopPlayback();
	applyTimeStep(parseInt(value, 10));
}

function updatePlaybackSpeed(value) {
	const parsed = parseFloat(value);
	if (!Number.isFinite(parsed) || parsed <= 0) {
		return;
	}
	playbackSpeed = parsed;
	if (isPlaying) {
		stopPlayback();
		startPlayback();
	}
}

function toggleLoop(checked) {
	loopPlayback = !!checked;
}

function stepForward(options = {}) {
	if (!isTransient || !Array.isArray(timeSeries) || timeSeries.length === 0) {
		return false;
	}

	if (!options.fromPlayback) {
		stopPlayback();
	}

	let nextIndex = currentTimeIndex + 1;
	if (nextIndex >= timeSeries.length) {
		if (loopPlayback || options.wrap) {
			nextIndex = 0;
		} else {
			return false;
		}
	}

	return applyTimeStep(nextIndex);
}

function stepBackward() {
	if (!isTransient || !Array.isArray(timeSeries) || timeSeries.length === 0) {
		return false;
	}

	stopPlayback();

	let prevIndex = currentTimeIndex - 1;
	if (prevIndex < 0) {
		prevIndex = loopPlayback ? timeSeries.length - 1 : 0;
	}

	return applyTimeStep(prevIndex);
}

function showSteadyState() {
	// Get steady-state solution from time_stepping data
	const timeStepping = fieldData.time_stepping || {};
	const steadyState = timeStepping.steady_state_solution;
	
	if (!steadyState || !Array.isArray(steadyState.values)) {
		console.warn('Steady-state solution not available');
		alert('Steady-state solution not available. It may not have been computed or the simulation may not have converged.');
		return;
	}
	
	// Apply steady-state solution to field data
	fieldData.values = steadyState.values.slice();
	
	// Update field statistics
	// Always use global min/max for colorbar (calculated from all frames)
	if (typeof globalFieldMin === 'number' && typeof globalFieldMax === 'number') {
		fieldMin = globalFieldMin;
		fieldMax = globalFieldMax;
		if (typeof steadyState.mean_value === 'number') {
			fieldMean = steadyState.mean_value;
		} else {
			calculateFieldStats(fieldData.values);
			// Re-apply global range after calculating (mean might have changed)
			if (typeof globalFieldMin === 'number' && typeof globalFieldMax === 'number') {
				fieldMin = globalFieldMin;
				fieldMax = globalFieldMax;
			}
		}
	} else {
		// Fallback: use steady-state min/max if global not available
		if (typeof steadyState.min_value === 'number' && typeof steadyState.max_value === 'number' && typeof steadyState.mean_value === 'number') {
			fieldMin = steadyState.min_value;
			fieldMax = steadyState.max_value;
			fieldMean = steadyState.mean_value;
		} else {
			calculateFieldStats(fieldData.values);
		}
	}
	
	// Update display
	updateInfo();
	createFieldMesh(currentViewMode);
	
	// Update time display to show "Steady-State"
	const timeDisplay = document.getElementById('time-display');
	if (timeDisplay) {
		timeDisplay.textContent = 't =  (Steady-State)';
	}
	
	// Disable time slider and controls while showing steady-state
	const slider = document.getElementById('time-slider');
	if (slider) {
		slider.disabled = true;
	}
	
	// Update button text
	const btn = document.getElementById('steady-state-btn');
	if (btn) {
		btn.textContent = 'Show Transient';
		btn.onclick = showTransient;
	}
	
	console.log('Displaying steady-state solution');
}

function showTransient() {
	// Restore transient view
	if (!isTransient || !Array.isArray(timeSeries) || timeSeries.length === 0) {
		return;
	}
	
	// Re-enable time slider
	const slider = document.getElementById('time-slider');
	if (slider) {
		slider.disabled = false;
	}
	
	// Restore current time step
	applyTimeStep(currentTimeIndex, { force: true });
	
	// Update button text
	const btn = document.getElementById('steady-state-btn');
	if (btn) {
		btn.textContent = 'Show Steady-State';
		btn.onclick = showSteadyState;
	}
}

function createFieldMesh(viewMode = 'all', representation = null) {
	
	// Update current view mode
	currentViewMode = viewMode;
	
	// Processing mesh data

	// Determine mesh dimension based on data
	// Check for 3D volume elements first (tetrahedrons)
	if (meshData.cells && typeof meshData.cells === 'object') {
		if (meshData.cells.tetrahedron || meshData.cells.tetrahedron_2nd) {
			meshDimension = 3; // 3D mesh with volume elements
		} else if (meshData.cells.line_2nd || meshData.cells.line) {
			meshDimension = 1; // 1D mesh
		} else if (meshData.cells.triangle || meshData.cells.triangle_2nd || meshData.cells.quad) {
			meshDimension = 2; // 2D mesh
		}
	}
	// Also check for faces (surface elements) - indicates 3D mesh
	if (meshData.faces && meshData.faces.length > 0) {
		meshDimension = 3; // 3D mesh (has surface faces)
	}
	// Default fallback
	if (typeof meshDimension === 'undefined') {
		meshDimension = 2; // Default to 2D
	}
	
	// Show/hide view controls based on mesh dimension
	const viewControls = document.getElementById('view-controls');
	if (viewControls) {
		if (meshDimension === 3) {
			viewControls.style.display = 'flex'; // Use flex to show buttons side by side
			// Update button states when controls are shown
			updateViewButtonStates();
		} else {
			viewControls.style.display = 'none';
		}
	}
	
	// Clear existing actors from renderer
	if (renderer) {
		renderer.removeAllActors();
	}
	
	if (!meshData.vertices || meshData.vertices.length === 0) {
		console.error('No mesh data available');
		throw new Error('No mesh data available');
	}

	// Create VTK polydata
	const polydata = vtk.Common.DataModel.vtkPolyData.newInstance();
	const points = vtk.Common.Core.vtkPoints.newInstance();
	const cellArray = vtk.Common.Core.vtkCellArray.newInstance();
	const lineCellArray = vtk.Common.Core.vtkCellArray.newInstance();

	// Set vertices
	// For solid mechanics, meshData.vertices contains deformed coordinates (original + displacement)
	// For other physics types, meshData.vertices contains original coordinates
	const vertices = new Float32Array(meshData.vertices.flat());
	
	// Debug: Log vertex data for solid mechanics
	if (fieldData.physics_type === 'solid_mechanics') {
		console.log('Solid mechanics visualization - using vertices:', {
			vertex_count: vertices.length / 3,
			first_vertex: [vertices[0], vertices[1], vertices[2]],
			vertex_range: {
				x: [Math.min(...Array.from(vertices.filter((_, i) => i % 3 === 0))), Math.max(...Array.from(vertices.filter((_, i) => i % 3 === 0)))],
				y: [Math.min(...Array.from(vertices.filter((_, i) => i % 3 === 1))), Math.max(...Array.from(vertices.filter((_, i) => i % 3 === 1)))],
				z: [Math.min(...Array.from(vertices.filter((_, i) => i % 3 === 2))), Math.max(...Array.from(vertices.filter((_, i) => i % 3 === 2)))]
			}
		});
	}
	
	points.setData(vertices, 3); 
	polydata.setPoints(points);
	
	

	// Set mesh connectivity - filter elements based on viewMode
	let processedElements = 0;
	
	// Process volume elements (3D meshes) - only for volume view or all view
	if (meshData.cells && typeof meshData.cells === 'object' && meshDimension === 3 && (viewMode === 'all' || viewMode === 'volume')) {
		log(`Processing volume elements for viewMode: ${viewMode}`);
	// Process volume elements
		
		// Process tetrahedron elements
		if (meshData.cells.tetrahedron && meshData.cells.tetrahedron.length > 0) {
			for (let i = 0; i < meshData.cells.tetrahedron.length; i++) {
				const tetra = meshData.cells.tetrahedron[i];
				if (Array.isArray(tetra) && tetra.length === 4) {
					cellArray.insertNextCell(tetra);
					processedElements++;
				}
			}
		}
		
		// Process second-order tetrahedron elements
		if (meshData.cells.tetrahedron_2nd && meshData.cells.tetrahedron_2nd.length > 0) {
			for (let i = 0; i < meshData.cells.tetrahedron_2nd.length; i++) {
				const tetra_2nd = meshData.cells.tetrahedron_2nd[i];
				if (Array.isArray(tetra_2nd) && tetra_2nd.length === 10) {
					// Convert P2 tetrahedron to 8 P1 tetrahedrons (like mesh preview)
					cellArray.insertNextCell([tetra_2nd[0], tetra_2nd[4], tetra_2nd[6], tetra_2nd[7]]);
					cellArray.insertNextCell([tetra_2nd[4], tetra_2nd[1], tetra_2nd[5], tetra_2nd[8]]);
					cellArray.insertNextCell([tetra_2nd[6], tetra_2nd[5], tetra_2nd[2], tetra_2nd[9]]);
					cellArray.insertNextCell([tetra_2nd[7], tetra_2nd[8], tetra_2nd[9], tetra_2nd[3]]);
					cellArray.insertNextCell([tetra_2nd[0], tetra_2nd[4], tetra_2nd[7], tetra_2nd[6]]);
					cellArray.insertNextCell([tetra_2nd[4], tetra_2nd[1], tetra_2nd[8], tetra_2nd[5]]);
					cellArray.insertNextCell([tetra_2nd[6], tetra_2nd[5], tetra_2nd[9], tetra_2nd[7]]);
					cellArray.insertNextCell([tetra_2nd[7], tetra_2nd[8], tetra_2nd[4], tetra_2nd[6]]);
					processedElements += 8;
				}
			}
		}
	}
	
	// Process surface elements (faces) - only for surface view or all view
	if ((viewMode === 'all' || viewMode === 'surface') && 
		((meshData.cells && typeof meshData.cells === 'object') || 
		(meshData.faces && meshData.faces.length > 0))) {
		log(`Processing surface elements for viewMode: ${viewMode}`);
	// Process surface elements
		
		// Process surface elements from cells dictionary
		if (meshData.cells && typeof meshData.cells === 'object') {
			// Process triangle elements
			if (meshData.cells.triangle && meshData.cells.triangle.length > 0) {
				for (let i = 0; i < meshData.cells.triangle.length; i++) {
					const triangle = meshData.cells.triangle[i];
					if (Array.isArray(triangle) && triangle.length === 3) {
						cellArray.insertNextCell(triangle);
						processedElements++;
					}
				}
			}
			
			// Process second-order triangle elements
			if (meshData.cells.triangle_2nd && meshData.cells.triangle_2nd.length > 0) {
				for (let i = 0; i < meshData.cells.triangle_2nd.length; i++) {
					const triangle_2nd = meshData.cells.triangle_2nd[i];
					if (Array.isArray(triangle_2nd) && triangle_2nd.length === 6) {
						// Convert P2 triangle to 4 P1 triangles (like mesh preview)
						cellArray.insertNextCell([triangle_2nd[0], triangle_2nd[3], triangle_2nd[5]]);
						cellArray.insertNextCell([triangle_2nd[3], triangle_2nd[1], triangle_2nd[4]]);
						cellArray.insertNextCell([triangle_2nd[4], triangle_2nd[2], triangle_2nd[5]]);
						cellArray.insertNextCell([triangle_2nd[3], triangle_2nd[4], triangle_2nd[5]]);
						processedElements += 4;
					}
				}
			}
			
			// Process quad elements
			if (meshData.cells.quad && meshData.cells.quad.length > 0) {
				for (let i = 0; i < meshData.cells.quad.length; i++) {
					const quad = meshData.cells.quad[i];
					if (Array.isArray(quad) && quad.length === 4) {
						// Split quad into two triangles
						cellArray.insertNextCell([quad[0], quad[1], quad[2]]);
						cellArray.insertNextCell([quad[0], quad[2], quad[3]]);
						processedElements += 2;
					}
				}
			}
		}
		
		// Process faces from meshData.faces (for 2D meshes) - only if viewMode allows surface elements
	if (meshData.faces && meshData.faces.length > 0 && (viewMode === 'all' || viewMode === 'surface')) {
		log(`Processing faces for viewMode: ${viewMode}`);
		// Process faces from meshData.faces
			
			for (let i = 0; i < meshData.faces.length; i++) {
				const face = meshData.faces[i];
				if (Array.isArray(face) && face.length === 3) {
					// P1 triangle
					cellArray.insertNextCell(face);
					processedElements++;
				} else if (Array.isArray(face) && face.length === 6) {
					// P2 triangle - convert to 4 P1 triangles
					cellArray.insertNextCell([face[0], face[3], face[5]]);
					cellArray.insertNextCell([face[3], face[1], face[4]]);
					cellArray.insertNextCell([face[4], face[2], face[5]]);
					cellArray.insertNextCell([face[3], face[4], face[5]]);
					processedElements += 4;
				}
			}
		}
		
		// Processed surface elements
	}
	
	// Process 1D elements (lines) - always process these regardless of view mode
	if (meshData.cells && typeof meshData.cells === 'object') {
		// Process line elements
		if (meshData.cells.line && meshData.cells.line.length > 0) {
			for (let i = 0; i < meshData.cells.line.length; i++) {
				const line = meshData.cells.line[i];
				if (Array.isArray(line) && line.length === 2) {
					cellArray.insertNextCell(line);
					processedElements++;
				}
			}
		}
		
		// Process second-order line elements (1D)
		if (meshData.cells.line_2nd && meshData.cells.line_2nd.length > 0) {
			for (let i = 0; i < meshData.cells.line_2nd.length; i++) {
				const line_2nd = meshData.cells.line_2nd[i];
				if (Array.isArray(line_2nd) && line_2nd.length === 3) {
					// Convert P2 line to 2 P1 lines
					cellArray.insertNextCell([line_2nd[0], line_2nd[1]]);
					cellArray.insertNextCell([line_2nd[1], line_2nd[2]]);
					processedElements += 2;
				}
			}
		}
	}
	
	// Set mesh connectivity
	
	// Process 1D elements (lines) - use separate cell array for lines
	let lineElements = 0;
	if (meshData.cells && typeof meshData.cells === 'object') {
		if (meshData.cells.line && meshData.cells.line.length > 0) {
			log(`Processing ${meshData.cells.line.length} line elements`);
			for (let i = 0; i < meshData.cells.line.length; i++) {
				const line = meshData.cells.line[i];
				if (Array.isArray(line) && line.length === 2) {
					lineCellArray.insertNextCell(line);
					lineElements++;
				}
			}
		}
		
		if (meshData.cells.line_2nd && meshData.cells.line_2nd.length > 0) {
			for (let i = 0; i < meshData.cells.line_2nd.length; i++) {
				const line_2nd = meshData.cells.line_2nd[i];
				if (Array.isArray(line_2nd) && line_2nd.length === 3) {
					// Convert P2 line to 2 P1 lines
					lineCellArray.insertNextCell([line_2nd[0], line_2nd[1]]);
					lineCellArray.insertNextCell([line_2nd[1], line_2nd[2]]);
					lineElements += 2;
				}
			}
		}
	}
	
	// Set the appropriate cell data based on what we have
	// Set mesh connectivity
	if (processedElements > 0) {
		polydata.setPolys(cellArray);
	}
	if (lineElements > 0) {
		polydata.setLines(lineCellArray);
	}
	
	// Debug element counts
	log(`=== ELEMENT PROCESSING SUMMARY ===`);
	log(`View mode: ${viewMode}`);
	log(`Processed surface/volume elements: ${processedElements}`);
	log(`Processed line elements: ${lineElements}`);
	log(`Total elements: ${processedElements + lineElements}`);

	// Add field data for coloring
	// Check if fieldData is properly loaded
	if (typeof fieldData === 'undefined') {
		console.error('fieldData is undefined!');
		return;
	}
	if (!fieldData.values) {
		console.error('fieldData.values is undefined!');
		return;
	}
	
	// Handle mesh-only visualization (no field data)
	if (!fieldData.values || fieldData.values.length === 0) {
		// Create mesh without field data
		createMeshOnly();
		return;
	}
	
	if (fieldData.values.length !== meshData.vertices.length) {
		console.warn(`WARNING: Field values length (${fieldData.values.length}) does not match vertices length (${meshData.vertices.length})`);
	}
	
	// CRITICAL: Ensure scalar array matches mesh points exactly
	// Validate scalar data
	const numPoints = polydata.getPoints().getNumberOfPoints();
	const numValues = fieldData.values.length;
	
	log('=== SCALAR DATA VALIDATION ===');
	log('Polydata points count:', numPoints);
	log('Field values count:', numValues);
	log('Values match points:', numPoints === numValues);
	
	if (numPoints !== numValues) {
		console.error(`CRITICAL ERROR: Point count (${numPoints}) != Value count (${numValues})`);
		console.error('This will cause scalar coloring to fail!');
		
		// Try to fix by truncating or padding values
		let fixedValues = fieldData.values;
		if (numValues > numPoints) {
			fixedValues = fieldData.values.slice(0, numPoints);
			log(`Truncated values to ${numPoints} to match points`);
		} else if (numValues < numPoints) {
			// Pad with last value
			const lastValue = fieldData.values[fieldData.values.length - 1];
			fixedValues = [...fieldData.values, ...Array(numPoints - numValues).fill(lastValue)];
			log(`Padded values to ${numPoints} to match points`);
		}
		fieldData.values = fixedValues;
	}
	
	// Create scalar array
	const scalarValues = new Float32Array(fieldData.values.slice(0, numPoints));
	
	// Create scalar array
	let scalars = null;
	try {
		scalars = vtk.Common.Core.vtkDataArray.newInstance({
			name: 'values',
		numberOfComponents: 1,
			values: scalarValues
		});
	} catch (e) {
		console.error('Failed to create scalars:', e);
	}
	
	if (!scalars) {
		try {
			scalars = vtk.Common.Core.vtkDataArray.newInstance({
				name: 'values',
				numberOfComponents: 1,
				size: numPoints
			});
			for (let i = 0; i < numPoints; i++) {
				scalars.setValue(i, scalarValues[i]);
			}
		} catch (e) {
			console.error('Failed to create scalars:', e);
		}
	}
	
	if (scalars) {
		// Bind scalar data to polydata using Method 1 (Direct setScalars)
		polydata.getPointData().setScalars(scalars);
		polydata.modified();
	} else {
		console.error('CRITICAL: Failed to create scalar array!');
	}
	
	// Verify scalar binding
	log('=== SCALAR BINDING VERIFICATION ===');
	log('Scalars set on polydata:', polydata.getPointData().getScalars() ? 'YES' : 'NO');
	log('Active scalars set:', polydata.getPointData().getActiveScalars() ? 'YES' : 'NO');
	log('Scalar array size:', scalars.getNumberOfTuples());
	log('Scalar array components:', scalars.getNumberOfComponents());
	
	// Check for invalid values
	const scalarArrayValues = Array.from(scalars.getData());
	const hasNaN = scalarArrayValues.some(v => isNaN(v));
	const hasInf = scalarArrayValues.some(v => !isFinite(v));
	const allZero = scalarArrayValues.every(v => v === 0);
	
	log('=== SCALAR VALUE VALIDATION ===');
	log('Has NaN values:', hasNaN);
	log('Has infinite values:', hasInf);
	log('All values zero:', allZero);
	log('Min value:', Math.min(...scalarArrayValues));
	log('Max value:', Math.max(...scalarArrayValues));
	
	if (hasNaN || hasInf) {
		console.error('CRITICAL: Scalar array contains NaN or infinite values!');
	}
	if (allZero) {
		console.error('CRITICAL: All scalar values are zero!');
	}
	

	// Create mapper and actor
	const mapper = vtk.Rendering.Core.vtkMapper.newInstance();
	
	// CRITICAL: Set input data AFTER scalar data is bound
	mapper.setInputData(polydata);
	
	// Force mapper to update with the new polydata
	mapper.modified();
	
	// CRITICAL: Configure mapper for point data scalars
	mapper.setScalarVisibility(true);
	mapper.setScalarModeToUsePointData();
	mapper.setColorModeToMapScalars();
	mapper.setColorByArrayName('values');
	
	// Ensure fieldMin < fieldMax for correct color mapping
	const actualMin = Math.min(fieldMin, fieldMax);
	const actualMax = Math.max(fieldMin, fieldMax);
	
	mapper.setScalarRange(actualMin, actualMax);
	
	// Force scalar visibility - this is critical for coloring
	mapper.setScalarVisibility(true);
	
	// Additional mapper configuration
	if (mapper.setScalarArrayName) {
		mapper.setScalarArrayName('values');
	}
	
	// CRITICAL: Ensure mapper uses the scalar data for coloring
	mapper.setScalarModeToUsePointData();
	mapper.setColorModeToMapScalars();
	
	// Verify mapper configuration
	log('=== MAPPER CONFIGURATION VERIFICATION ===');
	log('Mapper scalar visibility:', mapper.getScalarVisibility());
	log('Mapper scalar mode:', mapper.getScalarMode());
	log('Mapper scalar range:', mapper.getScalarRange());
	log('Mapper color by array name:', mapper.getColorByArrayName());
	log('Mapper color mode:', mapper.getColorMode());
	
	// Verify mapper input
	const mapperInput = mapper.getInputData();
	if (mapperInput) {
		const pointData = mapperInput.getPointData();
		log('Mapper input has point data:', pointData ? 'YES' : 'NO');
		log('Mapper input has scalars:', pointData.getScalars() ? 'YES' : 'NO');
		if (pointData.getScalars()) {
			log('Mapper input scalar count:', pointData.getScalars().getNumberOfTuples());
			log('Mapper input scalar name:', pointData.getScalars().getName ? pointData.getScalars().getName() : 'No name method');
		}
	}

	// Use ColorTransferFunction for scalar coloring (VTK.js standard approach)
	const lutData = fieldData.lookup_table;
	let lut = null;
	
	// Always use ColorTransferFunction - it's the standard VTK.js approach for scalar coloring
	lut = vtk.Rendering.Core.vtkColorTransferFunction.newInstance();
	
	if (lutData && lutData.colors && lutData.colors.length > 0) {
		// CRITICAL: Use actualMin/actualMax (from field values) for mapping range, not lutData.range
		// This ensures the lookup table range matches the mapper's scalar range exactly
		// lutData.range might be from backend calculation and could be inverted or different
		const lutMin = actualMin; // Use actualMin from field values (ensures correct order)
		const lutMax = actualMax; // Use actualMax from field values (ensures correct order)
		
		// Verify range is valid
		if (lutMin >= lutMax) {
			log('WARNING: Invalid range for lookup table, using fieldMin/fieldMax instead');
			const lutMin_fallback = Math.min(fieldMin, fieldMax);
			const lutMax_fallback = Math.max(fieldMin, fieldMax);
			lut.setMappingRange(lutMin_fallback, lutMax_fallback);
		} else {
			// Set the mapping range to match mapper's scalar range
		lut.setMappingRange(lutMin, lutMax);
		}
		
		// Add color points to the transfer function
		// Standard colormap: first color maps to minimum, last color to maximum
		const range = lutMax - lutMin;
		if (range > 0) {
		for (let i = 0; i < lutData.colors.length; i++) {
				const color = lutData.colors[i]; // Use color in original order
				const scalarValue = lutMin + (i / (lutData.colors.length - 1)) * range;
			lut.addRGBPoint(scalarValue, color[0], color[1], color[2]);
			}
		} else {
			log('WARNING: Zero range for lookup table, using single color');
			const color = lutData.colors[0];
			lut.addRGBPoint(lutMin, color[0], color[1], color[2]);
		}
	} else {
		// Create a default viridis-like gradient
		// Standard colormap: Purple for minimum, Yellow for maximum
		lut.setMappingRange(actualMin, actualMax);
		
		const range = actualMax - actualMin;
		if (range > 0) {
			// Standard viridis colormap order
			lut.addRGBPoint(actualMin, 0.267, 0.004, 0.329); // Dark purple (low values)
			lut.addRGBPoint(actualMin + range * 0.25, 0.282, 0.140, 0.457); // Purple-blue
			lut.addRGBPoint(actualMin + range * 0.5, 0.253, 0.265, 0.529); // Blue
			lut.addRGBPoint(actualMin + range * 0.75, 0.206, 0.371, 0.406); // Blue-green
			lut.addRGBPoint(actualMax, 0.993, 0.906, 0.144); // Yellow (high values)
		}
	}
	
	// Set the lookup table on the mapper
	mapper.setLookupTable(lut);

	actor = vtk.Rendering.Core.vtkActor.newInstance();
	actor.setMapper(mapper);

	// Set actor properties (like mesh visualization)
	const actorProps = actor.getProperty();
	
	// CRITICAL: Don't set actor color - let scalar field coloring work
	// actorProps.setColor() would override scalar coloring
	
	// Set representation based on mesh dimension and parameter
	if (meshData.vertices && meshData.vertices.length > 0) {
		// Use the computed meshDimension to choose behavior
		if (meshDimension === 1) {
			// 1D mesh - use wireframe for line visibility (like mesh visualization)
			actorProps.setRepresentation(1); // Wireframe
			actorProps.setLineWidth(15); // Very thick lines for visibility (like mesh visualization)
			// Don't set color - let scalar field coloring work
			log('Set 1D mesh wireframe with thick lines');
			log('Actor representation:', actorProps.getRepresentation());
			log('Actor line width:', actorProps.getLineWidth());
		} else {
			// 2D/3D mesh - use representation parameter if provided, otherwise default to surface
			const repValue = representation !== null ? representation : 2; // Default to surface
			actorProps.setRepresentation(repValue);
			log(`Set ${meshDimension}D mesh representation to:`, repValue);
			
			// Set additional properties based on representation
			if (repValue === 0) {
				// Points representation
				actorProps.setPointSize(meshDimension === 2 ? 5 : 3);
			} else if (repValue === 1) {
				// Wireframe representation
				actorProps.setLineWidth(2);
				actorProps.setEdgeVisibility(true);
			} else if (repValue === 2) {
				// Surface representation
				actorProps.setOpacity(0.8);
				actorProps.setEdgeVisibility(true);
			}
		}
	}
	
	// Debug actor properties
	// Set actor properties

	// Add to renderer
	renderer.addActor(actor);
	window.actor = actor; // Store globally like mesh visualization
	window.renderer = renderer; // Store globally like mesh visualization
	window.renderWindow = renderWindow; // Store globally like mesh visualization

	// Reset camera to fit the mesh
	renderer.resetCamera();
	
	// Get camera for positioning and debugging
	const camera = renderer.getActiveCamera();
	
	// For 1D meshes, ensure proper camera positioning (like mesh visualization)
	if (meshDimension === 1) {
		// Calculate actual mesh bounds and center (like mesh visualization)
		const bounds = polydata.getBounds();
		const center = [
			(bounds[0] + bounds[1]) / 2,
			(bounds[2] + bounds[3]) / 2,
			(bounds[4] + bounds[5]) / 2
		];
		
		// Position camera above the mesh center (like mesh visualization)
		camera.setPosition(center[0], center[1], center[2] + 2);
		camera.setFocalPoint(center[0], center[1], center[2]);
		camera.setViewUp(0, 1, 0);
		
		// Set camera clipping planes to ensure 1D line is visible
		camera.setClippingRange(0.1, 100);
		
		renderer.resetCamera();
		
		// Debug scalar coloring
	log('=== SCALAR COLORING DEBUG ===');
	log('Mapper scalar visibility:', mapper.getScalarVisibility());
	log('Mapper scalar mode:', mapper.getScalarMode());
	log('Mapper scalar range:', mapper.getScalarRange());
	log('Actor representation:', actorProps.getRepresentation());
	log('Actor line width:', actorProps.getLineWidth());
	}
	
	// Show colorbar for field visualization
	showColorbar();
	
	// Final debug check for scalar coloring
	// Final verification
	log('=== FINAL SCALAR COLORING CHECK ===');
	log('Polydata has scalars:', polydata.getPointData().getScalars() ? 'YES' : 'NO');
	log('Mapper scalar visibility:', mapper.getScalarVisibility());
	log('Mapper scalar mode:', mapper.getScalarMode());
	log('Mapper lookup table:', mapper.getLookupTable() ? 'SET' : 'NOT SET');
	log('Actor added to renderer:', renderer.getActors().length > 0);
	
	// Force render to ensure mesh is visible
	renderWindow.render();
}

function setupControls() {
	// Colormap is now fixed to viridis - no controls needed

	// Opacity change

	// Range selection removed - no longer needed
	initializeTimeControls();
}

function updateInfo() {
	document.getElementById('field-min').textContent = fieldMin.toFixed(3);
	document.getElementById('field-max').textContent = fieldMax.toFixed(3);
	document.getElementById('field-mean').textContent = fieldMean.toFixed(3);
}

function showColorbar() {
	const colorbar = document.getElementById('colorbar');
	if (colorbar) {
		colorbar.style.display = 'block';
	updateColorbar();
	}
}

function updateVTKColormap() {
	if (!window.actor || !window.actor.getMapper()) {
		console.error('Actor or mapper not available');
		return;
	}
	
	const mapper = window.actor.getMapper();
	const lut = mapper.getLookupTable();
	
	if (!lut) {
		console.error('Lookup table not available');
		return;
	}
        
        // Always use viridis colormap
        const vtkPresetName = 'viridis';
        
        // Update the lookup table with new colormap
        lut.setRange(fieldMin, fieldMax);
        lut.setNumberOfColors(256); // Use standard 256 colors
        
        // Apply the built-in colormap preset
        try {
            // Try to use VTK.js built-in colormap if available
            if (vtk.Rendering.Core.ColorTransferFunction && vtk.Rendering.Core.ColorTransferFunction.ColorMaps) {
                log('Available VTK colormaps:', vtk.Rendering.Core.ColorTransferFunction.ColorMaps.getPresetNames());
                const preset = vtk.Rendering.Core.ColorTransferFunction.ColorMaps.getPresetByName(vtkPresetName);
                if (preset) {
                    log('Using VTK preset:', vtkPresetName);
                    lut.applyColorMap(preset);
                } else {
                    log('VTK preset not found:', vtkPresetName, 'using fallback');
                    // Fallback to default colormap
                    lut.setHueRange(0.0, 0.67); // Blue to red
                }
            } else {
                // Fallback to default colormap
                lut.setHueRange(0.0, 0.67); // Blue to red
            }
        } catch (error) {
            log('Using fallback colormap:', error);
            // Fallback to default colormap
            lut.setHueRange(0.0, 0.67); // Blue to red
        }
        
	// Force the mapper to update
	mapper.setScalarRange(fieldMin, fieldMax);
	
	// Force render
	if (window.renderWindow) {
		window.renderWindow.render();
	}
}

function updateColorbar() {
	const gradient = document.getElementById('colorbar-gradient');
	
	// Always use viridis gradient
	const gradientCSS = 'linear-gradient(to right, #440154, #482777, #3f4a8a, #31678e, #26838f, #1f9d8a, #6cce5a, #b6de2b, #fee825)';
	
	if (gradient) {
		gradient.style.background = gradientCSS;
	}

	// Update labels
	document.getElementById('max-label').textContent = fieldMax.toFixed(2);
	document.getElementById('min-label').textContent = fieldMin.toFixed(2);
}

function showError(message) {
	document.getElementById('loading').style.display = 'none';
	document.getElementById('error').style.display = 'block';
	document.getElementById('error').textContent = message;
}

// Fit to view function (like mesh visualization)
function fitToView() {
	
	if (window.renderer && window.actor && window.renderWindow) {
		window.renderer.resetCamera();
		window.renderWindow.render();
	} else {
	}
}

// Change representation function (like mesh visualization)
function updateViewButtonStates() {
	const surfaceButton = document.getElementById('surfaceViewBtn');
	const volumeButton = document.getElementById('volumeViewBtn');
	
	if (surfaceButton && volumeButton) {
		// Reset both buttons to default state
		surfaceButton.style.backgroundColor = '#001100';
		surfaceButton.style.color = '#00ff00';
		surfaceButton.style.border = '1px solid #00ff00';
		volumeButton.style.backgroundColor = '#001100';
		volumeButton.style.color = '#00ff00';
		volumeButton.style.border = '1px solid #00ff00';
		
		// Highlight active button based on current view mode
		if (currentViewMode === 'surface') {
			surfaceButton.style.backgroundColor = '#003300';
			surfaceButton.style.border = '2px solid #00ff00';
		} else if (currentViewMode === 'volume') {
			volumeButton.style.backgroundColor = '#003300';
			volumeButton.style.border = '2px solid #00ff00';
		}
	}
}

function showSurfaceView() {
	currentViewMode = 'surface';
	updateViewButtonStates();
	
	// Get current representation
	const representationSelect = document.getElementById('representation-select');
	const currentRepresentation = representationSelect ? parseInt(representationSelect.value) : 2;
	
	// Check if field display is "none"
	const fieldDisplaySelect = document.getElementById('field-display-select');
	const displayType = fieldDisplaySelect ? fieldDisplaySelect.value : 'field';
	
	if (displayType === 'none') {
		// For mesh-only view, recreate mesh with surface elements
		createMeshOnly();
	} else {
		// For field visualization, recreate with surface view
		createFieldMesh('surface', currentRepresentation);
	}
	
	renderWindow.render();
}

function showVolumeView() {
	currentViewMode = 'volume';
	updateViewButtonStates();
	
	// Get current representation
	const representationSelect = document.getElementById('representation-select');
	const currentRepresentation = representationSelect ? parseInt(representationSelect.value) : 2;
	
	// Check if field display is "none"
	const fieldDisplaySelect = document.getElementById('field-display-select');
	const displayType = fieldDisplaySelect ? fieldDisplaySelect.value : 'field';
	
	if (displayType === 'none') {
		// For mesh-only view, recreate mesh with volume elements
		createMeshOnly();
	} else {
		// For field visualization, recreate with volume view
		createFieldMesh('volume', currentRepresentation);
	}
	
	renderWindow.render();
}


function changeRepresentation(value) {
	
	const repValue = parseInt(value);
	
	// Check if field display is "none"
	const fieldDisplaySelect = document.getElementById('field-display-select');
	const displayType = fieldDisplaySelect ? fieldDisplaySelect.value : 'field';
	
	if (meshDimension === 1) {
		// For 1D meshes, handle points and wireframe representations only
		if (window.actor && window.renderWindow) {
			if (repValue === 0) {
				// Points representation
				const actorProps = window.actor.getProperty();
				actorProps.setRepresentation(0); // Points
				actorProps.setPointSize(8); // Large points for visibility
				actorProps.setLineWidth(1); // Reset line width
			} else if (repValue === 1) {
				// Wireframe representation - recreate mesh with proper line connectivity
				if (displayType === 'none') {
					createMeshOnly();
				} else {
					createFieldMesh(currentViewMode, 1);
				}
			}
			
			// Force render
			window.renderWindow.render();
		}
	} else if (meshDimension === 2) {
		// For 2D meshes, handle points, wireframe, and surface representations
		if (window.actor && window.renderWindow) {
			const actorProps = window.actor.getProperty();
			
			if (repValue === 0) {
				// Points representation
				actorProps.setRepresentation(0); // Points
				actorProps.setPointSize(5);
				actorProps.setLineWidth(1);
				actorProps.setEdgeVisibility(false);
			} else if (repValue === 1) {
				// Wireframe representation - recreate mesh to preserve view mode
				if (displayType === 'none') {
					createMeshOnly();
				} else {
					createFieldMesh(currentViewMode, 1);
				}
			} else if (repValue === 2) {
				// Surface representation
				actorProps.setRepresentation(2); // Surface
				actorProps.setOpacity(0.8);
				actorProps.setPointSize(1);
				actorProps.setLineWidth(1);
				actorProps.setEdgeVisibility(true); // Show edges on surface
			}
			
			// Don't reset camera - keep current camera position
			window.renderWindow.render();
		}
	} else if (meshDimension === 3) {
		// For 3D meshes, handle points, wireframe, and surface representations
		if (window.actor && window.renderWindow) {
			const actorProps = window.actor.getProperty();
			
			if (repValue === 0) {
				// Points representation
				actorProps.setRepresentation(0); // Points
				actorProps.setPointSize(3);
			} else if (repValue === 1) {
				// Wireframe representation - recreate mesh to preserve view mode
				log('Recreating 3D mesh with wireframe representation...');
				if (displayType === 'none') {
					createMeshOnly();
				} else {
					createFieldMesh(currentViewMode, 1);
				}
			} else if (repValue === 2) {
				// Surface representation
				actorProps.setRepresentation(2); // Surface
				actorProps.setOpacity(0.8);
				actorProps.setEdgeVisibility(true);
				actorProps.setLineWidth(1);
			}
			
			// Don't reset camera - keep current camera position
			window.renderWindow.render();
		}
	}
	
	log('Representation changed to:', value);
}

// Handle window resize
window.addEventListener('resize', function() {
	if (renderWindow) {
		const openGLRenderWindow = renderWindow.getViews()[0];
		openGLRenderWindow.setSize(window.innerWidth, window.innerHeight);
		renderWindow.render();
	}
});

// Start when page loads
window.addEventListener('load', init);
</script>
</body>
</html>
