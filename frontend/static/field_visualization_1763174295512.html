<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Field Visualization - displacement</title>
<style>
body {
	margin: 0;
	padding: 0;
	background-color: #1a1a1a;
	font-family: 'Courier New', monospace;
	overflow: hidden;
}

#container {
	width: 100vw;
	height: 100vh;
	position: relative;
}

#vtk-container {
	display: block;
	width: 100%;
	height: 100%;
	background: #1a1a1a;
}

#info {
	position: absolute;
	top: 10px;
	left: 10px;
	background: rgba(0, 0, 0, 0.8);
	color: white;
	padding: 10px;
	border-radius: 5px;
	font-size: 12px;
	z-index: 100;
}

#controls {
	position: absolute;
	top: 10px;
	right: 10px;
	background: rgba(0, 0, 0, 0.9);
	color: #00ff00;
	padding: 10px;
	border-radius: 5px;
	font-size: 12px;
	z-index: 100;
	width: 200px;
}

.control-group {
	margin-bottom: 6px;
}

.control-group label {
	display: block;
	margin-bottom: 3px;
	color: #00ff00;
	font-size: 10px;
}

.control-group input, .control-group select {
	width: 100%;
	padding: 2px;
	background: #001100;
	color: #00ff00;
	border: 1px solid #00ff00;
	border-radius: 2px;
}

#time-controls .time-row {
	display: flex;
	align-items: center;
	gap: 6px;
	margin-top: 4px;
}

#time-controls .time-row:first-of-type {
	margin-top: 0;
}

#time-slider {
	flex: 1;
}

#time-display {
	min-width: 90px;
	font-weight: bold;
	font-size: 11px;
	color: #00ff00;
}

#playback-speed {
	width: auto;
}

#loop-toggle {
	margin-left: 4px;
}

.btn {
	padding: 4px 8px;
	margin: 2px;
	border: 1px solid #00ff00;
	border-radius: 2px;
	background: #001100;
	color: #00ff00;
	cursor: pointer;
	font-size: 10px;
	transition: all 0.2s ease;
}

.btn:hover {
	background: #003300;
	border: 2px solid #00ff00;
}

.btn-secondary {
	background: #001100;
	color: #00ff00;
}

.btn-primary {
	background: #003300;
	color: #00ff00;
}

#view-controls {
	display: flex;
	gap: 5px;
	width: 100%;
}

#view-controls .btn {
	flex: 1;
	width: 100%;
	padding: 4px;
	background: #001100;
	color: #00ff00;
	border: 1px solid #00ff00;
	border-radius: 2px;
	cursor: pointer;
	font-size: 10px;
	transition: all 0.2s ease;
}

#view-controls .btn:hover {
	background: #003300;
	border: 2px solid #00ff00;
}

#colorbar {
	position: absolute;
	left: 10px;
	bottom: 10px;
	width: 200px;
	height: 20px;
	background: rgba(0, 0, 0, 0.8);
	border-radius: 5px;
	z-index: 100;
}

#colorbar-gradient {
	width: 100%;
	height: 100%;
	border-radius: 5px;
}

#colorbar-labels {
	position: absolute;
	left: 0;
	bottom: 25px;
	width: 200px;
	height: 20px;
	display: flex;
	flex-direction: row;
	justify-content: space-between;
	align-items: center;
	color: white;
	font-size: 10px;
}

#loading {
	position: absolute;
	top: 50%;
	left: 50%;
	transform: translate(-50%, -50%);
	color: white;
	font-size: 18px;
	z-index: 200;
}

#error {
	position: absolute;
	top: 50%;
	left: 50%;
	transform: translate(-50%, -50%);
	color: #ff4444;
	font-size: 16px;
	text-align: center;
	z-index: 200;
}
</style>
</head>
<body>
<div id="container">
<div id="loading">Loading field visualization...</div>
<div id="error" style="display: none;"></div>
<div id="info">
<div><strong>Field: displacement</strong></div>
<div>Units: m</div>
<div>Min: <span id="field-min">-</span></div>
<div>Max: <span id="field-max">-</span></div>
<div>Mean: <span id="field-mean">-</span></div>
</div>
<div id="controls">
<div class="control-group">
<label>Field Display:</label>
<select id="field-display-select" onchange="changeFieldDisplay(this.value)">
<option value="none">None (Mesh Only)</option>
<option value="field" selected>displacement Field</option>
</select>
</div>
<div class="control-group">
<label>Representation:</label>
<select id="representation-select" onchange="changeRepresentation(this.value);">
<option value="0">Points</option>
<option value="1">Wireframe</option>
<option value="2" id="surface-option">Surface</option>
</select>
</div>
<div class="control-group" id="view-controls" style="display: none;">
<button id="surfaceViewBtn" onclick="showSurfaceView()" class="btn btn-secondary">Surface View</button>
<button id="volumeViewBtn" onclick="showVolumeView()" class="btn btn-secondary">Volume View</button>
</div>
<div class="control-group">
    <button id="fit-view" class="btn btn-secondary" style="width: 100%;" onclick="fitToView();">Fit to View</button>
</div>
<div class="control-group" id="time-controls" style="display: none;">
<label>Time Controls:</label>
<div class="time-row">
	<button id="play-pause-btn" class="btn btn-secondary" onclick="togglePlayback()">Play</button>
	<button id="step-backward-btn" class="btn btn-secondary" onclick="stepBackward()">Prev</button>
	<button id="step-forward-btn" class="btn btn-secondary" onclick="stepForward()">Next</button>
</div>
<div class="time-row">
	<input type="range" id="time-slider" min="0" max="0" value="0" step="1" onchange="onTimeSliderChange(this.value)" />
</div>
<div class="time-row">
	<span id="time-display">t = 0.000</span>
	<select id="playback-speed" onchange="updatePlaybackSpeed(this.value)">
		<option value="0.25">0.25x</option>
		<option value="0.5">0.5x</option>
		<option value="1" selected>1x</option>
		<option value="2">2x</option>
		<option value="4">4x</option>
	</select>
	<label style="display: flex; align-items: center; gap: 4px; font-size: 10px;">
		<input type="checkbox" id="loop-toggle" onchange="toggleLoop(this.checked)" />
		Loop
	</label>
</div>
<div class="time-row">
	<button id="steady-state-btn" class="btn btn-primary" style="width: 100%;" onclick="showSteadyState()">Show Steady-State</button>
</div>
</div>
</div>
<div id="colorbar" style="display: none;">
<div id="colorbar-gradient"></div>
<div id="colorbar-labels">
<span id="max-label">Max</span>
<span id="min-label">Min</span>
</div>
</div>
<div id="vtk-container"></div>
</div>

<script src="/static/js/vtk.js" onerror="console.error('Failed to load VTK.js script');"></script>
<script>
// Lightweight logging (disabled by default for clean console)
const DEBUG = false;
const log = (...args) => { if (DEBUG) console.log(...args); };
// Data
const meshData = {"vertices": [[0.006017861799469352, 7.380013554348411e-06, 0.1557119175143147], [-0.006769136646694584, 0.0003483060860297592, 0.055711896802894116], [0.006027989961098472, 0.10003267491181343, 0.15602755556358727], [-0.006759034310914802, 0.10032300771658556, 0.05602755762845314], [1.9999103364475652, -0.0010450949076524316, 0.09038741527807775], [1.9992000824707306, -0.0008973247294514959, -0.009612584722215056], [1.9999904850796841, 0.09895490509282774, 0.09053518545575641], [1.9992802311028197, 0.09910267527035864, -0.009464814544190119], [-0.0003756392637984755, 0.00017784904634042824, 0.10569078130826655], [0.0060276964392710995, 0.050020026906466224, 0.1558712622340227], [-0.000365518633452782, 0.10017784073947067, 0.10600642683664985], [-0.006768869533480952, 0.05033566008325137, 0.05587126806539469], [1.9995552094592228, -0.0009712098184638194, 0.04038741527787232], [1.9999504107637143, 0.04895490509261351, 0.0904613003668187], [1.9996353580912463, 0.09902879018158414, 0.040535185455723106], [1.9992401567867508, 0.04910267527045926, -0.009538699633213722], [0.19384226954327113, 0.0004057074829836231, 0.030730304823877747], [0.3956437823093533, 0.00047764422796761776, 0.010577586056236533], [0.5985425628183223, 0.00047264556717653783, 1.3092864661961613e-05], [0.7992021316875627, 6.247636245506991e-05, -0.0010837158399747684], [0.9992000657310813, -9.572105168972605e-05, -0.002510040347276786], [1.1992000821687472, -0.00025612843859149385, -0.003930554035449733], [1.3992000824135087, -0.0004164326697680006, -0.005351060923407494], [1.5992000824623744, -0.0005767301956460414, -0.006771568812005246], [1.799200082470646, -0.0007370274647643628, -0.008192076768605887], [0.09341411226068633, 0.00037022921261198474, 0.042906981681000364], [0.29462388617446267, 0.00044040110663959905, 0.019755098272164758], [0.4970008641045017, 0.00048314395875874325, 0.003829317747918662], [0.6991507730010651, 0.00017176810510634625, -0.00047707524973801747], [0.8991998079185494, -1.672840275005146e-05, -0.001798344891017853], [1.0992000691772534, -0.0001759988876340911, -0.003220279232650345], [1.299200081767737, -0.00033628465018372653, -0.00464080579868411], [1.4992000824356222, -0.0004965816099510777, -0.0060613147477720924], [1.6992000824687288, -0.000656878834680183, -0.00748182278896022], [1.8992000824706814, -0.0008171760975119301, -0.008902330745096672], [0.20540634735997396, -9.043557918176843e-05, 0.13073059911249016], [0.4036051956143755, -0.00019905642688324693, 0.11058652046244233], [0.6006077365119163, -0.00019428519797221226, 0.10016046894999674], [0.7999251533807774, -0.00010474678245977779, 0.09891781755416905], [0.9999105378191174, -0.0002443258022093778, 0.09749038693408404], [1.199910342410697, -0.0004039421721221527, 0.09606947101670259], [1.399910336716133, -0.0005642047037621822, 0.09464894032725774], [1.599910336478699, -0.0007245004428934542, 0.09322843124091688], [1.7999103364481865, -0.0008847976459505381, 0.09180792323394638], [0.10583460739847254, -3.476763632904127e-05, 0.1429069867708862], [0.30462499896393375, -0.0001453472371311947, 0.11975528453979298], [0.5022278732968152, -0.00025324965504669114, 0.10380663732642942], [0.6999443351077387, -2.5880915313771333e-05, 0.0995411631973678], [0.8999128598659075, -0.00016426311438040488, 0.09820013275703969], [1.0999103938903876, -0.0003237556660071875, 0.09677970760943891], [1.2999103396252647, -0.0004840548167321869, 0.09535919385628056], [1.4999103365911568, -0.0006443517759161448, 0.09393868522414678], [1.6999103364567214, -0.0008046490120912739, 0.09251817721062587], [1.8999103364479308, -0.0009649462752891061, 0.09109766925482701], [0.19385235529814424, 0.10022500413501785, 0.031046131223736364], [0.3956535594789043, 0.10010964790275749, 0.010897598123071606], [0.5985716556548318, 0.09998690066741223, 0.00040046822089226527], [0.7992781472213623, 0.1000600665956684, -0.0009211671188836835], [0.9992801518757184, 0.09990387152488694, -0.0023617221997840093], [1.1992802278388637, 0.09974384383165157, -0.0037827609839129746], [1.3992802309084291, 0.09958356618387278, -0.005203289783365058], [1.5992802310755914, 0.09942326976303589, -0.006623798598368955], [1.7992802311024214, 0.09926297253301165, -0.008044306589058891], [0.09342424259521566, 0.1002808647288361, 0.043222622056161286], [0.29463432485255325, 0.10017015535728539, 0.02007072938430884], [0.49702079842464203, 0.1000812810062678, 0.0041399200740316715], [0.6992327492539976, 0.10011626077049064, -0.00031837055191365427], [0.8992783373517277, 0.09998452192247878, -0.001650489728102695], [1.0992801820915532, 0.09982401117626236, -0.0030725119902278624], [1.2992802283205578, 0.09966371508636077, -0.0044930355761435455], [1.4992802309764215, 0.09950341839448466, -0.0059135445765792615], [1.69928023109509, 0.09934312116572139, -0.007334052611232477], [1.8992802311026065, 0.09918282390251189, -0.008754560567283628], [0.20541653470981866, 0.10009002828909677, 0.13104621245801962], [0.4036167348644902, 0.10015827847900911, 0.11090201254202361], [0.6006308648707003, 0.10022119996067674, 0.1003741475433367], [0.8000008215493801, 0.09993420924788658, 0.09905069990377856], [0.9999905473214558, 0.0997569753827312, 0.09763765174414038], [1.1999904863622584, 0.09959611852817497, 0.09621721972147596], [1.3999904851667808, 0.09943579791173354, 0.0947967095920263], [1.599990485090552, 0.09927549965590186, 0.09337620138427262], [1.7999904850799284, 0.09911520235854558, 0.09195569341010329], [0.10584473131839026, 0.10005457453828634, 0.1432226295487618], [0.30463524368101375, 0.10012451111052234, 0.12007097517481827], [0.5022382553417634, 0.10020263992494007, 0.10410937180381256], [0.700035426655529, 0.1000387092812943, 0.09969426302857257], [0.8999914942906788, 0.0998367437926179, 0.09834765992918162], [1.0999905064157927, 0.09967622974485853, 0.09692748034076316], [1.2999904861775982, 0.09951594490347195, 0.09550696400923271], [1.4999904851331214, 0.09935564820495932, 0.09408645540865147], [1.6999904850832546, 0.09919535098756524, 0.09266594738873042], [1.8999904850798381, 0.09903505372463497, 0.09124543943268341], [-0.00037057623053698697, 0.05017784481631361, 0.10584107770352041], [0.002808397669345718, 0.02509467849451864, 0.13077334167105542], [-0.0035546073336417483, 0.025261011917059806, 0.08077333590010542], [0.0028134608175576377, 0.0751031947628526, 0.13093116274175648], [-0.003549550807491005, 0.07525249142850467, 0.0809311643851131], [1.9995952837752644, 0.04902879018155648, 0.04046130036678053], [1.9993976831229927, 0.024065732726039676, 0.015424357822289738], [1.9997528101114865, 0.023991847637001896, 0.065424357822393], [1.9997928844275101, 0.07399184763716302, 0.06549824291125936], [1.9994377574390096, 0.07406573272598574, 0.015498242911267692], [1.8995552094592356, -0.0008910611864336532, 0.04109766925490488], [0.6995414635570381, 9.782405023041888e-05, 0.0495024712296993], [1.2995552097195613, -0.0004101701605458327, 0.04535919478361059], [1.6995552094600779, -0.0007307639234460765, 0.04251817720928378], [0.0996243668087649, 0.00016771846150102467, 0.09288472971571024], [0.4996342663598427, 0.00012941820818878448, 0.05368905802031889], [0.2996242715282628, 0.00014714898903455393, 0.06968782533072101], [0.899555008329808, -8.923771024083492e-05, 0.04820123758653687], [1.499555209468235, -0.0005704667039942887, 0.04393868526781897], [1.0995552139017413, -0.0002498829222907883, 0.04677972907496136], [0.04647161727556375, 0.00026355679369361996, 0.07423672008524648], [0.0527771004615507, 8.200623882320203e-05, 0.12423671161904776], [0.15262738197820783, 4.88100517930795e-05, 0.1116997650806705], [0.14662136924552324, 0.0002765253680167251, 0.061699713988322524], [1.9497327729534932, -0.0009680780469053341, 0.06574254226631321], [1.9493776459650116, -0.0008941929579401682, 0.015742542266355623], [1.8497327729536144, -0.0008879294152681243, 0.0664527962438037], [1.8493776459648976, -0.0008140443259502551, 0.016452796243368588], [0.3473741849327316, 0.0002999041713264845, 0.039866991580951035], [0.24692378780058705, 0.0002880948849743662, 0.04999174915178356], [0.1996242542172485, 0.00015768234370292625, 0.0806830785552298], [0.2523246063688396, 1.673135729071333e-05, 0.0999914580499959], [0.5487233400346208, 0.0003256001074006057, 0.02644193258478418], [0.4479733121516162, 0.00031322950912995997, 0.03176497719387725], [0.39962363531499573, 0.00013845021067442848, 0.06049214669633754], [0.4512721890925713, -5.143458326526582e-05, 0.0817531718862046], [0.35187529354094166, -1.467247799455146e-05, 0.08986901008079315], [0.7493854043729794, 6.32072561849508e-05, 0.02424346177006147], [0.6491960619825591, 0.00023295054215943315, 0.024728670687840647], [0.5996023406167441, 0.00014016583756805857, 0.05016046894999674], [0.6498933686201329, 7.116214403356773e-05, 0.074766272829059], [0.5505337569987742, -5.163764625524084e-05, 0.07646374952320589], [0.9493777050285572, -9.278688298008818e-05, 0.022845263890064887], [0.8493776788704434, -1.344266379590331e-05, 0.023558527472720744], [0.7995556424361355, -1.0039033311592652e-05, 0.048912075525914256], [0.749725332973798, -1.3629524107795703e-05, 0.0742470483293959], [0.8497357274036829, -8.991163507427694e-05, 0.07355634905806668], [1.1493776517503367, -0.0002530087863421294, 0.021424585096461463], [1.0493776295768942, -0.00017286619862249959, 0.022134862321475726], [0.9995552288768046, -0.000169846831520761, 0.047490055282467566], [0.9497329448101324, -0.00016646275634560708, 0.07284550878632286], [1.0497328385364924, -0.00024685510475980536, 0.0721349091087514], [1.3493776462909783, -0.00041330141665222415, 0.020004066916108027], [1.2493776451849845, -0.00033315319128168113, 0.02071432165407925], [1.199555211876944, -0.0003300285708348512, 0.04606945329684692], [1.2497327752756078, -0.0004070439520692144, 0.07071432562250794], [1.1497327840305631, -0.00032688756497512467, 0.07142457954919282], [1.5493776459822044, -0.0005735984537373248, 0.018583558236950265], [1.4493776459111412, -0.0004934498428645226, 0.01929381225222037], [1.399555209566815, -0.0004903182627956048, 0.04464893943146693], [1.3497327736357903, -0.0004871862895405497, 0.0700040662613268], [1.4497327730398506, -0.000567335173585413, 0.06929381244427399], [1.749377645965472, -0.0007338956935590023, 0.01716305022045033], [1.6493776459621865, -0.000653747061824428, 0.017873304199188082], [1.5995552094715324, -0.000650615296403569, 0.043228431203769874], [1.64973277296249, -0.0007276321656642102, 0.06787330420842073], [1.54973277299322, -0.0006474835363605905, 0.06858355820048634], [1.7995552094593457, -0.0008109125548580736, 0.041807923232160434], [1.7497327729554353, -0.0008077807829359659, 0.06716305021993481], [0.6996235979261167, 0.10003204045512931, 0.04963979058168813], [1.299635357612504, 0.09958982934140925, 0.04550696497298685], [0.09963449081859002, 0.10016772588914223, 0.09320036785744817], [0.29963446337002464, 0.10014763899125607, 0.07000345993486756], [0.49964419016699996, 0.10011911919523926, 0.05399970239237868], [0.899635193525421, 0.0999092001298515, 0.04834904275673949], [1.4996353580682178, 0.09942953327934174, 0.04408645544564023], [1.8996353580912229, 0.09910893881352678, 0.04124543943275118], [1.0996353511597659, 0.09975010031454187, 0.04692749938672339], [1.6996353580905803, 0.09926923607619081, 0.0426659473871968], [0.05278722554071691, 0.10010574471641157, 0.1245523506288424], [0.04648173931369789, 0.10023983142526996, 0.07455235527578451], [0.15263750955358357, 0.100118693480681, 0.11201540742577844], [0.14663148199183879, 0.1002065929713946, 0.062015396386057464], [1.9494577945969844, 0.09910580704201048, 0.015890312444183242], [1.949812921585477, 0.099031921953121, 0.06589031244420508], [1.849812921585616, 0.09911207058528716, 0.06660056642131537], [1.8494577945969173, 0.09918595567383007, 0.016600566421496304], [0.24693405820774972, 0.10017477276326939, 0.05030723659778839], [0.34738419899920897, 0.1001420206676677, 0.04018353113450376], [0.19963439318370368, 0.10015751839923183, 0.08099877257428847], [0.252334818269704, 0.10013051983950617, 0.10030710111675639], [0.4479860915438387, 0.10010832589673169, 0.03207635704847035], [0.5487423538054241, 0.1000546151127203, 0.026765451535836947], [0.35188562214105, 0.10014141872609846, 0.09018479738634795], [0.399634143788079, 0.10013600442715151, 0.06080898965816238], [0.45128425002257516, 0.10015667756330583, 0.08207068621976321], [0.6492748050763127, 0.10000374606483323, 0.024914614538669118], [0.7494272411879999, 0.10004840767607368, 0.02438377431364845], [0.6499600350875385, 0.10006420677429263, 0.07490288871692953], [0.5996364441759607, 0.10007186504219338, 0.05031731835824438], [0.5505355200762293, 0.10015382517417051, 0.0767448909931004], [0.8494575424951778, 0.09998586541613114, 0.02370944329793764], [0.9494572833845933, 0.09990712608470101, 0.022992658211201195], [0.7498111878706144, 0.09998960227894292, 0.07438671504026353], [0.7996311042601277, 0.09998828497111399, 0.04905888940445433], [0.8498152329698813, 0.09991507072700598, 0.07370080496955089], [1.0494577873576403, 0.09982708055323018, 0.022282732524764648], [1.1494577770203505, 0.09974699296894461, 0.021572337671896605], [0.9498124752307202, 0.09983303067374477, 0.07299366700759465], [0.9996352951023262, 0.09983039431813275, 0.04763784479930737], [1.0498129836786192, 0.09975330659536753, 0.07228259234961047], [1.249457793482408, 0.09966684323327246, 0.020862096201224128], [1.3494577937677177, 0.09958669864554996, 0.020151836305831727], [1.2498129232497968, 0.0995929640373673, 0.07086209184145789], [1.1996353555272223, 0.09966998198881151, 0.046217223947610096], [1.1498129105430255, 0.09967310236022467, 0.07157236476571599], [1.4494577945347302, 0.09950655000904716, 0.019441582603732396], [1.5494577945566828, 0.09942640155017207, 0.01873132837959683], [1.3498129211461327, 0.09951281336236119, 0.07015183716967462], [1.3996353579976444, 0.09950968205690486, 0.0447967096276122], [1.449812921656096, 0.09943266517005825, 0.06944158246130175], [1.649457794589588, 0.09934625292943584, 0.018021074383950675], [1.7494577945954821, 0.09926610430560848, 0.017310820397800394], [1.5498129215687102, 0.09935251645563438, 0.06873132841141862], [1.5996353580816711, 0.09934938470846551, 0.043376201382030764], [1.6498129215895965, 0.0992723678559027, 0.06802107437988227], [1.7996353580911615, 0.09918908744572004, 0.041955693410024204], [1.7498129215854905, 0.09919221921715812, 0.0673108203982557], [1.8992401567866755, 0.04918282390248107, -0.008828445656165326], [1.0992401344859641, 0.04982399923341379, -0.0031463876942065426], [0.6992444184002997, 0.0501273461498716, -0.0003856232923534765], [1.2992401557661495, 0.049663714828417055, -0.004566920046889352], [0.0934064329926075, 0.05032554377998486, 0.043088173945816974], [0.29460879824950437, 0.050305245238603545, 0.01998076710833595], [0.49700431875502193, 0.050282960400455844, 0.004071122160994037], [0.8992395636214612, 0.049983985542202146, -0.0017254340865213765], [1.499240156742272, 0.049503418377807355, -0.005987429647658252], [1.6992401567851017, 0.049343121166308214, -0.007407937699793645], [0.043290259937076976, 0.07531650961699124, 0.04949380893092967], [0.04328520162667016, 0.025344704121376304, 0.04933598755967536], [0.14358938084309988, 0.025352910196160972, 0.036824451645652935], [0.14359444160644516, 0.07528802911369556, 0.03698229586060889], [1.949220119628686, 0.024142749586484828, -0.009220515189215555], [1.9492601939447076, 0.07414274958652987, -0.009146630100277718], [1.8492201196287603, 0.024222898218608357, -0.008510261212055963], [1.849260193944662, 0.07422289821822324, -0.008436376122944749], [0.24419204348222845, 0.025366679980054332, 0.025158772901986492], [0.34509178679858327, 0.025379459252839628, 0.01506068391975907], [0.19383976337786857, 0.050315384073871205, 0.030932978095403307], [0.24419714740207496, 0.07525409394333356, 0.025316590913375688], [0.44629719693776254, 0.025392161052915054, 0.007001197866250996], [0.5477484834479522, 0.02536099276612887, 0.0016609257586159122], [0.3956432392555767, 0.050294251798446904, 0.01082832473456709], [0.34509694698387366, 0.07522026008283955, 0.015219143703405505], [0.4463028088785246, 0.07518842581114821, 0.007158150536081398], [0.6490675934462075, 0.025236551301504307, -0.00018775250030578423], [0.7492488327952769, 0.02509985006234993, -0.000722234829130905], [0.5985373905236829, 0.05023661127569085, -0.00017947900900895094], [0.6490914542717364, 0.07511342172068158, -8.624503387793321e-05], [0.5477617870222061, 0.07517367330407881, 0.0018282727631073466], [0.8492203054355882, 0.02502304171948628, -0.0014056341163654023], [0.9492196959442357, 0.024943981596110096, -0.0021178488259445422], [0.799241183589431, 0.05006289331665239, -0.0010113118279281893], [0.7492700348572077, 0.07507968432788592, -0.0006456925165836534], [0.8492589337225781, 0.07502413143076138, -0.0013283330322406558], [1.0492201192191346, 0.02486409395780998, -0.002828170844560241], [1.1492201054614979, 0.024783928780089323, -0.0035384790612987735], [0.9992401056976349, 0.04990411635106521, -0.0024361104150771528], [1.0492601615331945, 0.07486402558475595, -0.002754216446652899], [0.9492596487687817, 0.07494410546840925, -0.0020440471331310234], [1.249220119638273, 0.024703790656278563, -0.004248734342080222], [1.3492201187870636, 0.024623640702652362, -0.004958990930808158], [1.1992401528562486, 0.049743861557799966, -0.003856663203611821], [1.1492601763260024, 0.0747839383429291, -0.003464593126544765], [1.249260192563479, 0.0747037853414451, -0.004174846347916457], [1.4492201196348378, 0.024543492742537847, -0.005669245153678549], [1.5492201195837747, 0.02446334407048477, -0.0063794992398024655], [1.3992401566399117, 0.049583566899709795, -0.00527717564699535], [1.3492601928544967, 0.07462364164851754, -0.0048851059076990555], [1.449260193884956, 0.07454349254008978, -0.005595359938622244], [1.6492201196269043, 0.024383195483033845, -0.007089753256014576], [1.7492201196274886, 0.024303046850443783, -0.00780000723509221], [1.5992401567676677, 0.04942326978925399, -0.006697683717394623], [1.5492601938875892, 0.07446334411597105, -0.006305614153443499], [1.649260193937196, 0.07438319547523174, -0.007015868159241273], [1.7992401567865963, 0.049262972534381264, -0.00811819167906816], [1.7492601939427257, 0.07430304685085257, -0.007726122145923418], [1.0999504188981915, 0.04967622931883215, 0.09685362513240396], [1.2999504111663618, 0.04951594466043684, 0.09543308033157936], [1.6999504107651189, 0.049195350988517905, 0.09259206230040304], [0.30464977766742424, 0.04998955463373091, 0.11998040776449807], [0.5022427492357151, 0.04996907164062754, 0.10407927402588193], [0.8999501958984595, 0.04983631841256641, 0.09827533627548293], [0.10585240888340262, 0.05000990152845171, 0.1430881555961781], [1.4999504107825397, 0.04935564820001106, 0.09401257036640094], [0.7000543490860617, 0.0500066298540131, 0.09980663422433046], [1.8999504107637593, 0.049035053724631635, 0.09117155434386243], [0.05596859959308517, 0.025000854625636216, 0.14933598582864363], [0.055973660296298536, 0.07502907236736, 0.14949380690990705], [0.15566435193265582, 0.02497244241889343, 0.1368244938871915], [0.15566942643248788, 0.07503725079667994, 0.13698231440630265], [1.9499704479218158, 0.073994979408597, 0.09085336989974216], [1.9499303736057885, 0.023994979408699317, 0.09077948481081287], [1.8499303736058088, 0.024075128040218417, 0.0914897387882202], [1.849970447921695, 0.07407512804097485, 0.0915636238769337], [0.35416108062101775, 0.024906421181884547, 0.1150617635582877], [0.25506178757208187, 0.024938061979176217, 0.1251587886474266], [0.25506684353948117, 0.07505127794883946, 0.12531662869714796], [0.20541907961559194, 0.049999798233203996, 0.13093299025553104], [0.5514402242045209, 0.02487492580880355, 0.10171200837723143], [0.4529628561999311, 0.024866281941744728, 0.10699523545196703], [0.35416642713958957, 0.07506267070472779, 0.11521965029914753], [0.40361768425182354, 0.04997975367654274, 0.11083314733664926], [0.4529668344124537, 0.07507818695248741, 0.10715399611548654], [0.7499626741673042, 0.024934894073109077, 0.09931209401838621], [0.6499620364849287, 0.025043805781945653, 0.09986919007205206], [0.5514539952252561, 0.07508993517005755, 0.1018537785959236], [0.600659426900928, 0.050037309207050615, 0.10040789598730103], [0.6499600350875385, 0.07509180852505476, 0.09998053480910339], [0.9499310002461797, 0.024796923876385976, 0.09788216960536547], [0.8499325011466115, 0.024872290847933347, 0.0985958431445334], [0.8499706068549907, 0.07488016352797609, 0.09866635000706236], [0.7999559991032664, 0.0499152366034263, 0.09898594503730562], [0.7499880103082776, 0.07497234518772529, 0.09941784253364783], [1.149930400261289, 0.024636182585278565, 0.09646152413794223], [1.0499303881673452, 0.024716171461303785, 0.09717188426656793], [1.0499704178694413, 0.07471642231107484, 0.09724570743167847], [0.9999504981186449, 0.04975637018503483, 0.097563812751995], [0.9499709101046119, 0.07479560393329984, 0.09795614123600623], [1.3499303749675349, 0.0244758720551532, 0.09504100912524442], [1.2499303741151373, 0.02455601220844905, 0.09575126853734274], [1.1499704719116746, 0.0746361424906647, 0.09653540891686654], [1.1999504189406907, 0.049596091797404, 0.09614333445964118], [1.2499704467183383, 0.07455602381143932, 0.09582515095334904], [1.5499303736735022, 0.024315573960240727, 0.0936205007637362], [1.4499303736357725, 0.02439572223236221, 0.09433075500382877], [1.3499704490691937, 0.07447586988378906, 0.09511489430227228], [1.3999504110342302, 0.049435796740158064, 0.09472282440160172], [1.4499704478785302, 0.07439572270770838, 0.0944046399746618], [1.74993037360842, 0.024155276673562962, 0.09219999276497043], [1.6499303736134916, 0.024235425292177145, 0.09291024675607105], [1.6499704479234862, 0.07423542531091443, 0.09298413183762586], [1.5999504107882032, 0.04927549961183178, 0.09330231628132254], [1.5499704479783096, 0.07431557386849495, 0.09369438585587778], [1.7499704479237104, 0.07415527667201212, 0.09227387785366538], [1.7999504107640145, 0.049115202356536034, 0.09188180832137775], [0.40012940393531243, 0.05035851062700338, 0.0601932046534779], [1.5016822428265924, 0.04941805014470939, 0.0439982844676558], [0.6668345702867233, 0.05742698903425627, 0.05033246349475687], [0.09915849160332267, 0.05021033242874249, 0.07960503144554755], [0.30039038597072604, 0.05015058201868335, 0.07043009423416687], [1.6970889691489455, 0.049286517700863355, 0.0425810043827342], [1.9041814253944485, 0.049085078379201987, 0.0551427460729259], [1.0985640777393417, 0.06305444281419399, 0.046880421883765844], [0.5010203163286551, 0.05006780602084419, 0.05387863405083412], [0.899059669645826, 0.04993759526458166, 0.048310361445538005], [1.300274944292917, 0.04958915376352476, 0.04542826068950018], [0.747596993379168, 0.04442598145065985, 0.04280160565500518], [0.10236176262754144, 0.050123079602181035, 0.10626224476068336], [1.0985392387858843, 0.03644636903757072, 0.04684256372962613], [1.8742713706848166, 0.049149846378393196, 0.03021434033304444], [0.7022841413241445, 0.03191482123057521, 0.06720746621266538], [0.04042521082547704, 0.05017358957148413, 0.10058201267153002], [1.9570563987942324, 0.049067351188157804, 0.038208400228166135], [1.399836020785331, 0.04951062504297572, 0.04472137169496443], [0.16538869663400185, 0.050163694195171936, 0.08512137299860276], [1.7957814139037658, 0.04919719129717358, 0.040764266362556284], [1.1644164724818522, 0.049697820771176064, 0.046393687144663596], [0.2149708218635297, 0.050157045413861866, 0.07926319343878431], [1.0277082610285948, 0.04980792150753741, 0.04736479042572137], [1.2145215534534923, 0.04965795275987029, 0.04603735352288974], [1.4508363639235275, 0.07442692357229803, 0.06939749711406724], [1.5508363639758442, 0.07434677488578709, 0.06868724290961878], [1.5006588004428683, 0.07442379170496231, 0.044042369975500574], [1.4504411626405096, 0.02450080854858136, 0.019323611953257977], [1.5504411626410624, 0.024420659973659952, 0.018613357824412723], [1.500461199785205, 0.04946073425185026, 0.019005427413749224], [0.6328143285878889, 0.07869938046744185, 0.02511766528288931], [0.7330057134003478, 0.0787556653846917, 0.024662820367372062], [0.6832197742152185, 0.07872837571893414, 0.04995487807142709], [0.046219601417449595, 0.07526533972151749, 0.0677550515650201], [0.1464104996654033, 0.07524032431512613, 0.055232242235559746], [0.09939562203639471, 0.07518595716858617, 0.08640740831935201], [1.4507962895927842, 0.024426923212154873, 0.06932361214534576], [1.5507962896904395, 0.024346774883245638, 0.0686133578216296], [1.5006187261426522, 0.024423791724410383, 0.0439684848863748], [1.0489221654462795, 0.08147922528658866, 0.022259204652870707], [1.0989021073999106, 0.05643922139191239, 0.021867015351739554], [1.063136158076255, 0.05643118890308388, 0.047122608490941735], [1.0634742025940265, 0.0498159780016832, 0.022109181290330508], [1.0134942004579173, 0.0748559374760394, 0.022501410986890378], [0.7733994918269267, 0.02224430771932531, 0.020859161339846548], [0.7235841236128072, 0.022254144480143047, 0.0461648893925452], [0.6733373884640593, 0.02235068065228133, 0.021408482589652472], [1.0985516562746194, 0.049750405989338053, 0.04686149709808911], [1.0988896880450572, 0.04313518165954486, 0.02184809110935337], [1.0631237312959454, 0.04312715008829291, 0.04710367791416725], [1.1314778566255563, 0.04307209805021858, 0.04661812117656524], [1.1314902765011412, 0.05637613714583544, 0.04663705028695064], [1.0992572484197158, 0.05636532957270117, 0.07186702628373866], [1.1321834508539983, 0.0496870281491431, 0.07162363903760693], [1.0992448289492125, 0.043061305190347614, 0.0718480921242889], [0.751075186476206, 0.015898749245632077, 0.08304073909320012], [0.7009095549396199, 0.016009850424115457, 0.058332183677324796], [0.6512325125240573, 0.01596928532197404, 0.0836463011648495], [0.7333823443718291, 0.07868871100191763, 0.07470124708066143], [0.6335381387412797, 0.07877066311638589, 0.0752107482338227], [0.35226388016003124, 0.07510711002759198, 0.09042127191420554], [0.300012317759723, 0.07514958041944839, 0.0702336382911446], [0.2527191789111713, 0.07510163610598426, 0.1005317882633256], [0.054175048128839456, 0.07507921225724423, 0.13108379124121908], [0.1539841632160917, 0.07508394714107859, 0.11856069724180782], [0.1009989716209963, 0.07514847476322768, 0.09973601795447415], [0.34775058570217304, 0.025264071461614374, 0.040261351534708306], [0.24730561692945616, 0.025258894054112416, 0.050373284506660426], [0.3000072290172233, 0.02514839352999327, 0.07007582462767024], [1.1489221409793238, 0.08139916545548675, 0.021548808814286845], [0.34775541361187434, 0.07518069861987207, 0.040419956126977366], [0.24731076638960814, 0.07520721382769215, 0.05053104399588415], [0.2975103331486803, 0.050227883352825756, 0.045188214947874575], [1.6481445258099043, 0.02435489375082485, 0.01790471778370081], [1.6983220893044213, 0.024277876889388723, 0.04254959079579285], [1.748144525809826, 0.024274745119181654, 0.017194463804969414], [1.8520458809210079, 0.024100140367487564, 0.07347533465286175], [1.9018683174268374, 0.02409700859641947, 0.048120207663898865], [1.9520458809211567, 0.024019991735941427, 0.07276508067535588], [1.25009263922047, 0.024592617281564894, 0.07074886074805584], [1.2501327138082485, 0.0745926254390575, 0.07082274305057185], [1.2573982478789518, 0.04962355291464188, 0.045732807691338515], [1.2072560207489436, 0.07462703114128082, 0.07112728640851808], [1.2072159503411177, 0.024627011894098987, 0.07105340768397249], [1.1492772910950395, 0.08132527041831257, 0.07154880958251655], [1.0492772954633922, 0.08140546562067634, 0.07225912320273999], [1.0990997146203485, 0.0814022683987717, 0.0469039617904816], [1.1822034822520318, 0.07464696487886542, 0.07130545179545968], [1.182163417182337, 0.024646946198327302, 0.07123157258437897], [1.189469013194401, 0.04967788593565706, 0.04621552159051038], [0.44866625165504626, 0.025230625451343025, 0.031871349454575815], [0.5494396181260589, 0.025237868122033096, 0.026536700665091346], [0.5003265423016858, 0.025100289068412125, 0.05380738503314018], [0.4486739055211734, 0.07513401678030797, 0.03202746101549697], [0.45057666086969034, 0.050214041513136035, 0.056680181936767306], [0.3979022905735354, 0.02537279480900621, 0.03538702254154065], [0.3979076919510252, 0.07527937768243025, 0.03554584930601911], [1.1492248084986476, 0.018021240861800503, 0.07145599055593511], [1.0492248004718063, 0.01810125488417239, 0.07216637992138218], [1.0990472247419094, 0.01809824558592597, 0.04681114712423788], [0.9494855851296289, 0.024847263685642718, 0.07289974838393597], [0.8494853720571465, 0.024923804016413316, 0.07361466099217402], [0.8993070970793698, 0.02492456032695397, 0.04825604049044842], [1.1488696586288611, 0.01809511680627384, 0.021456001081263627], [1.1818082760238113, 0.024720843785749638, 0.021231567234815066], [1.9367357265777703, 0.024126260824471113, 0.010300877805384932], [1.8869132900719834, 0.024129392595965173, 0.03565600479397474], [1.8367357265777668, 0.024206409456500634, 0.011011131782540646], [0.8491299983769236, 0.02500041300377286, 0.023612309274325765], [0.949129754921842, 0.024920988521526348, 0.022900078979259678], [1.7485397271159537, 0.07420086002964615, 0.06726834889320273], [1.6485397271154443, 0.07428100867031938, 0.06797860287956897], [1.698362163619802, 0.07427787688872613, 0.04262347588481075], [1.3497775868954762, 0.07458636075038548, 0.02011248456261602], [1.2497775882208046, 0.07466650437124672, 0.02082274532729478], [1.2999551508382798, 0.0745894913881619, 0.0454676132021718], [1.249737513337807, 0.02466650814928356, 0.020748857065033748], [1.3497375132370553, 0.024586360604903868, 0.020038599561646848], [1.2997575500896463, 0.04962643412495436, 0.02043067039565778], [0.5512129405703575, 0.07506535145018271, 0.0767256120322434], [0.5003318237234724, 0.0750907707796928, 0.05396399050887941], [0.45197770322967645, 0.07507325676149873, 0.0820251922702017], [1.1818483414794445, 0.07472083719903871, 0.021305458034398837], [1.1318283031713157, 0.049760913161396754, 0.021623641408397388], [1.2069008882663523, 0.07470090290310735, 0.02112729254228571], [1.3501327151754259, 0.07451247552199367, 0.07011248451053323], [0.8491706939161352, 0.07499869619462567, 0.023690189931737375], [0.8233345196198649, 0.04718020787980069, 0.04556041489857012], [0.7734352905363772, 0.07224027016193171, 0.020929300105515285], [1.9156638847395195, 0.049108598783301004, 0.034211370280552836], [1.9306189120943424, 0.04907621478368352, 0.04667557315051955], [1.8892263980396138, 0.0491174623787966, 0.04267854320298296], [1.9283058041267387, 0.024088145000891247, 0.03965303474150547], [1.3500926415184098, 0.024512475620871648, 0.07003859936664952], [1.2999150768467644, 0.02458949189315344, 0.045393728099463335], [0.45197183611418984, 0.024975299796312498, 0.08186958081741556], [0.4018502588174321, 0.02512513633202757, 0.0853890186022558], [0.40185601808305454, 0.0752136304188486, 0.08554638554650425], [0.02319915973294312, 0.025093516368096157, 0.12813430471210013], [0.07140458689581242, 0.050148335480278014, 0.10340031759972254], [0.05416998516583248, 0.025063893257740104, 0.13092597105669473], [0.10099391028378181, 0.025142327639764123, 0.09957819525331298], [0.07002478527582182, 0.02517065785625938, 0.09672092873320151], [0.016850412041625313, 0.02525791806061476, 0.07813429606326133], [0.04621453936203671, 0.025280661592527467, 0.06759723351881011], [0.09939056021926469, 0.025192097304656744, 0.08624958976139971], [0.06978073092694925, 0.05019196135192231, 0.09007163373723284], [1.9785234419370152, 0.07401112814043834, 0.06437179284194758], [1.9520859552371397, 0.0740199917359221, 0.07283896576428393], [1.9019083917428339, 0.07409700859633438, 0.048194092752847556], [1.928345878442721, 0.07408814500086196, 0.03972691983043103], [1.9781683149484732, 0.07408501322928765, 0.014371792841962792], [1.9367758008937512, 0.07412626082450736, 0.010374762894274086], [1.8869533643880063, 0.07412939259598351, 0.03572988988288929], [1.0488696584141954, 0.018175253711598564, 0.022166305452708285], [1.7481846001241883, 0.07427474511905677, 0.01726834889363744], [1.6481846001250862, 0.0743548937408174, 0.01797860288206288], [0.20444554992510694, 0.025258511372098624, 0.05499087338257636], [0.2576820538508424, 0.05015384437625162, 0.07470005425086894], [0.2101498602129326, 0.025055977977414143, 0.10499109255475914], [0.25271407013469277, 0.02504873842149384, 0.10037400361501096], [0.13251180546051286, 0.07516574572463805, 0.08912100573010603], [0.13228743022530542, 0.05018701005767816, 0.08232290019591273], [0.17958511125033724, 0.07521578908866398, 0.05807117089482875], [1.9784833676210114, 0.02401112814033275, 0.0642979077530627], [0.3522586354537887, 0.02502282618790544, 0.09026329770432943], [0.54944358169511, 0.07508215025647443, 0.026705992440356548], [0.5512096512682971, 0.024973013288085898, 0.0765763033774506], [0.10076009099181328, 0.0501667057323134, 0.0929320509559064], [0.1338618173806732, 0.0501433876512927, 0.09565142224257947], [1.837130927882284, 0.07413252436774281, 0.0610850168716775], [1.85208595523703, 0.07410014036811999, 0.07354921974158127], [1.5504812369262169, 0.07442065997409088, 0.018687242913358625], [1.4504812369791038, 0.0745008084015422, 0.01939749717447749], [1.063829312863084, 0.049742097425909695, 0.07210919064871409], [1.013809390690188, 0.024781924644805307, 0.07242751328156231], [1.2068608174147095, 0.02470090972127683, 0.021053400508487537], [0.6845776051724698, 0.044688630809223744, 0.05878816754469392], [0.633530398626052, 0.02873294360965924, 0.07514317321024304], [0.6831825647509935, 0.028796827025939355, 0.04988955392031562], [0.9495252730105688, 0.07484726924395972, 0.07297377245914231], [1.0138494055791183, 0.07478236715713267, 0.07250121813409903], [0.9633839792513403, 0.04987318594182318, 0.047837129721718254], [0.7249390493376247, 0.038153968323513504, 0.05500014723524359], [0.7071972806227451, 0.0509308227205678, 0.04656950518610486], [1.3995581256719636, 0.07454709577825382, 0.019759040782425373], [1.3995180515581358, 0.024547096143148154, 0.019685155373259693], [1.3500554826759341, 0.049549889774832066, 0.045074815500820924], [0.949169405297662, 0.07492134108565868, 0.022973754477900482], [1.6484996528007339, 0.024281008644194708, 0.0679047177993587], [1.7484996528015668, 0.024200860030692543, 0.06719446380407415], [1.3001126778124887, 0.04955254904934484, 0.07043067059320944], [0.7238050266638435, 0.047201676232228346, 0.0713102840887189], [0.6833071291333412, 0.0537241630219551, 0.07501105645189646], [0.7011747804473867, 0.040956424142050536, 0.08358374531712791], [1.4507591317306918, 0.049464337544064416, 0.04435982817615722], [1.399913253062123, 0.07447321132004923, 0.06975904058378778], [1.3998731789585726, 0.024473210443400305, 0.06968515579517119], [1.6981645629672308, 0.04931481943365105, 0.01758653334074141], [0.1901797890803789, 0.05016036197748045, 0.0821607836036362], [0.18543279451225428, 0.025057934444864524, 0.10791348899206091], [0.17958005751344067, 0.025263275900307088, 0.05791329012172775], [0.21015495668194087, 0.07510085702922283, 0.1051489003838719], [0.18543787780761792, 0.07510555959603925, 0.10807130879239657], [0.20445063314452872, 0.0752139232881107, 0.05514874393977823], [0.1464054509013668, 0.02528539034191483, 0.05507439147454632], [0.13250674810511404, 0.025165671164443116, 0.08896317871110929], [1.9781282406324685, 0.02408501322933918, 0.014297907752994991], [0.7737653917307715, 0.022164545431961665, 0.07085447182200673], [0.302509711931201, 0.05007006064095559, 0.09518870362594194], [1.6985196899569839, 0.04924093434481633, 0.06758653334055485], [0.49903000817793847, 0.050175079124638644, 0.028943341679350233], [1.599385605995285, 0.049352283933725954, 0.04328964440354021], [0.35025436405736193, 0.050254420050697156, 0.06506258915501659], [0.8991498385381382, 0.04996063390279279, 0.023292309572249145], [0.8993473749152882, 0.07492314667022724, 0.04832999807882755], [0.849525203760044, 0.07492822296395184, 0.07368489819847428], [0.6327751196063289, 0.028926600670136575, 0.025023571735211244], [0.5839001193136345, 0.05376438151248942, 0.050791517549500564], [1.0134541632999017, 0.02485610507827625, 0.022427326398774705], [1.5008163268053973, 0.0493868491631506, 0.06900542741969502], [0.02320422316234237, 0.07510009890713946, 0.12829212453127903], [0.07002984791263249, 0.07517065714546299, 0.09687874759097045], [0.01685547041205256, 0.07525133301723706, 0.07829212122875012], [0.7738045210488684, 0.07217225918278211, 0.07093035557305755], [1.7464351915269423, 0.0492418545004234, 0.041672635369866595], [1.7975308225025823, 0.07423008191540544, 0.01635997988648647], [1.7978859494920971, 0.0741561968275232, 0.06635997988622647], [1.8350263922941399, 0.049173518837607365, 0.03548930334813964], [1.7974907481870823, 0.024230081916085448, 0.01628609479702753], [1.7978458751765944, 0.024156196826125156, 0.06628609479781283], [1.8370908535662926, 0.02413252436700485, 0.061011131783029346], [1.8367758008937887, 0.0742064094560594, 0.011085016871807801], [0.1539790937807311, 0.02503891597912782, 0.11840287158750296], [0.8995049131038949, 0.049886837852460265, 0.07329296099615724], [1.9783258412847537, 0.04904807068485247, 0.03933485029748508], [1.9020659180790946, 0.04906006605191369, 0.07315715020839263], [0.02002731676174197, 0.05017571685760224, 0.10321295637235267], [0.10410053132986138, 0.05006649032468857, 0.12467200031513148], [0.501617071536577, 0.0500174299813526, 0.07895075524647012], [0.6829647848958545, 0.0537980965874418, 0.02493664524056573], [1.886755763735761, 0.049166335140440436, 0.010692947338433564], [0.09628907468576965, 0.0502679376034497, 0.06134340925205112], [0.7234195511033992, 0.047279398483263194, 0.02120932836221714]], "faces": [[1, 0, 92], [0, 2, 92], [3, 1, 92], [2, 3, 92], [5, 97, 4], [4, 97, 6], [7, 97, 5], [6, 97, 7], [0, 1, 106], [35, 0, 106], [1, 16, 106], [5, 4, 102], [4, 43, 102], [24, 5, 102], [16, 17, 108], [16, 35, 106], [35, 16, 108], [17, 18, 107], [36, 17, 107], [17, 36, 108], [18, 19, 103], [37, 18, 103], [18, 37, 107], [19, 20, 109], [19, 38, 103], [38, 19, 109], [20, 21, 111], [20, 39, 109], [39, 20, 111], [21, 22, 104], [40, 21, 104], [21, 40, 111], [22, 23, 110], [22, 41, 104], [41, 22, 110], [23, 24, 105], [42, 23, 105], [23, 42, 110], [43, 24, 102], [24, 43, 105], [36, 35, 108], [37, 36, 107], [38, 37, 103], [39, 38, 109], [40, 39, 111], [41, 40, 104], [42, 41, 110], [43, 42, 105], [2, 163, 3], [73, 163, 2], [3, 163, 54], [7, 168, 6], [6, 168, 81], [62, 168, 7], [54, 164, 55], [54, 163, 73], [73, 164, 54], [55, 165, 56], [55, 164, 74], [74, 165, 55], [56, 161, 57], [75, 161, 56], [56, 165, 75], [57, 166, 58], [57, 161, 76], [76, 166, 57], [58, 169, 59], [58, 166, 77], [77, 169, 58], [59, 162, 60], [78, 162, 59], [59, 169, 78], [60, 167, 61], [60, 162, 79], [79, 167, 60], [61, 170, 62], [61, 167, 80], [80, 170, 61], [81, 168, 62], [62, 170, 81], [74, 164, 73], [75, 165, 74], [76, 161, 75], [77, 166, 76], [78, 169, 77], [79, 162, 78], [80, 167, 79], [81, 170, 80], [1, 3, 224], [16, 1, 224], [3, 54, 224], [7, 5, 220], [5, 24, 220], [62, 7, 220], [17, 16, 225], [54, 16, 224], [16, 54, 225], [18, 17, 226], [55, 17, 225], [17, 55, 226], [19, 18, 222], [18, 56, 222], [56, 18, 226], [20, 19, 227], [57, 19, 222], [19, 57, 227], [21, 20, 221], [20, 58, 221], [58, 20, 227], [22, 21, 223], [59, 21, 221], [21, 59, 223], [23, 22, 228], [60, 22, 223], [22, 60, 228], [24, 23, 229], [61, 23, 228], [23, 61, 229], [24, 62, 220], [62, 24, 229], [54, 55, 225], [55, 56, 226], [56, 57, 222], [57, 58, 227], [58, 59, 221], [59, 60, 223], [60, 61, 228], [61, 62, 229], [0, 285, 2], [35, 285, 0], [2, 285, 73], [6, 288, 4], [4, 288, 43], [81, 288, 6], [36, 282, 35], [35, 282, 73], [73, 285, 35], [37, 283, 36], [74, 282, 36], [36, 283, 74], [38, 287, 37], [75, 283, 37], [37, 287, 75], [39, 284, 38], [38, 284, 76], [76, 287, 38], [40, 279, 39], [39, 279, 77], [77, 284, 39], [41, 280, 40], [78, 279, 40], [40, 280, 78], [42, 286, 41], [79, 280, 41], [41, 286, 79], [43, 281, 42], [42, 281, 80], [80, 286, 42], [81, 281, 43], [43, 288, 81], [73, 282, 74], [74, 283, 75], [75, 287, 76], [76, 284, 77], [77, 279, 78], [78, 280, 79], [79, 286, 80], [80, 281, 81]], "cells": {"triangle_2nd": [[1, 0, 92, 8, 93, 94], [0, 2, 92, 9, 95, 93], [3, 1, 92, 11, 94, 96], [2, 3, 92, 10, 96, 95], [5, 97, 4, 98, 99, 12], [4, 97, 6, 99, 100, 13], [7, 97, 5, 101, 98, 15], [6, 97, 7, 100, 101, 14], [0, 1, 106, 8, 112, 113], [35, 0, 106, 44, 113, 114], [1, 16, 106, 25, 115, 112], [5, 4, 102, 12, 116, 117], [4, 43, 102, 53, 118, 116], [24, 5, 102, 34, 117, 119], [16, 17, 108, 26, 120, 121], [16, 35, 106, 122, 114, 115], [35, 16, 108, 122, 121, 123], [17, 18, 107, 27, 124, 125], [36, 17, 107, 126, 125, 127], [17, 36, 108, 126, 128, 120], [18, 19, 103, 28, 129, 130], [37, 18, 103, 131, 130, 132], [18, 37, 107, 131, 133, 124], [19, 20, 109, 29, 134, 135], [19, 38, 103, 136, 137, 129], [38, 19, 109, 136, 135, 138], [20, 21, 111, 30, 139, 140], [20, 39, 109, 141, 142, 134], [39, 20, 111, 141, 140, 143], [21, 22, 104, 31, 144, 145], [40, 21, 104, 146, 145, 147], [21, 40, 111, 146, 148, 139], [22, 23, 110, 32, 149, 150], [22, 41, 104, 151, 152, 144], [41, 22, 110, 151, 150, 153], [23, 24, 105, 33, 154, 155], [42, 23, 105, 156, 155, 157], [23, 42, 110, 156, 158, 149], [43, 24, 102, 159, 119, 118], [24, 43, 105, 159, 160, 154], [36, 35, 108, 45, 123, 128], [37, 36, 107, 46, 127, 133], [38, 37, 103, 47, 132, 137], [39, 38, 109, 48, 138, 142], [40, 39, 111, 49, 143, 148], [41, 40, 104, 50, 147, 152], [42, 41, 110, 51, 153, 158], [43, 42, 105, 52, 157, 160], [2, 163, 3, 171, 172, 10], [73, 163, 2, 173, 171, 82], [3, 163, 54, 172, 174, 63], [7, 168, 6, 175, 176, 14], [6, 168, 81, 176, 177, 91], [62, 168, 7, 178, 175, 72], [54, 164, 55, 179, 180, 64], [54, 163, 73, 174, 173, 181], [73, 164, 54, 182, 179, 181], [55, 165, 56, 183, 184, 65], [55, 164, 74, 180, 185, 186], [74, 165, 55, 187, 183, 186], [56, 161, 57, 188, 189, 66], [75, 161, 56, 190, 188, 191], [56, 165, 75, 184, 192, 191], [57, 166, 58, 193, 194, 67], [57, 161, 76, 189, 195, 196], [76, 166, 57, 197, 193, 196], [58, 169, 59, 198, 199, 68], [58, 166, 77, 194, 200, 201], [77, 169, 58, 202, 198, 201], [59, 162, 60, 203, 204, 69], [78, 162, 59, 205, 203, 206], [59, 169, 78, 199, 207, 206], [60, 167, 61, 208, 209, 70], [60, 162, 79, 204, 210, 211], [79, 167, 60, 212, 208, 211], [61, 170, 62, 213, 214, 71], [61, 167, 80, 209, 215, 216], [80, 170, 61, 217, 213, 216], [81, 168, 62, 177, 178, 218], [62, 170, 81, 214, 219, 218], [74, 164, 73, 185, 182, 83], [75, 165, 74, 192, 187, 84], [76, 161, 75, 195, 190, 85], [77, 166, 76, 200, 197, 86], [78, 169, 77, 207, 202, 87], [79, 162, 78, 210, 205, 88], [80, 167, 79, 215, 212, 89], [81, 170, 80, 219, 217, 90], [1, 3, 224, 11, 230, 231], [16, 1, 224, 25, 231, 232], [3, 54, 224, 63, 233, 230], [7, 5, 220, 15, 234, 235], [5, 24, 220, 34, 236, 234], [62, 7, 220, 72, 235, 237], [17, 16, 225, 26, 238, 239], [54, 16, 224, 240, 232, 233], [16, 54, 225, 240, 241, 238], [18, 17, 226, 27, 242, 243], [55, 17, 225, 244, 239, 245], [17, 55, 226, 244, 246, 242], [19, 18, 222, 28, 247, 248], [18, 56, 222, 249, 250, 247], [56, 18, 226, 249, 243, 251], [20, 19, 227, 29, 252, 253], [57, 19, 222, 254, 248, 255], [19, 57, 227, 254, 256, 252], [21, 20, 221, 30, 257, 258], [20, 58, 221, 259, 260, 257], [58, 20, 227, 259, 253, 261], [22, 21, 223, 31, 262, 263], [59, 21, 221, 264, 258, 265], [21, 59, 223, 264, 266, 262], [23, 22, 228, 32, 267, 268], [60, 22, 223, 269, 263, 270], [22, 60, 228, 269, 271, 267], [24, 23, 229, 33, 272, 273], [61, 23, 228, 274, 268, 275], [23, 61, 229, 274, 276, 272], [24, 62, 220, 277, 237, 236], [62, 24, 229, 277, 273, 278], [54, 55, 225, 64, 245, 241], [55, 56, 226, 65, 251, 246], [56, 57, 222, 66, 255, 250], [57, 58, 227, 67, 261, 256], [58, 59, 221, 68, 265, 260], [59, 60, 223, 69, 270, 266], [60, 61, 228, 70, 275, 271], [61, 62, 229, 71, 278, 276], [0, 285, 2, 289, 290, 9], [35, 285, 0, 291, 289, 44], [2, 285, 73, 290, 292, 82], [6, 288, 4, 293, 294, 13], [4, 288, 43, 294, 295, 53], [81, 288, 6, 296, 293, 91], [36, 282, 35, 297, 298, 45], [35, 282, 73, 298, 299, 300], [73, 285, 35, 292, 291, 300], [37, 283, 36, 301, 302, 46], [74, 282, 36, 303, 297, 304], [36, 283, 74, 302, 305, 304], [38, 287, 37, 306, 307, 47], [75, 283, 37, 308, 301, 309], [37, 287, 75, 307, 310, 309], [39, 284, 38, 311, 312, 48], [38, 284, 76, 312, 313, 314], [76, 287, 38, 315, 306, 314], [40, 279, 39, 316, 317, 49], [39, 279, 77, 317, 318, 319], [77, 284, 39, 320, 311, 319], [41, 280, 40, 321, 322, 50], [78, 279, 40, 323, 316, 324], [40, 280, 78, 322, 325, 324], [42, 286, 41, 326, 327, 51], [79, 280, 41, 328, 321, 329], [41, 286, 79, 327, 330, 329], [43, 281, 42, 331, 332, 52], [42, 281, 80, 332, 333, 334], [80, 286, 42, 335, 326, 334], [81, 281, 43, 336, 331, 337], [43, 288, 81, 295, 296, 337], [73, 282, 74, 299, 303, 83], [74, 283, 75, 305, 308, 84], [75, 287, 76, 310, 315, 85], [76, 284, 77, 313, 320, 86], [77, 279, 78, 318, 323, 87], [78, 280, 79, 325, 328, 88], [79, 286, 80, 330, 335, 89], [80, 281, 81, 333, 336, 90]], "tetrahedron_2nd": [[339, 79, 80, 167, 363, 89, 364, 365, 215, 212], [23, 22, 339, 228, 32, 366, 367, 268, 368, 267], [56, 340, 57, 161, 369, 370, 66, 188, 189, 371], [3, 341, 54, 163, 372, 373, 63, 172, 174, 374], [41, 339, 42, 110, 375, 376, 51, 153, 158, 377], [345, 58, 221, 361, 378, 260, 379, 380, 381, 382], [19, 18, 103, 349, 28, 130, 129, 383, 384, 385], [351, 345, 221, 361, 386, 379, 387, 388, 381, 380], [345, 351, 359, 279, 386, 389, 390, 391, 392, 393], [38, 353, 103, 37, 394, 395, 137, 47, 132, 396], [76, 75, 161, 340, 85, 190, 195, 397, 371, 398], [74, 73, 164, 342, 83, 182, 185, 399, 400, 401], [2, 163, 73, 350, 171, 173, 82, 402, 403, 404], [16, 17, 342, 108, 26, 405, 406, 121, 407, 120], [58, 345, 221, 59, 378, 379, 260, 68, 265, 408], [54, 55, 342, 225, 64, 409, 410, 241, 411, 245], [23, 343, 105, 24, 412, 413, 155, 33, 154, 414], [43, 4, 102, 344, 53, 116, 118, 415, 416, 417], [348, 40, 78, 362, 418, 324, 419, 420, 421, 422], [78, 345, 77, 169, 423, 424, 87, 207, 202, 425], [78, 362, 40, 359, 421, 422, 324, 426, 427, 428], [346, 17, 18, 107, 429, 27, 430, 431, 124, 125], [346, 55, 17, 338, 432, 244, 429, 433, 434, 435], [351, 40, 39, 111, 436, 49, 437, 438, 143, 148], [39, 109, 38, 347, 142, 138, 48, 439, 440, 441], [21, 351, 40, 359, 442, 436, 146, 443, 427, 389], [352, 5, 102, 24, 444, 117, 445, 446, 119, 34], [109, 19, 347, 20, 135, 447, 441, 134, 448, 29], [80, 81, 343, 170, 90, 449, 450, 217, 451, 219], [60, 162, 59, 348, 204, 203, 69, 452, 453, 454], [22, 21, 348, 223, 31, 455, 456, 263, 457, 262], [75, 74, 165, 346, 84, 187, 192, 458, 459, 460], [359, 345, 59, 221, 390, 408, 461, 462, 265, 379], [59, 362, 78, 359, 463, 421, 206, 461, 426, 428], [348, 78, 79, 162, 419, 88, 464, 454, 210, 205], [59, 345, 78, 169, 408, 423, 206, 199, 207, 425], [345, 359, 351, 221, 390, 389, 386, 379, 387, 462], [347, 57, 19, 349, 465, 254, 447, 466, 383, 467], [352, 355, 344, 102, 468, 469, 470, 445, 416, 471], [41, 40, 348, 104, 50, 418, 472, 152, 473, 147], [36, 346, 17, 338, 474, 429, 126, 475, 434, 433], [55, 346, 74, 338, 432, 460, 186, 435, 476, 433], [0, 354, 350, 106, 477, 478, 479, 113, 480, 481], [1, 354, 106, 341, 482, 481, 112, 483, 484, 485], [6, 355, 344, 168, 486, 469, 487, 176, 488, 489], [7, 355, 168, 352, 490, 489, 175, 491, 492, 468], [21, 351, 20, 111, 442, 493, 30, 139, 140, 438], [62, 343, 170, 61, 494, 451, 214, 71, 213, 495], [58, 345, 59, 169, 378, 408, 68, 198, 199, 425], [21, 351, 221, 20, 442, 387, 258, 30, 257, 493], [360, 16, 342, 35, 496, 406, 497, 498, 499, 122], [163, 357, 341, 54, 500, 501, 374, 174, 373, 502], [344, 4, 102, 355, 417, 116, 416, 469, 471, 503], [35, 342, 36, 108, 499, 504, 45, 123, 128, 407], [346, 55, 165, 56, 432, 183, 459, 505, 184, 65], [352, 344, 355, 168, 470, 469, 468, 492, 489, 488], [54, 342, 55, 164, 410, 409, 64, 179, 180, 400], [346, 107, 37, 36, 431, 133, 506, 474, 46, 127], [350, 341, 163, 357, 507, 374, 404, 508, 500, 501], [352, 81, 344, 168, 509, 510, 470, 492, 488, 177], [61, 339, 167, 60, 511, 365, 209, 70, 208, 512], [23, 339, 22, 110, 367, 366, 32, 149, 150, 377], [279, 361, 351, 39, 513, 388, 393, 317, 437, 514], [348, 59, 21, 362, 453, 264, 455, 420, 515, 463], [340, 353, 37, 103, 516, 396, 517, 518, 132, 395], [39, 347, 77, 361, 439, 519, 319, 514, 520, 521], [349, 353, 340, 103, 522, 516, 523, 384, 518, 395], [77, 58, 345, 361, 201, 378, 424, 520, 380, 382], [60, 348, 22, 356, 452, 456, 269, 524, 525, 526], [339, 79, 167, 60, 363, 212, 365, 512, 208, 211], [22, 348, 21, 104, 456, 455, 31, 144, 145, 473], [279, 361, 39, 77, 513, 514, 317, 318, 319, 520], [347, 77, 361, 58, 519, 520, 521, 527, 382, 201], [359, 345, 279, 78, 390, 391, 392, 426, 323, 423], [60, 22, 348, 223, 269, 456, 452, 270, 457, 263], [42, 43, 105, 343, 52, 160, 157, 528, 413, 529], [348, 78, 40, 280, 419, 324, 418, 530, 322, 325], [349, 287, 340, 353, 531, 532, 523, 522, 516, 533], [59, 362, 359, 21, 463, 428, 461, 264, 443, 515], [339, 41, 79, 356, 375, 329, 363, 534, 535, 536], [62, 343, 61, 229, 494, 495, 71, 278, 276, 537], [58, 345, 169, 77, 378, 425, 198, 201, 202, 424], [40, 359, 279, 78, 427, 392, 316, 324, 323, 426], [35, 342, 108, 16, 499, 407, 123, 122, 121, 406], [74, 164, 55, 342, 185, 180, 186, 399, 409, 400], [360, 16, 35, 357, 496, 122, 498, 538, 539, 540], [360, 35, 73, 357, 498, 300, 541, 538, 542, 539], [360, 16, 357, 54, 496, 540, 538, 543, 502, 240], [347, 39, 109, 20, 439, 142, 441, 448, 134, 141], [342, 35, 73, 360, 499, 300, 401, 497, 541, 498], [341, 357, 16, 54, 501, 540, 544, 373, 240, 502], [16, 357, 341, 106, 540, 501, 544, 115, 484, 545], [352, 102, 5, 355, 445, 117, 444, 468, 546, 471], [38, 349, 103, 353, 547, 384, 137, 394, 395, 522], [342, 73, 35, 282, 401, 300, 499, 548, 298, 299], [281, 43, 42, 343, 331, 52, 332, 549, 528, 529], [61, 343, 170, 80, 495, 451, 213, 216, 217, 450], [346, 55, 56, 226, 432, 65, 505, 550, 251, 246], [107, 18, 346, 37, 124, 430, 431, 133, 506, 131], [102, 4, 5, 355, 116, 12, 117, 471, 546, 503], [80, 281, 42, 343, 333, 332, 334, 450, 528, 549], [80, 42, 339, 343, 334, 376, 364, 450, 551, 528], [17, 55, 342, 338, 244, 409, 405, 434, 552, 435], [75, 165, 56, 346, 192, 184, 191, 458, 505, 459], [348, 21, 59, 223, 455, 264, 453, 457, 266, 262], [347, 58, 227, 57, 527, 261, 553, 465, 256, 67], [60, 22, 339, 356, 269, 366, 512, 524, 534, 525], [342, 54, 73, 164, 410, 181, 401, 400, 182, 179], [38, 349, 353, 287, 547, 522, 394, 306, 533, 531], [75, 340, 287, 37, 398, 532, 310, 309, 307, 517], [166, 57, 347, 76, 193, 465, 554, 197, 555, 196], [340, 18, 349, 103, 556, 385, 523, 518, 384, 130], [37, 346, 75, 340, 506, 458, 309, 517, 398, 557], [60, 348, 79, 162, 452, 464, 211, 204, 210, 454], [356, 339, 41, 22, 534, 375, 536, 525, 151, 366], [22, 41, 348, 104, 151, 472, 456, 144, 473, 152], [347, 361, 20, 58, 521, 558, 448, 527, 259, 382], [21, 348, 40, 104, 455, 418, 146, 145, 147, 473], [348, 356, 79, 41, 526, 535, 464, 472, 329, 536], [167, 80, 339, 61, 215, 364, 365, 209, 511, 216], [110, 339, 42, 23, 377, 376, 158, 149, 156, 367], [339, 79, 41, 286, 363, 329, 375, 559, 327, 330], [42, 343, 105, 23, 528, 413, 157, 156, 155, 412], [166, 77, 347, 58, 200, 519, 554, 194, 527, 201], [166, 57, 58, 347, 193, 67, 194, 554, 527, 465], [2, 3, 163, 354, 10, 172, 171, 560, 561, 562], [339, 41, 22, 110, 375, 151, 366, 377, 150, 153], [347, 76, 349, 38, 555, 563, 466, 440, 547, 314], [59, 162, 78, 348, 203, 205, 206, 453, 419, 454], [348, 22, 356, 41, 456, 525, 526, 472, 536, 151], [347, 19, 109, 38, 447, 135, 441, 440, 138, 136], [62, 343, 358, 81, 494, 564, 565, 218, 566, 449], [351, 361, 221, 20, 388, 381, 387, 493, 257, 558], [347, 76, 57, 349, 555, 196, 465, 466, 467, 563], [343, 43, 105, 24, 529, 160, 413, 414, 154, 159], [24, 352, 358, 43, 446, 567, 568, 159, 569, 570], [344, 6, 168, 81, 487, 176, 488, 510, 177, 91], [352, 7, 62, 168, 491, 72, 571, 492, 178, 175], [354, 0, 1, 106, 477, 8, 482, 481, 112, 113], [341, 1, 16, 106, 483, 25, 544, 484, 115, 112], [1, 354, 341, 3, 482, 485, 483, 11, 372, 562], [350, 0, 106, 35, 479, 113, 480, 572, 114, 44], [355, 6, 7, 168, 486, 14, 490, 489, 175, 176], [7, 355, 352, 5, 490, 468, 491, 15, 444, 546], [280, 78, 79, 348, 325, 88, 328, 530, 464, 419], [347, 227, 58, 20, 553, 261, 527, 448, 259, 253], [361, 58, 221, 20, 382, 260, 381, 558, 257, 259], [81, 43, 343, 358, 337, 529, 449, 566, 564, 569], [21, 351, 111, 40, 442, 438, 139, 146, 148, 436], [342, 36, 338, 74, 504, 475, 552, 399, 476, 304], [106, 16, 357, 35, 115, 540, 545, 114, 539, 122], [39, 347, 361, 20, 439, 521, 514, 141, 558, 448], [60, 348, 59, 223, 452, 453, 69, 270, 266, 457], [347, 76, 38, 284, 555, 314, 440, 573, 312, 313], [17, 342, 55, 225, 405, 409, 244, 239, 245, 411], [351, 361, 20, 39, 388, 558, 493, 437, 141, 514], [343, 23, 61, 229, 412, 274, 495, 537, 276, 272], [352, 81, 62, 358, 509, 218, 571, 567, 565, 566], [352, 81, 168, 62, 509, 177, 492, 571, 178, 218], [221, 59, 359, 21, 265, 461, 462, 258, 443, 264], [74, 346, 36, 338, 460, 474, 304, 476, 475, 433], [56, 75, 346, 340, 191, 458, 505, 369, 557, 398], [75, 340, 56, 161, 398, 369, 191, 190, 188, 371], [340, 18, 103, 37, 556, 130, 518, 517, 132, 131], [24, 62, 343, 358, 277, 494, 414, 568, 564, 565], [340, 287, 37, 353, 532, 307, 517, 516, 396, 533], [24, 352, 62, 358, 446, 571, 277, 568, 565, 567], [21, 351, 359, 221, 442, 389, 443, 258, 462, 387], [339, 23, 228, 61, 367, 268, 368, 511, 275, 274], [343, 42, 339, 23, 528, 376, 551, 412, 367, 156], [57, 340, 76, 161, 370, 397, 196, 189, 195, 371], [349, 38, 76, 287, 547, 314, 563, 531, 315, 306], [24, 352, 43, 102, 446, 570, 159, 119, 118, 445], [59, 362, 348, 78, 463, 420, 453, 206, 419, 421], [352, 81, 358, 43, 509, 566, 567, 570, 569, 337], [359, 362, 40, 21, 428, 422, 427, 443, 146, 515], [347, 166, 76, 77, 554, 197, 555, 519, 86, 200], [347, 19, 57, 227, 447, 254, 465, 553, 256, 252], [3, 341, 163, 354, 372, 374, 172, 562, 561, 485], [347, 77, 76, 284, 519, 86, 555, 573, 313, 320], [355, 7, 6, 97, 490, 14, 486, 574, 100, 101], [344, 6, 288, 4, 487, 293, 575, 417, 294, 13], [354, 1, 0, 92, 482, 8, 477, 576, 93, 94], [2, 3, 354, 92, 10, 562, 560, 95, 576, 96], [1, 354, 3, 92, 482, 562, 11, 94, 96, 576], [355, 4, 5, 97, 503, 12, 546, 574, 98, 99], [7, 355, 5, 97, 490, 546, 15, 101, 98, 574], [350, 0, 285, 2, 479, 289, 577, 402, 290, 9], [37, 346, 283, 75, 506, 578, 301, 309, 308, 458], [36, 17, 346, 107, 126, 429, 474, 127, 431, 125], [346, 17, 55, 226, 429, 244, 432, 550, 246, 242], [80, 81, 281, 343, 90, 336, 333, 450, 549, 449], [163, 357, 54, 73, 500, 502, 174, 173, 181, 542], [55, 74, 346, 165, 186, 460, 432, 183, 459, 187], [74, 36, 346, 283, 304, 474, 460, 305, 578, 302], [38, 287, 353, 37, 306, 533, 394, 47, 396, 307], [286, 79, 80, 339, 330, 89, 335, 559, 364, 363], [61, 80, 339, 343, 216, 364, 511, 495, 551, 450], [73, 35, 285, 350, 300, 291, 292, 403, 577, 572], [75, 74, 346, 283, 84, 460, 458, 308, 578, 305], [56, 222, 57, 340, 250, 255, 66, 369, 370, 579], [37, 18, 346, 340, 131, 430, 506, 517, 557, 556], [350, 341, 357, 106, 507, 501, 508, 480, 545, 484], [24, 62, 352, 220, 277, 571, 446, 236, 580, 237], [340, 18, 56, 222, 556, 249, 369, 579, 250, 247], [3, 224, 54, 341, 230, 233, 63, 372, 373, 581], [352, 7, 220, 62, 491, 235, 580, 571, 237, 72], [350, 0, 35, 285, 479, 44, 572, 577, 291, 289], [341, 1, 3, 224, 483, 11, 372, 581, 230, 231], [74, 73, 342, 282, 83, 401, 399, 303, 548, 299], [342, 36, 74, 282, 504, 304, 399, 548, 303, 297], [62, 343, 81, 170, 494, 449, 218, 214, 219, 451], [60, 339, 22, 228, 512, 366, 269, 271, 267, 368], [360, 54, 73, 342, 543, 181, 541, 497, 401, 410], [23, 229, 343, 24, 272, 537, 412, 33, 414, 273], [39, 77, 347, 284, 319, 519, 439, 311, 573, 320], [36, 342, 17, 108, 504, 405, 126, 128, 120, 407], [24, 343, 62, 229, 414, 494, 277, 273, 278, 537], [43, 4, 344, 288, 53, 417, 415, 295, 575, 294], [6, 355, 97, 4, 486, 574, 100, 13, 99, 503], [80, 42, 286, 339, 334, 326, 335, 364, 559, 376], [6, 355, 4, 344, 486, 503, 13, 487, 417, 469], [78, 279, 77, 345, 323, 318, 87, 423, 424, 391], [41, 40, 280, 348, 50, 322, 321, 472, 530, 418], [59, 345, 359, 78, 408, 390, 461, 206, 426, 423], [226, 17, 18, 346, 242, 27, 243, 550, 430, 429], [35, 342, 282, 36, 499, 548, 298, 45, 297, 504], [350, 341, 354, 163, 507, 485, 478, 404, 561, 374], [346, 56, 18, 226, 505, 249, 430, 550, 243, 251], [279, 361, 345, 351, 513, 380, 391, 393, 386, 388], [39, 347, 38, 284, 439, 440, 48, 311, 312, 573], [20, 351, 39, 111, 493, 437, 141, 140, 143, 438], [18, 56, 346, 340, 249, 505, 430, 556, 557, 369], [41, 286, 42, 339, 327, 326, 51, 375, 376, 559], [60, 79, 348, 356, 211, 464, 452, 524, 526, 535], [280, 348, 79, 41, 530, 464, 328, 321, 329, 472], [21, 362, 40, 348, 515, 422, 146, 455, 418, 420], [23, 61, 339, 343, 274, 511, 367, 412, 551, 495], [61, 339, 60, 228, 511, 512, 70, 275, 271, 368], [339, 79, 60, 356, 363, 211, 512, 534, 524, 535], [352, 344, 43, 102, 470, 415, 570, 445, 118, 416], [19, 18, 349, 222, 28, 385, 383, 248, 582, 247], [57, 349, 340, 222, 467, 523, 370, 255, 579, 582], [340, 18, 222, 349, 556, 247, 579, 523, 582, 385], [57, 349, 222, 19, 467, 582, 255, 254, 248, 383], [352, 81, 43, 344, 509, 337, 570, 470, 415, 510], [349, 287, 76, 340, 531, 315, 563, 523, 397, 532], [341, 1, 224, 16, 483, 231, 581, 544, 232, 25], [16, 341, 54, 224, 544, 373, 240, 232, 233, 581], [76, 75, 340, 287, 85, 398, 397, 315, 532, 310], [338, 342, 74, 55, 552, 399, 476, 435, 186, 409], [350, 357, 163, 73, 508, 500, 404, 403, 173, 542], [57, 349, 76, 340, 467, 563, 196, 370, 397, 523], [2, 350, 73, 285, 402, 403, 82, 290, 292, 577], [0, 354, 92, 2, 477, 576, 93, 9, 95, 560], [342, 17, 338, 36, 405, 434, 552, 504, 475, 126], [0, 354, 2, 350, 477, 560, 9, 479, 402, 478], [16, 17, 225, 342, 26, 239, 238, 406, 411, 405], [350, 341, 106, 354, 507, 484, 480, 478, 481, 485], [38, 349, 19, 103, 547, 383, 136, 137, 129, 384], [54, 16, 225, 342, 240, 238, 241, 410, 411, 406], [350, 357, 35, 106, 508, 539, 572, 480, 114, 545], [354, 163, 2, 350, 561, 171, 560, 478, 402, 404], [344, 6, 81, 288, 487, 91, 510, 575, 296, 293], [344, 81, 43, 288, 510, 337, 415, 575, 295, 296], [279, 40, 39, 351, 316, 49, 317, 393, 437, 436], [40, 359, 351, 279, 427, 389, 436, 316, 393, 392], [279, 361, 77, 345, 513, 520, 318, 391, 424, 380], [54, 357, 360, 73, 502, 538, 543, 181, 541, 542], [360, 16, 54, 342, 496, 240, 543, 497, 410, 406], [346, 36, 37, 283, 474, 46, 506, 578, 301, 302], [35, 357, 350, 73, 539, 508, 572, 300, 403, 542], [220, 5, 352, 24, 234, 444, 580, 236, 446, 34], [81, 343, 43, 281, 449, 529, 337, 336, 331, 549], [358, 343, 24, 43, 564, 414, 568, 569, 159, 529], [352, 7, 5, 220, 491, 15, 444, 580, 234, 235], [347, 19, 227, 20, 447, 252, 553, 448, 253, 29], [347, 349, 19, 38, 466, 383, 447, 440, 136, 547]], "line_2nd": [[1, 0, 8], [0, 2, 9], [3, 2, 10], [1, 3, 11], [5, 4, 12], [4, 6, 13], [7, 6, 14], [5, 7, 15], [1, 16, 25], [16, 17, 26], [17, 18, 27], [18, 19, 28], [19, 20, 29], [20, 21, 30], [21, 22, 31], [22, 23, 32], [23, 24, 33], [24, 5, 34], [0, 35, 44], [35, 36, 45], [36, 37, 46], [37, 38, 47], [38, 39, 48], [39, 40, 49], [40, 41, 50], [41, 42, 51], [42, 43, 52], [43, 4, 53], [3, 54, 63], [54, 55, 64], [55, 56, 65], [56, 57, 66], [57, 58, 67], [58, 59, 68], [59, 60, 69], [60, 61, 70], [61, 62, 71], [62, 7, 72], [2, 73, 82], [73, 74, 83], [74, 75, 84], [75, 76, 85], [76, 77, 86], [77, 78, 87], [78, 79, 88], [79, 80, 89], [80, 81, 90], [81, 6, 91]]}};

const fieldData = {"values": [0.056035992613889855, 0.05612270461629155, 0.056350906940809964, 0.05643470645454564, 0.009669645699547086, 0.00968745811683746, 0.009522343632511442, 0.009534462401818308, 0.055692332128085296, 0.0561954755212901, 0.05600790192650524, 0.056280803633992, 0.009671756416325207, 0.009595909188287158, 0.009521498127425244, 0.00961089715227657, 0.03134380126130076, 0.01144945864894509, 0.0015322168233684163, 0.0013471960368370115, 0.0026361638604768785, 0.004019294134472081, 0.0054265216593732115, 0.006842998608891655, 0.008263969949141695, 0.043411059235618915, 0.02047829242741569, 0.004887936028537579, 0.000989086230600905, 0.00196840838083081, 0.003322809544025607, 0.004721232360873155, 0.006134003413489523, 0.007553080835373766, 0.008975474222744402, 0.031202668029885833, 0.011185324062391123, 0.0006579062927046613, 0.0010898131724793071, 0.0025230648663975433, 0.003952248202008499, 0.005381468765445893, 0.00681080640583738, 0.008240208017260192, 0.04330188640278677, 0.020289973102099304, 0.004417922877259107, 0.0004629250624644095, 0.0018094468397820277, 0.003237766215596381, 0.004666843656260991, 0.0060961270943106485, 0.007525501434140514, 0.00895492342587117, 0.03164974606853092, 0.011732911519225554, 0.0014834803526952186, 0.0011718482371257447, 0.002470860933907852, 0.003859140915792549, 0.0052693177203568045, 0.006687704609395335, 0.008110002789875795, 0.04372087062093161, 0.0207762749464792, 0.005101096631898412, 0.0008387789233892907, 0.001801430790057661, 0.003160607507662943, 0.004562732460068185, 0.005977848291603716, 0.007398505577731527, 0.008822027814861971, 0.03151530201892408, 0.011487371353942387, 0.0007660980954629979, 0.0009515775169123583, 0.002374834646810879, 0.003804291969365278, 0.005233798391050873, 0.00666330994204924, 0.008092825582717266, 0.043616047134900894, 0.02059963668289302, 0.004683779087028091, 0.0003102072727676026, 0.001660407373499628, 0.003089545980019125, 0.004519045503601589, 0.005948553555473076, 0.007378067380535577, 0.008807584377958647, 0.05584259050771134, 0.05584408386429842, 0.05588710368182641, 0.05600197475603747, 0.05604425226846167, 0.009596553257643428, 0.009639946269303824, 0.00963173905074095, 0.009557335184061246, 0.009564118349851065, 0.008957863660392923, 0.0006836373977515752, 0.0046800802354919095, 0.007530572807422759, 0.042886702747660675, 0.0037094014672764434, 0.019691960058928294, 0.0018551353523549262, 0.006104326921132968, 0.0032604326367379273, 0.04936368656802809, 0.0493150360747513, 0.03679372603389018, 0.03685594414580814, 0.009311772607311813, 0.009321342675876075, 0.008597355464952864, 0.008608407795114854, 0.01510007569343749, 0.02518200956683639, 0.030685784302200484, 0.02509934362036328, 0.0019532141910717114, 0.007068981029388592, 0.010499807671306212, 0.006872149673008954, 0.014986807596317363, 0.0009767666227639806, 0.0008798874283769784, 0.00045114269474928715, 0.00026657586603418107, 0.0015588860275647359, 0.002244715603499549, 0.0015701297208840946, 0.0011752166132540044, 0.0008016008716784194, 0.001470391835338777, 0.003637983304286958, 0.002937046404652546, 0.0025546999399685224, 0.0021773517661364344, 0.0028880890750538116, 0.005051483898704018, 0.004343426694365669, 0.003969376867676661, 0.004313246886295125, 0.003600262664654869, 0.006472021678595111, 0.005761197442568061, 0.005391854943931009, 0.005026739930776041, 0.005740544910419245, 0.007895803270124036, 0.007183627412842125, 0.006817278257501768, 0.007168727346175128, 0.0064545619967242476, 0.008244121515774668, 0.00788300082087343, 0.0005219731190674759, 0.0045264299170421915, 0.04320223966363811, 0.02000734424318842, 0.004017263900658466, 0.001693218296436711, 0.005952176510671591, 0.00880734264607115, 0.003104138954373857, 0.007379383941889178, 0.049630789445702074, 0.04967767698621681, 0.03710944531630693, 0.03716892739700854, 0.009169513351851347, 0.009162891508810658, 0.008448307606933818, 0.008456189407989693, 0.025492876824883614, 0.015407861709472507, 0.03100132870543904, 0.025414912526207534, 0.00735815131994013, 0.0021682887000253623, 0.015302079655371963, 0.010816034643170628, 0.007188076905381363, 0.0007302139325910433, 0.0008426921480268218, 0.00012308657681773505, 0.0004878815040163095, 0.0018316900704147693, 0.0013999987615127315, 0.002081486955481424, 0.0006417761094379211, 0.0010108958709214768, 0.0013150131421297195, 0.002776227335175849, 0.0034794952727260123, 0.0020219832767403947, 0.002396153780930631, 0.002734983926597654, 0.0041865533780019205, 0.004895865277289331, 0.004162086005102782, 0.003814612974047383, 0.0034482673665345146, 0.005606557197716807, 0.006318167915531849, 0.004876169823417433, 0.0052390463039170086, 0.005590426875519558, 0.00703041781786124, 0.00774313066826444, 0.006304797916282941, 0.006665656165569324, 0.007019248512476146, 0.008093294224597194, 0.007733756595224913, 0.008898684800972336, 0.003241624190358039, 0.0008578029606489912, 0.00464189720814905, 0.04359096051498111, 0.02069756713258343, 0.005062431072071608, 0.0018856412001209135, 0.006055845842611206, 0.007475720197907585, 0.04994755161708144, 0.04979203758247104, 0.037379952147968305, 0.037534042497780425, 0.009293061498752045, 0.009216454495203032, 0.008581179783078277, 0.008504330794750868, 0.025823064633265887, 0.015844833425631734, 0.03154198973123607, 0.02597436115634994, 0.007929773790691399, 0.0028210489072287483, 0.011675639805264412, 0.015990959272287126, 0.008058774446044895, 0.0009800966795013384, 0.0010468263240922793, 0.001492455724861317, 0.0009196510386754415, 0.0028952272875950626, 0.0016075639345607554, 0.0022577192320062927, 0.0012659026532620679, 0.0009778126240617647, 0.0015212594118111749, 0.0029368750076718565, 0.003629842466348749, 0.0025536771486128216, 0.0028550933843885977, 0.002174712125015496, 0.004329861067457826, 0.005034029407823166, 0.003939140217043965, 0.003549285454956332, 0.004250223546566239, 0.005740814652345866, 0.00644935838676499, 0.005347837064470843, 0.004955120578825929, 0.005662487526833826, 0.00715913838668169, 0.00786982019842865, 0.006765275061071909, 0.00637150551078239, 0.007081678251671132, 0.008186916839208991, 0.0077926901714500795, 0.003163378027849411, 0.004592768651041382, 0.007451674985196623, 0.02051431782677086, 0.004655250506250857, 0.001733129271941407, 0.043483789398570685, 0.006022205737928389, 0.00020096791117056907, 0.008881161698228038, 0.04969571087646384, 0.049853007782613055, 0.03725760314734514, 0.037414373742478496, 0.00920172711535241, 0.009275387570217212, 0.008560653121665556, 0.008486972578945127, 0.015626262202317387, 0.02566301182537208, 0.02581873779778699, 0.0314040811053215, 0.0022407280058725546, 0.007598007397273964, 0.015779759122213525, 0.011421257832526848, 0.00774518431354962, 0.0006919874558420749, 0.00014307834307884326, 0.002357686478856982, 0.0007762827777649889, 0.00010200437812867966, 0.002128663068324153, 0.0014115672840797236, 0.0013393457509781553, 0.0010185422817326553, 0.0005829372667613018, 0.003557810936692491, 0.0028431748184573513, 0.0027690104658552183, 0.002448839363931385, 0.002054259628491581, 0.004987098178663039, 0.0042724339625865426, 0.003483770309367106, 0.0038780754515297584, 0.0041984941127490355, 0.006416486369870409, 0.005701783780333079, 0.00491323145335152, 0.005307482141305113, 0.005627972831048095, 0.007845923667685342, 0.007131200696750982, 0.007057467949075783, 0.006736937516247254, 0.006342718832332655, 0.007772219389990371, 0.008166416722960968, 0.010706871109021902, 0.006043041548035463, 0.0003318868210685043, 0.042967527684274795, 0.019845066945353696, 0.007436987196953019, 0.008912697354761134, 0.0031539845994705993, 0.003912465834083139, 0.0017708557006804783, 0.004607967803992099, 0.0008132059434729267, 0.04295077106173419, 0.0031955506775754676, 0.00870468812809953, 0.0004361993150603046, 0.05058949131738978, 0.0092933560761745, 0.005317048804763669, 0.03497180685698176, 0.008141692739897599, 0.0036419749651373516, 0.029102601006486074, 0.0026735090597854215, 0.0039979442367812585, 0.0056353211565802475, 0.00634961415140994, 0.0059975834957043455, 0.005729888181187267, 0.006440922585668358, 0.006046718082054933, 0.000768542166199143, 0.0007893561813648937, 0.0004371060006770875, 0.04960580647040177, 0.03712614275005117, 0.043081595607576545, 0.005710379350408416, 0.006424495542053268, 0.006073656654864101, 0.0028020036950313063, 0.00319263418415436, 0.0029134712768015924, 0.0029548587001951014, 0.0025653666597690336, 0.0010800465419466359, 0.0007263414348191017, 0.0007850524548811228, 0.003174753004959484, 0.003213841230922628, 0.0029343491949493875, 0.0034186033797952045, 0.0033978954790478606, 0.0031537327414762396, 0.0033986662139353866, 0.0031740162185540824, 0.0007622966901515469, 0.0005790879822543223, 0.00014307834307884326, 0.0005386803752623737, 8.535662519864364e-05, 0.015248080671022858, 0.01994305285125791, 0.025348835098160313, 0.049551930590204976, 0.03705574636623747, 0.0430733488485864, 0.01519382816846796, 0.025264813505458145, 0.019785345459635603, 0.0035048367361874104, 0.01534808139165014, 0.02542033658723213, 0.020097268249740372, 0.007136334616159532, 0.00748375917861631, 0.00784864180988783, 0.008575844737352909, 0.008935003725821128, 0.009290414612282178, 0.00427776051538323, 0.004202179456565515, 0.0043028520563129485, 0.0038961529566940707, 0.003971889816566743, 0.0034723491251044845, 0.0027591903009006337, 0.0031290378660372943, 0.00371738261563593, 0.003793223330296542, 0.0038199080491776553, 0.00717601311935731, 0.00200731368100228, 0.00383446587656821, 0.007320882632351841, 0.0069519314157114815, 0.010902925232163085, 0.011054986365324251, 0.0035685561355855554, 0.0028560991661518015, 0.0032279733442427223, 0.0021370890598747887, 0.0014257615925315399, 0.0018127661589164843, 0.0036051657492758593, 0.003826693068620513, 0.009195200926698864, 0.008831235160070606, 0.008482437621565196, 0.0015274401055428303, 0.002201960035622976, 0.007762031690709956, 0.007047576897045888, 0.007408161093972962, 0.004937105763683202, 0.0042280949756204455, 0.004567166943143938, 0.004306531610668873, 0.005014914704113313, 0.004621403266217239, 0.0018112220137534133, 0.0039895103745481615, 0.00714927126026745, 0.003747724991013294, 0.0034347664072160522, 0.003924734743557667, 0.0049161332166804085, 0.0014398600727085207, 0.0012629649533927444, 0.0010022581122965013, 0.008998902012308772, 0.009102876809597135, 0.008808168725739383, 0.009125589146556378, 0.004991418696272314, 0.0046439920441701385, 0.006994437143165197, 0.01075815389462059, 0.010915156163213202, 0.05321106325086006, 0.04674041828337346, 0.04939414215642703, 0.04291546134033214, 0.0467256420919419, 0.053256138959186475, 0.049449137964649025, 0.04292400724963585, 0.04674776438420227, 0.009405418782111121, 0.009216190687159755, 0.008859960744905495, 0.00905032973097314, 0.009412802315902092, 0.009119104757573826, 0.008755785207429902, 0.0029038254784478855, 0.007772301394489755, 0.007059724972912878, 0.030082800475245766, 0.024327191014488117, 0.03001291219939485, 0.025191113708997542, 0.03904714368195089, 0.03892239433922693, 0.03315918083015771, 0.009479876434105028, 0.015090358557747971, 0.0021241121460813467, 0.0016652431165059642, 0.042925869390204104, 0.03891306965177551, 0.008395521733362053, 0.0085015548243878, 0.00636399856398834, 0.005652571584621291, 0.0029114185247998033, 0.0025937608204285984, 0.004003497285336252, 0.0003388916143319378, 8.516493217719738e-05, 0.0005147535616210482, 0.002059448562055115, 0.002517025202218388, 0.0022208435447273575, 0.0006273077464580926, 0.0005547131345293892, 0.005290628032015145, 0.0053681795787510036, 0.0049624179689835264, 0.0021203805941107977, 0.007122319287466958, 0.007836656323015072, 0.0045967994843840905, 0.00047938502956015357, 0.0003333209881070084, 0.00021795765155972058, 0.0056799816894822636, 0.005271621753060389, 0.005346787332260758, 0.007454174773352071, 0.03200568784142293, 0.03293748719669907, 0.03300292991983138, 0.03017071556505984, 0.03309534015579444, 0.03023887792581866, 0.03697019331926555, 0.038889371430882134, 0.009488701972390231, 0.0009171548075285962, 0.02001157929413129, 0.0074421122868025815, 0.004291684706591244, 0.006739874299463589, 0.015026175153840226, 0.0018201676723105778, 0.00173173510681675, 0.0013498275586771202, 0.0008546002058326053, 0.0007092577293677409, 0.0026463982105811566, 0.006029906165430217, 0.053368942612972814, 0.046883414816773626, 0.0534132455524178, 0.000833079277476668, 0.007789325348627675, 0.00812430662582656, 0.008114661463038544, 0.008423164634963476, 0.008200547656550523, 0.008189254631590197, 0.008470242993944598, 0.008406131919727685, 0.03689805767214274, 0.0017426116008227334, 0.009444940882435636, 0.00889597623054088, 0.05321744835956191, 0.043153745072561124, 0.004064360432441751, 0.0006764837695567112, 0.008800662532578416, 0.043215924630214696, 0.0008115861706992533], "field_name": "displacement", "field_units": "m", "field_type": "vector", "min_value": 8.516493217719738e-05, "max_value": 0.05643470645454564, "lookup_table": {"number_of_colors": 256, "range": [8.516493217719738e-05, 0.05643470645454564], "colors": [[0.267004, 0.004874, 0.329415, 1.0], [0.26851, 0.009605, 0.335427, 1.0], [0.269944, 0.014625, 0.341379, 1.0], [0.271305, 0.019942, 0.347269, 1.0], [0.272594, 0.025563, 0.353093, 1.0], [0.273809, 0.031497, 0.358853, 1.0], [0.274952, 0.037752, 0.364543, 1.0], [0.276022, 0.044167, 0.370164, 1.0], [0.277018, 0.050344, 0.375715, 1.0], [0.277941, 0.056324, 0.381191, 1.0], [0.278791, 0.062145, 0.386592, 1.0], [0.279566, 0.067836, 0.391917, 1.0], [0.280267, 0.073417, 0.397163, 1.0], [0.280894, 0.078907, 0.402329, 1.0], [0.281446, 0.08432, 0.407414, 1.0], [0.281924, 0.089666, 0.412415, 1.0], [0.282327, 0.094955, 0.417331, 1.0], [0.282656, 0.100196, 0.42216, 1.0], [0.28291, 0.105393, 0.426902, 1.0], [0.283091, 0.110553, 0.431554, 1.0], [0.283197, 0.11568, 0.436115, 1.0], [0.283229, 0.120777, 0.440584, 1.0], [0.283187, 0.125848, 0.44496, 1.0], [0.283072, 0.130895, 0.449241, 1.0], [0.282884, 0.13592, 0.453427, 1.0], [0.282623, 0.140926, 0.457517, 1.0], [0.28229, 0.145912, 0.46151, 1.0], [0.281887, 0.150881, 0.465405, 1.0], [0.281412, 0.155834, 0.469201, 1.0], [0.280868, 0.160771, 0.472899, 1.0], [0.280255, 0.165693, 0.476498, 1.0], [0.279574, 0.170599, 0.479997, 1.0], [0.278826, 0.17549, 0.483397, 1.0], [0.278012, 0.180367, 0.486697, 1.0], [0.277134, 0.185228, 0.489898, 1.0], [0.276194, 0.190074, 0.493001, 1.0], [0.275191, 0.194905, 0.496005, 1.0], [0.274128, 0.199721, 0.498911, 1.0], [0.273006, 0.20452, 0.501721, 1.0], [0.271828, 0.209303, 0.504434, 1.0], [0.270595, 0.214069, 0.507052, 1.0], [0.269308, 0.218818, 0.509577, 1.0], [0.267968, 0.223549, 0.512008, 1.0], [0.26658, 0.228262, 0.514349, 1.0], [0.265145, 0.232956, 0.516599, 1.0], [0.263663, 0.237631, 0.518762, 1.0], [0.262138, 0.242286, 0.520837, 1.0], [0.260571, 0.246922, 0.522828, 1.0], [0.258965, 0.251537, 0.524736, 1.0], [0.257322, 0.25613, 0.526563, 1.0], [0.255645, 0.260703, 0.528312, 1.0], [0.253935, 0.265254, 0.529983, 1.0], [0.252194, 0.269783, 0.531579, 1.0], [0.250425, 0.27429, 0.533103, 1.0], [0.248629, 0.278775, 0.534556, 1.0], [0.246811, 0.283237, 0.535941, 1.0], [0.244972, 0.287675, 0.53726, 1.0], [0.243113, 0.292092, 0.538516, 1.0], [0.241237, 0.296485, 0.539709, 1.0], [0.239346, 0.300855, 0.540844, 1.0], [0.237441, 0.305202, 0.541921, 1.0], [0.235526, 0.309527, 0.542944, 1.0], [0.233603, 0.313828, 0.543914, 1.0], [0.231674, 0.318106, 0.544834, 1.0], [0.229739, 0.322361, 0.545706, 1.0], [0.227802, 0.326594, 0.546532, 1.0], [0.225863, 0.330805, 0.547314, 1.0], [0.223925, 0.334994, 0.548053, 1.0], [0.221989, 0.339161, 0.548752, 1.0], [0.220057, 0.343307, 0.549413, 1.0], [0.21813, 0.347432, 0.550038, 1.0], [0.21621, 0.351535, 0.550627, 1.0], [0.214298, 0.355619, 0.551184, 1.0], [0.212395, 0.359683, 0.55171, 1.0], [0.210503, 0.363727, 0.552206, 1.0], [0.208623, 0.367752, 0.552675, 1.0], [0.206756, 0.371758, 0.553117, 1.0], [0.204903, 0.375746, 0.553533, 1.0], [0.203063, 0.379716, 0.553925, 1.0], [0.201239, 0.38367, 0.554294, 1.0], [0.19943, 0.387607, 0.554642, 1.0], [0.197636, 0.391528, 0.554969, 1.0], [0.19586, 0.395433, 0.555276, 1.0], [0.1941, 0.399323, 0.555565, 1.0], [0.192357, 0.403199, 0.555836, 1.0], [0.190631, 0.407061, 0.556089, 1.0], [0.188923, 0.41091, 0.556326, 1.0], [0.187231, 0.414746, 0.556547, 1.0], [0.185556, 0.41857, 0.556753, 1.0], [0.183898, 0.422383, 0.556944, 1.0], [0.182256, 0.426184, 0.55712, 1.0], [0.180629, 0.429975, 0.557282, 1.0], [0.179019, 0.433756, 0.55743, 1.0], [0.177423, 0.437527, 0.557565, 1.0], [0.175841, 0.44129, 0.557685, 1.0], [0.174274, 0.445044, 0.557792, 1.0], [0.172719, 0.448791, 0.557885, 1.0], [0.171176, 0.45253, 0.557965, 1.0], [0.169646, 0.456262, 0.55803, 1.0], [0.168126, 0.459988, 0.558082, 1.0], [0.166617, 0.463708, 0.558119, 1.0], [0.165117, 0.467423, 0.558141, 1.0], [0.163625, 0.471133, 0.558148, 1.0], [0.162142, 0.474838, 0.55814, 1.0], [0.160665, 0.47854, 0.558115, 1.0], [0.159194, 0.482237, 0.558073, 1.0], [0.157729, 0.485932, 0.558013, 1.0], [0.15627, 0.489624, 0.557936, 1.0], [0.154815, 0.493313, 0.55784, 1.0], [0.153364, 0.497, 0.557724, 1.0], [0.151918, 0.500685, 0.557587, 1.0], [0.150476, 0.504369, 0.55743, 1.0], [0.149039, 0.508051, 0.55725, 1.0], [0.147607, 0.511733, 0.557049, 1.0], [0.14618, 0.515413, 0.556823, 1.0], [0.144759, 0.519093, 0.556572, 1.0], [0.143343, 0.522773, 0.556295, 1.0], [0.141935, 0.526453, 0.555991, 1.0], [0.140536, 0.530132, 0.555659, 1.0], [0.139147, 0.533812, 0.555298, 1.0], [0.13777, 0.537492, 0.554906, 1.0], [0.136408, 0.541173, 0.554483, 1.0], [0.135066, 0.544853, 0.554029, 1.0], [0.133743, 0.548535, 0.553541, 1.0], [0.132444, 0.552216, 0.553018, 1.0], [0.131172, 0.555899, 0.552459, 1.0], [0.129933, 0.559582, 0.551864, 1.0], [0.128729, 0.563265, 0.551229, 1.0], [0.127568, 0.566949, 0.550556, 1.0], [0.126453, 0.570633, 0.549841, 1.0], [0.125394, 0.574318, 0.549086, 1.0], [0.124395, 0.578002, 0.548287, 1.0], [0.123463, 0.581687, 0.547445, 1.0], [0.122606, 0.585371, 0.546557, 1.0], [0.121831, 0.589055, 0.545623, 1.0], [0.121148, 0.592739, 0.544641, 1.0], [0.120565, 0.596422, 0.543611, 1.0], [0.120092, 0.600104, 0.54253, 1.0], [0.119738, 0.603785, 0.5414, 1.0], [0.119512, 0.607464, 0.540218, 1.0], [0.119423, 0.611141, 0.538982, 1.0], [0.119483, 0.614817, 0.537692, 1.0], [0.119699, 0.61849, 0.536347, 1.0], [0.120081, 0.622161, 0.534946, 1.0], [0.120638, 0.625828, 0.533488, 1.0], [0.12138, 0.629492, 0.531973, 1.0], [0.122312, 0.633153, 0.530398, 1.0], [0.123444, 0.636809, 0.528763, 1.0], [0.12478, 0.640461, 0.527068, 1.0], [0.126326, 0.644107, 0.525311, 1.0], [0.128087, 0.647749, 0.523491, 1.0], [0.130067, 0.651384, 0.521608, 1.0], [0.132268, 0.655014, 0.519661, 1.0], [0.134692, 0.658636, 0.517649, 1.0], [0.137339, 0.662252, 0.515571, 1.0], [0.14021, 0.665859, 0.513427, 1.0], [0.143303, 0.669459, 0.511215, 1.0], [0.146616, 0.67305, 0.508936, 1.0], [0.150148, 0.676631, 0.506589, 1.0], [0.153894, 0.680203, 0.504172, 1.0], [0.157851, 0.683765, 0.501686, 1.0], [0.162016, 0.687316, 0.499129, 1.0], [0.166383, 0.690856, 0.496502, 1.0], [0.170948, 0.694384, 0.493803, 1.0], [0.175707, 0.6979, 0.491033, 1.0], [0.180653, 0.701402, 0.488189, 1.0], [0.185783, 0.704891, 0.485273, 1.0], [0.19109, 0.708366, 0.482284, 1.0], [0.196571, 0.711827, 0.479221, 1.0], [0.202219, 0.715272, 0.476084, 1.0], [0.20803, 0.718701, 0.472873, 1.0], [0.214, 0.722114, 0.469588, 1.0], [0.220124, 0.725509, 0.466226, 1.0], [0.226397, 0.728888, 0.462789, 1.0], [0.232815, 0.732247, 0.459277, 1.0], [0.239374, 0.735588, 0.455688, 1.0], [0.24607, 0.73891, 0.452024, 1.0], [0.252899, 0.742211, 0.448284, 1.0], [0.259857, 0.745492, 0.444467, 1.0], [0.266941, 0.748751, 0.440573, 1.0], [0.274149, 0.751988, 0.436601, 1.0], [0.281477, 0.755203, 0.432552, 1.0], [0.288921, 0.758394, 0.428426, 1.0], [0.296479, 0.761561, 0.424223, 1.0], [0.304148, 0.764704, 0.419943, 1.0], [0.311925, 0.767822, 0.415586, 1.0], [0.319809, 0.770914, 0.411152, 1.0], [0.327796, 0.77398, 0.40664, 1.0], [0.335885, 0.777018, 0.402049, 1.0], [0.344074, 0.780029, 0.397381, 1.0], [0.35236, 0.783011, 0.392636, 1.0], [0.360741, 0.785964, 0.387814, 1.0], [0.369214, 0.788888, 0.382914, 1.0], [0.377779, 0.791781, 0.377939, 1.0], [0.386433, 0.794644, 0.372886, 1.0], [0.395174, 0.797475, 0.367757, 1.0], [0.404001, 0.800275, 0.362552, 1.0], [0.412913, 0.803041, 0.357269, 1.0], [0.421908, 0.805774, 0.35191, 1.0], [0.430983, 0.808473, 0.346476, 1.0], [0.440137, 0.811138, 0.340967, 1.0], [0.449368, 0.813768, 0.335384, 1.0], [0.458674, 0.816363, 0.329727, 1.0], [0.468053, 0.818921, 0.323998, 1.0], [0.477504, 0.821444, 0.318195, 1.0], [0.487026, 0.823929, 0.312321, 1.0], [0.496615, 0.826376, 0.306377, 1.0], [0.506271, 0.828786, 0.300362, 1.0], [0.515992, 0.831158, 0.294279, 1.0], [0.525776, 0.833491, 0.288127, 1.0], [0.535621, 0.835785, 0.281908, 1.0], [0.545524, 0.838039, 0.275626, 1.0], [0.555484, 0.840254, 0.269281, 1.0], [0.565498, 0.84243, 0.262877, 1.0], [0.575563, 0.844566, 0.256415, 1.0], [0.585678, 0.846661, 0.249897, 1.0], [0.595839, 0.848717, 0.243329, 1.0], [0.606045, 0.850733, 0.236712, 1.0], [0.616293, 0.852709, 0.230052, 1.0], [0.626579, 0.854645, 0.223353, 1.0], [0.636902, 0.856542, 0.21662, 1.0], [0.647257, 0.8584, 0.209861, 1.0], [0.657642, 0.860219, 0.203082, 1.0], [0.668054, 0.861999, 0.196293, 1.0], [0.678489, 0.863742, 0.189503, 1.0], [0.688944, 0.865448, 0.182725, 1.0], [0.699415, 0.867117, 0.175971, 1.0], [0.709898, 0.868751, 0.169257, 1.0], [0.720391, 0.87035, 0.162603, 1.0], [0.730889, 0.871916, 0.156029, 1.0], [0.741388, 0.873449, 0.149561, 1.0], [0.751884, 0.874951, 0.143228, 1.0], [0.762373, 0.876424, 0.137064, 1.0], [0.772852, 0.877868, 0.131109, 1.0], [0.783315, 0.879285, 0.125405, 1.0], [0.79376, 0.880678, 0.120005, 1.0], [0.804182, 0.882046, 0.114965, 1.0], [0.814576, 0.883393, 0.110347, 1.0], [0.82494, 0.88472, 0.106217, 1.0], [0.83527, 0.886029, 0.102646, 1.0], [0.845561, 0.887322, 0.099702, 1.0], [0.85581, 0.888601, 0.097452, 1.0], [0.866013, 0.889868, 0.095953, 1.0], [0.876168, 0.891125, 0.09525, 1.0], [0.886271, 0.892374, 0.095374, 1.0], [0.89632, 0.893616, 0.096335, 1.0], [0.906311, 0.894855, 0.098125, 1.0], [0.916242, 0.896091, 0.100717, 1.0], [0.926106, 0.89733, 0.104071, 1.0], [0.935904, 0.89857, 0.108131, 1.0], [0.945636, 0.899815, 0.112838, 1.0], [0.9553, 0.901065, 0.118128, 1.0], [0.964894, 0.902323, 0.123941, 1.0], [0.974417, 0.90359, 0.130215, 1.0], [0.983868, 0.904867, 0.136897, 1.0], [0.993248, 0.906157, 0.143936, 1.0]], "colormap_name": "viridis"}, "physics_type": "solid_mechanics", "field_info": {}, "is_transient": false, "time_steps": [], "time_series": [], "time_stepping": {}, "initial_conditions": {}};

// Debug: Log mesh data to verify deformed coordinates
console.log('Mesh data loaded:', {
	vertices_count: meshData.vertices ? meshData.vertices.length : 0,
	faces_count: meshData.faces ? meshData.faces.length : 0,
	first_vertex: meshData.vertices ? meshData.vertices[0] : null,
	physics_type: fieldData.physics_type || 'unknown'
});

const settings = {"colormap": "viridis", "opacity": 0.8, "show_colorbar": true, "background_color": [0.1, 0.1, 0.1]};

const isTransient = fieldData.is_transient === true;
const timeSeries = Array.isArray(fieldData.time_series)
	? fieldData.time_series
	: (Array.isArray(fieldData.solutions) ? fieldData.solutions : []);
const rawTimeSteps = Array.isArray(fieldData.time_steps) ? fieldData.time_steps : [];
const timeSteps = rawTimeSteps.length === timeSeries.length
	? rawTimeSteps
	: timeSeries.map((snapshot, index) => {
		if (snapshot && typeof snapshot.time === 'number') {
			return snapshot.time;
		}
		return index;
	});
// Initialize to first frame (t=0) for transient solutions, not the last frame
let currentTimeIndex = 0;
let isPlaying = false;
let playbackInterval = null;
let playbackSpeed = 1.0;
let loopPlayback = false;

// VTK.js setup
let renderWindow, renderer, actor;
let fieldMin, fieldMax, fieldMean;
let globalFieldMin, globalFieldMax; // Global min/max for transient solutions (fixed colorbar range)
let currentColormap = 'viridis';
let meshDimension = 1; // Default to 1D, will be updated based on mesh data
let currentViewMode = 'all'; // 'all', 'surface', 'volume'

function hideControlsFor1DMesh() {
	// Check if this is a 1D mesh
	if (meshData.cells && Array.isArray(meshData.cells) && meshData.cells.length > 0) {
		
		// Hide any surface/volume controls that might exist
		const surfaceControls = document.querySelectorAll('[id*="surface"], [id*="volume"], [class*="surface"], [class*="volume"]');
		surfaceControls.forEach(control => {
			control.style.display = 'none';
		});
		
		// Hide surface option in representation dropdown for 1D meshes
		const surfaceOption = document.getElementById('surface-option');
		if (surfaceOption) {
			surfaceOption.style.display = 'none';
		}
	}
}

function init() {
	// Calculate global min/max from all available data (transient frames + steady-state)
	// This ensures a fixed colorbar range for all frames (both transient and steady-state)
	if (isTransient && Array.isArray(timeSeries) && timeSeries.length > 0) {
		let minVal = Infinity;
		let maxVal = -Infinity;
		
		// Find min/max across all transient frames
		for (const snapshot of timeSeries) {
			if (snapshot && Array.isArray(snapshot.values) && snapshot.values.length > 0) {
				const frameMin = Math.min(...snapshot.values);
				const frameMax = Math.max(...snapshot.values);
				minVal = Math.min(minVal, frameMin);
				maxVal = Math.max(maxVal, frameMax);
			}
		}
		
		// Also include steady-state solution if available
		const timeStepping = fieldData.time_stepping || {};
		const steadyState = timeStepping.steady_state_solution;
		if (steadyState && Array.isArray(steadyState.values) && steadyState.values.length > 0) {
			const ssMin = Math.min(...steadyState.values);
			const ssMax = Math.max(...steadyState.values);
			minVal = Math.min(minVal, ssMin);
			maxVal = Math.max(maxVal, ssMax);
		}
		
		// Set global range if we found valid values
		if (isFinite(minVal) && isFinite(maxVal)) {
			globalFieldMin = minVal;
			globalFieldMax = maxVal;
			console.log('Calculated global min/max from all frames (transient + steady-state):', globalFieldMin, globalFieldMax);
		}
		// Fallback: Use fieldData min/max if available
		else if (typeof fieldData.min_value === 'number' && typeof fieldData.max_value === 'number') {
			globalFieldMin = fieldData.min_value;
			globalFieldMax = fieldData.max_value;
			console.log('Using fieldData min/max as global range:', globalFieldMin, globalFieldMax);
		}
	}

	// Calculate field statistics
	calculateFieldStats();

	// Hide inappropriate controls for 1D meshes
	hideControlsFor1DMesh();

	// Create render window and attach to VTK container (like mesh visualization)
	window.vtkContainer = document.getElementById('vtk-container');
	const mainContainer = document.getElementById('container');
	renderWindow = vtk.Rendering.Core.vtkRenderWindow.newInstance();
	
	// Create OpenGL render window and attach to VTK container only
	const openGLRenderWindow = vtk.Rendering.OpenGL.vtkRenderWindow.newInstance();
	openGLRenderWindow.setContainer(window.vtkContainer);
	
	// Enable high-quality rendering (using supported methods)
	openGLRenderWindow.setUseOffScreen(false);
	openGLRenderWindow.setSize(window.vtkContainer.clientWidth, window.vtkContainer.clientHeight);
	
	
	renderWindow.addView(openGLRenderWindow);

	// Create renderer
	renderer = vtk.Rendering.Core.vtkRenderer.newInstance();
	renderWindow.addRenderer(renderer);


	// Create interactor with mouse controls - bind only to VTK container
	const interactor = vtk.Rendering.Core.vtkRenderWindowInteractor.newInstance();
	interactor.setView(openGLRenderWindow);
	interactor.initialize();
	interactor.bindEvents(window.vtkContainer);
	
	// Set up mouse controls
	interactor.setInteractorStyle(vtk.Interaction.Style.vtkInteractorStyleTrackballCamera.newInstance());
	

	// For transient solutions, apply the first frame (t=0) before creating the field mesh
	if (isTransient && Array.isArray(timeSeries) && timeSeries.length > 0) {
		// Ensure we're at the first frame (t=0)
		currentTimeIndex = 0;
		const firstSnapshot = timeSeries[0];
		if (firstSnapshot && Array.isArray(firstSnapshot.values)) {
			// Apply the first frame's values
			fieldData.values = firstSnapshot.values.slice();
			
			// Update field statistics from first snapshot
			if (typeof firstSnapshot.min_value === 'number' && typeof firstSnapshot.max_value === 'number' && typeof firstSnapshot.mean_value === 'number') {
				// Always use global min/max for colorbar (calculated from all frames)
				if (typeof globalFieldMin === 'number' && typeof globalFieldMax === 'number') {
					fieldMin = globalFieldMin;
					fieldMax = globalFieldMax;
				} else {
					// Fallback if global range not set
					fieldMin = firstSnapshot.min_value;
					fieldMax = firstSnapshot.max_value;
				}
				fieldMean = firstSnapshot.mean_value;
			} else {
				calculateFieldStats(fieldData.values);
				// Use global range for colorbar if available
				if (typeof globalFieldMin === 'number' && typeof globalFieldMax === 'number') {
					fieldMin = globalFieldMin;
					fieldMax = globalFieldMax;
				}
			}
		}
	}

	// Create field mesh
	createFieldMesh('all');

	// Setup controls
	setupControls();
	
	// Ensure view controls are shown for 3D meshes (check after createFieldMesh sets meshDimension)
	// This will be handled in createFieldMesh, but we also check here as backup
	const viewControls = document.getElementById('view-controls');
	if (viewControls && typeof meshDimension !== 'undefined' && meshDimension === 3) {
		viewControls.style.display = 'flex';
		updateViewButtonStates();
	}

	// Update info
	updateInfo();

	// Show colorbar
		showColorbar();

	// Hide loading
	document.getElementById('loading').style.display = 'none';

	// Start animation
	renderWindow.render();
}

function createMeshOnly() {
	
	// Determine mesh dimension based on data (same logic as createFieldMesh)
	if (meshData.faces && meshData.faces.length > 0) {
		meshDimension = 3; // 3D mesh
	} else if (meshData.cells && typeof meshData.cells === 'object' && Object.keys(meshData.cells).length > 0) {
		// Check if we have line elements (1D mesh)
		if (meshData.cells.line_2nd || meshData.cells.line) {
			meshDimension = 1; // 1D mesh
		} else {
			meshDimension = 2; // 2D mesh
		}
	} else {
		meshDimension = 2; // Default to 2D
	}
	
	// Show/hide view controls based on mesh dimension
	const viewControls = document.getElementById('view-controls');
	if (viewControls) {
		if (meshDimension === 3) {
			viewControls.style.display = 'flex';
			updateViewButtonStates();
		} else {
			viewControls.style.display = 'none';
		}
	}
	
	// Clear existing actors from renderer
	if (renderer) {
		renderer.removeAllActors();
	}

	// Create VTK polydata
	const polydata = vtk.Common.DataModel.vtkPolyData.newInstance();
	const points = vtk.Common.Core.vtkPoints.newInstance();
	const cellArray = vtk.Common.Core.vtkCellArray.newInstance();
	const lineCellArray = vtk.Common.Core.vtkCellArray.newInstance();

	// Set vertices
	// For solid mechanics, meshData.vertices contains deformed coordinates (original + displacement)
	// For other physics types, meshData.vertices contains original coordinates
	const vertices = new Float32Array(meshData.vertices.flat());
	points.setData(vertices, 3); 
	polydata.setPoints(points);

	// Process all element types (same logic as createFieldMesh)
	let processedElements = 0;
	
	// Process volume elements (tetrahedrons) - only if viewMode allows volume elements
	if (meshData.cells && typeof meshData.cells === 'object' && (currentViewMode === 'all' || currentViewMode === 'volume')) {
    log('=== PROCESSING VOLUME ELEMENTS ===');
    log('View mode:', currentViewMode);
		if (meshData.cells.tetrahedron && meshData.cells.tetrahedron.length > 0) {
			for (let i = 0; i < meshData.cells.tetrahedron.length; i++) {
				const tetra = meshData.cells.tetrahedron[i];
				if (Array.isArray(tetra) && tetra.length === 4) {
					cellArray.insertNextCell(tetra);
					processedElements++;
				}
			}
		}
		
		if (meshData.cells.tetrahedron_2nd && meshData.cells.tetrahedron_2nd.length > 0) {
			for (let i = 0; i < meshData.cells.tetrahedron_2nd.length; i++) {
				const tetra_2nd = meshData.cells.tetrahedron_2nd[i];
				if (Array.isArray(tetra_2nd) && tetra_2nd.length === 10) {
					// Convert P2 tetrahedron to 8 P1 tetrahedrons
					cellArray.insertNextCell([tetra_2nd[0], tetra_2nd[4], tetra_2nd[6], tetra_2nd[7]]);
					cellArray.insertNextCell([tetra_2nd[4], tetra_2nd[1], tetra_2nd[5], tetra_2nd[8]]);
					cellArray.insertNextCell([tetra_2nd[6], tetra_2nd[5], tetra_2nd[2], tetra_2nd[9]]);
					cellArray.insertNextCell([tetra_2nd[7], tetra_2nd[8], tetra_2nd[9], tetra_2nd[3]]);
					cellArray.insertNextCell([tetra_2nd[4], tetra_2nd[5], tetra_2nd[6], tetra_2nd[7]]);
					cellArray.insertNextCell([tetra_2nd[4], tetra_2nd[5], tetra_2nd[8], tetra_2nd[7]]);
					cellArray.insertNextCell([tetra_2nd[5], tetra_2nd[6], tetra_2nd[9], tetra_2nd[7]]);
					cellArray.insertNextCell([tetra_2nd[4], tetra_2nd[6], tetra_2nd[8], tetra_2nd[9]]);
					processedElements += 8;
				}
			}
		}
	}
	
	// Process surface elements (triangles) - only if viewMode allows surface elements
	if (meshData.cells && typeof meshData.cells === 'object' && (currentViewMode === 'all' || currentViewMode === 'surface')) {
        log('=== PROCESSING SURFACE ELEMENTS FROM CELLS ===');
        log('View mode:', currentViewMode);
		if (meshData.cells.triangle && meshData.cells.triangle.length > 0) {
			for (let i = 0; i < meshData.cells.triangle.length; i++) {
				const triangle = meshData.cells.triangle[i];
				if (Array.isArray(triangle) && triangle.length === 3) {
					cellArray.insertNextCell(triangle);
					processedElements++;
				}
			}
		}
		
		if (meshData.cells.triangle_2nd && meshData.cells.triangle_2nd.length > 0) {
			for (let i = 0; i < meshData.cells.triangle_2nd.length; i++) {
				const triangle_2nd = meshData.cells.triangle_2nd[i];
				if (Array.isArray(triangle_2nd) && triangle_2nd.length === 6) {
					// Convert P2 triangle to 4 P1 triangles
					cellArray.insertNextCell([triangle_2nd[0], triangle_2nd[3], triangle_2nd[5]]);
					cellArray.insertNextCell([triangle_2nd[3], triangle_2nd[1], triangle_2nd[4]]);
					cellArray.insertNextCell([triangle_2nd[4], triangle_2nd[2], triangle_2nd[5]]);
					cellArray.insertNextCell([triangle_2nd[3], triangle_2nd[4], triangle_2nd[5]]);
					processedElements += 4;
				}
			}
		}
		
		if (meshData.cells.quad && meshData.cells.quad.length > 0) {
			log(`Processing ${meshData.cells.quad.length} quad elements`);
			for (let i = 0; i < meshData.cells.quad.length; i++) {
				const quad = meshData.cells.quad[i];
				if (Array.isArray(quad) && quad.length === 4) {
					// Split quad into two triangles
					cellArray.insertNextCell([quad[0], quad[1], quad[2]]);
					cellArray.insertNextCell([quad[0], quad[2], quad[3]]);
					processedElements += 2;
				}
			}
		}
	}
	
	// Process faces from meshData.faces (for 2D meshes) - only if viewMode allows surface elements
	if (meshData.faces && meshData.faces.length > 0 && (currentViewMode === 'all' || currentViewMode === 'surface')) {
	log('=== PROCESSING FACES FROM MESHDATA.FACES ===');
	log('View mode:', currentViewMode);
	log('Face cells length:', meshData.faces.length);
	log('First few elements:', meshData.faces.slice(0, 3));
		
		for (let i = 0; i < meshData.faces.length; i++) {
			const face = meshData.faces[i];
			if (Array.isArray(face) && face.length === 3) {
				// P1 triangle
				cellArray.insertNextCell(face);
				processedElements++;
			} else if (Array.isArray(face) && face.length === 6) {
				// P2 triangle - convert to 4 P1 triangles
				cellArray.insertNextCell([face[0], face[3], face[5]]);
				cellArray.insertNextCell([face[3], face[1], face[4]]);
				cellArray.insertNextCell([face[4], face[2], face[5]]);
				cellArray.insertNextCell([face[3], face[4], face[5]]);
				processedElements += 4;
			}
		}
	}
	
	// Process 1D elements (lines) - use separate cell array for lines
	let lineElements = 0;
	if (meshData.cells && typeof meshData.cells === 'object') {
		if (meshData.cells.line && meshData.cells.line.length > 0) {
			log(`Processing ${meshData.cells.line.length} line elements`);
			for (let i = 0; i < meshData.cells.line.length; i++) {
				const line = meshData.cells.line[i];
				if (Array.isArray(line) && line.length === 2) {
					lineCellArray.insertNextCell(line);
					lineElements++;
				}
			}
		}
		
		if (meshData.cells.line_2nd && meshData.cells.line_2nd.length > 0) {
			for (let i = 0; i < meshData.cells.line_2nd.length; i++) {
				const line_2nd = meshData.cells.line_2nd[i];
				if (Array.isArray(line_2nd) && line_2nd.length === 3) {
					// Convert P2 line to 2 P1 lines
					lineCellArray.insertNextCell([line_2nd[0], line_2nd[1]]);
					lineCellArray.insertNextCell([line_2nd[1], line_2nd[2]]);
					lineElements += 2;
				}
			}
		}
	}
	
	log(`Processed ${processedElements} poly elements and ${lineElements} line elements for mesh-only`);
	
	// Set the appropriate cell data based on what we have
	if (processedElements > 0) {
		polydata.setPolys(cellArray);
		log(`Set ${processedElements} poly elements for mesh-only`);
	}
	if (lineElements > 0) {
		polydata.setLines(lineCellArray);
		log(`Set ${lineElements} line elements for mesh-only`);
	}

	// Create mapper and actor (no field data)
	const mapper = vtk.Rendering.Core.vtkMapper.newInstance();
	mapper.setInputData(polydata);
	mapper.setScalarVisibility(false); // No field data to visualize
	
	actor = vtk.Rendering.Core.vtkActor.newInstance();
	actor.setMapper(mapper);

	// Set actor properties based on mesh dimension and current representation
	const actorProps = actor.getProperty();
	actorProps.setOpacity(0.8);
	
	// Get current representation from dropdown
	const representationSelect = document.getElementById('representation-select');
	const currentRepresentation = representationSelect ? parseInt(representationSelect.value) : 2;
	
	if (meshDimension === 1) {
		// 1D mesh - use thick lines
		actorProps.setColor(0.0, 1.0, 0.0); // Green color for mesh
		actorProps.setLineWidth(15); // Very thick lines
		actorProps.setRepresentation(1); // Wireframe
	} else {
		// 2D/3D mesh - use representation from dropdown
		actorProps.setColor(0.0, 1.0, 0.0); // Green color for mesh
		actorProps.setRepresentation(currentRepresentation); // Use selected representation
		
		// Set additional properties based on representation
		if (currentRepresentation === 0) {
			// Points representation
			actorProps.setPointSize(meshDimension === 2 ? 5 : 3);
		} else if (currentRepresentation === 1) {
			// Wireframe representation
			actorProps.setLineWidth(2);
			actorProps.setEdgeVisibility(true);
		} else if (currentRepresentation === 2) {
			// Surface representation
			actorProps.setOpacity(0.8);
			actorProps.setEdgeVisibility(true);
		}
	}

	// Add to renderer
	renderer.addActor(actor);

	// Reset camera to fit the mesh
	renderer.resetCamera();
	
	// Get camera for positioning
	const camera = renderer.getActiveCamera();
	
	// For 1D meshes, ensure proper camera positioning
	if (meshDimension === 1) {
		camera.setPosition(0, 0, 2); // Position camera to see the line
		camera.setFocalPoint(0.5, 0, 0); // Focus on center of line
		camera.setViewUp(0, 1, 0); // Set up direction
		renderer.resetCamera();
	}
	
	// Force render to ensure mesh is visible
	renderWindow.render();
}

function changeFieldDisplay(displayType) {
	log('Changing field display to:', displayType);
	
	// Clear all existing actors from renderer
	if (renderer) {
		renderer.removeAllActors();
		log('Cleared all actors from renderer');
	}

	if (isTransient && displayType === 'none') {
		stopPlayback();
	}
	
	if (displayType === 'none') {
		// Show mesh only
		createMeshOnly();
		// Hide field-related controls
		const colormapGroup = document.getElementById('colormap-group');
		if (colormapGroup) {
			colormapGroup.style.display = 'none';
		}
		document.getElementById('colorbar').style.display = 'none';
		document.getElementById('colorbar-labels').style.display = 'none';
	} else {
		// Show field visualization
		createFieldMesh(currentViewMode);
		// Show field-related controls
		const colormapGroup = document.getElementById('colormap-group');
		if (colormapGroup) {
			colormapGroup.style.display = 'block';
		}
		document.getElementById('colorbar').style.display = 'block';
		document.getElementById('colorbar-labels').style.display = 'block';
	}
	
	// Update button states for view controls
	updateViewButtonStates();
	
	// Render the changes
	renderWindow.render();
}

function calculateFieldStats(valuesOverride = null) {
	const values = Array.isArray(valuesOverride) ? valuesOverride : fieldData.values;
	if (!values || values.length === 0) {
		// Use global min/max if available (for both transient and steady-state)
		if (typeof globalFieldMin === 'number' && typeof globalFieldMax === 'number') {
			fieldMin = globalFieldMin;
			fieldMax = globalFieldMax;
		} else {
			fieldMin = 0;
			fieldMax = 0;
		}
		fieldMean = 0;
		return;
	}

	// Always use global min/max if available (calculated from all frames)
	// This ensures fixed colorbar range for both transient frames and steady-state
	if (typeof globalFieldMin === 'number' && typeof globalFieldMax === 'number') {
		fieldMin = globalFieldMin;
		fieldMax = globalFieldMax;
	} else {
		// Calculate from current values (fallback if global range not set)
		fieldMin = Math.min(...values);
		fieldMax = Math.max(...values);
		
		// For transient solutions, store calculated range as global if not already set
		if (isTransient && (typeof globalFieldMin !== 'number' || typeof globalFieldMax !== 'number')) {
			globalFieldMin = fieldMin;
			globalFieldMax = fieldMax;
		}
	}
	fieldMean = values.reduce((a, b) => a + b, 0) / values.length;
}

function initializeTimeControls() {
	const timeControls = document.getElementById('time-controls');
	if (!isTransient || !timeControls) {
		return;
	}

	if (!Array.isArray(timeSeries) || timeSeries.length === 0 || !Array.isArray(timeSeries[0].values)) {
		console.warn('Transient mode enabled but no time-series data available.');
		return;
	}

	timeControls.style.display = 'block';

	const slider = document.getElementById('time-slider');
	if (slider) {
		slider.max = timeSeries.length - 1;
	}
	
	// Show/hide steady-state button based on availability
	const steadyStateBtn = document.getElementById('steady-state-btn');
	if (steadyStateBtn) {
		const timeStepping = fieldData.time_stepping || {};
		const steadyState = timeStepping.steady_state_solution;
		if (steadyState && Array.isArray(steadyState.values)) {
			steadyStateBtn.style.display = 'block';
		} else {
			steadyStateBtn.style.display = 'none';
		}
	}

	currentTimeIndex = Math.min(Math.max(0, currentTimeIndex), timeSeries.length - 1);

		const snapshot = timeSeries[currentTimeIndex];
		if (snapshot && Array.isArray(snapshot.values)) {
			const needsUpdate =
				!Array.isArray(fieldData.values) ||
				fieldData.values.length !== snapshot.values.length;
			if (needsUpdate) {
				applyTimeStep(currentTimeIndex, { force: true, skipSlider: true });
			} else {
				if (typeof snapshot.min_value === 'number' && typeof snapshot.max_value === 'number' && typeof snapshot.mean_value === 'number') {
					// Always use global min/max for colorbar (calculated from all frames)
					// This ensures fixed colorbar range for both transient frames and steady-state
					if (typeof globalFieldMin === 'number' && typeof globalFieldMax === 'number') {
						fieldMin = globalFieldMin;
						fieldMax = globalFieldMax;
					} else {
						// Fallback if global range not available
						fieldMin = snapshot.min_value;
						fieldMax = snapshot.max_value;
					}
					fieldMean = snapshot.mean_value;
				} else {
					calculateFieldStats(snapshot.values);
				}
				updateInfo();
				updateTimeDisplay(currentTimeIndex, { skipSlider: true });
			}
		}

	updatePlayButton();

	const playButton = document.getElementById('play-pause-btn');
	if (playButton && timeSeries.length <= 1) {
		playButton.disabled = true;
		playButton.classList.add('disabled');
	}
}

function applyTimeStep(index, options = {}) {
	if (!isTransient || !Array.isArray(timeSeries) || timeSeries.length === 0) {
		return false;
	}

	let targetIndex = Number(index);
	if (!Number.isFinite(targetIndex)) {
		targetIndex = 0;
	}

	targetIndex = Math.max(0, Math.min(timeSeries.length - 1, targetIndex));

	if (!options.force && targetIndex === currentTimeIndex) {
		updateTimeDisplay(targetIndex, { skipSlider: options.skipSlider });
		return true;
	}

	const snapshot = timeSeries[targetIndex];
	if (!snapshot || !Array.isArray(snapshot.values)) {
		console.warn('Missing time-step snapshot values for index', targetIndex);
		return false;
	}

	currentTimeIndex = targetIndex;
	fieldData.values = snapshot.values.slice();

	if (typeof snapshot.min_value === 'number' && typeof snapshot.max_value === 'number' && typeof snapshot.mean_value === 'number') {
		// Always use global min/max for colorbar (calculated from all frames)
		// This ensures fixed colorbar range for both transient frames and steady-state
		if (typeof globalFieldMin === 'number' && typeof globalFieldMax === 'number') {
			fieldMin = globalFieldMin;
			fieldMax = globalFieldMax;
		} else {
			// Fallback if global range not available
			fieldMin = snapshot.min_value;
			fieldMax = snapshot.max_value;
		}
		fieldMean = snapshot.mean_value;
	} else {
		calculateFieldStats(fieldData.values);
	}

	updateInfo();
	createFieldMesh(currentViewMode);
	updateTimeDisplay(targetIndex, { skipSlider: options.skipSlider });

	return true;
}

function updateTimeDisplay(index, options = {}) {
	const slider = document.getElementById('time-slider');
	if (slider && !options.skipSlider) {
		slider.value = index;
	}

	const timeLabel = document.getElementById('time-display');
	if (timeLabel) {
		const timeValue = timeSteps[index] !== undefined ? timeSteps[index] :
			(timeSeries[index] && typeof timeSeries[index].time === 'number' ? timeSeries[index].time : index);
		const numericTime = Number(timeValue);
		const formatted = Number.isFinite(numericTime) ? numericTime.toFixed(3) : String(timeValue);
		timeLabel.textContent = `t = ${formatted} s`;
	}
}

function updatePlayButton() {
	const playButton = document.getElementById('play-pause-btn');
	if (!playButton) {
		return;
	}
	playButton.textContent = isPlaying ? 'Pause' : 'Play';
}

function startPlayback() {
	if (!isTransient || isPlaying || !Array.isArray(timeSeries) || timeSeries.length <= 1) {
		return;
	}

	isPlaying = true;
	updatePlayButton();

	const baseIntervalMs = 100;  // Reduced from 1000ms to 100ms for faster playback
	const intervalMs = Math.max(20, baseIntervalMs / playbackSpeed);  // Minimum 20ms instead of 50ms

	playbackInterval = setInterval(() => {
		const advanced = stepForward({ fromPlayback: true });
		if (!advanced) {
			if (loopPlayback) {
				applyTimeStep(0, { force: true });
			} else {
				stopPlayback();
			}
		}
	}, intervalMs);
}

function stopPlayback() {
	if (playbackInterval) {
		clearInterval(playbackInterval);
		playbackInterval = null;
	}
	if (isPlaying) {
		isPlaying = false;
		updatePlayButton();
	}
}

function togglePlayback() {
	if (isPlaying) {
		stopPlayback();
	} else {
		startPlayback();
	}
}

function onTimeSliderChange(value) {
	stopPlayback();
	applyTimeStep(parseInt(value, 10));
}

function updatePlaybackSpeed(value) {
	const parsed = parseFloat(value);
	if (!Number.isFinite(parsed) || parsed <= 0) {
		return;
	}
	playbackSpeed = parsed;
	if (isPlaying) {
		stopPlayback();
		startPlayback();
	}
}

function toggleLoop(checked) {
	loopPlayback = !!checked;
}

function stepForward(options = {}) {
	if (!isTransient || !Array.isArray(timeSeries) || timeSeries.length === 0) {
		return false;
	}

	if (!options.fromPlayback) {
		stopPlayback();
	}

	let nextIndex = currentTimeIndex + 1;
	if (nextIndex >= timeSeries.length) {
		if (loopPlayback || options.wrap) {
			nextIndex = 0;
		} else {
			return false;
		}
	}

	return applyTimeStep(nextIndex);
}

function stepBackward() {
	if (!isTransient || !Array.isArray(timeSeries) || timeSeries.length === 0) {
		return false;
	}

	stopPlayback();

	let prevIndex = currentTimeIndex - 1;
	if (prevIndex < 0) {
		prevIndex = loopPlayback ? timeSeries.length - 1 : 0;
	}

	return applyTimeStep(prevIndex);
}

function showSteadyState() {
	// Get steady-state solution from time_stepping data
	const timeStepping = fieldData.time_stepping || {};
	const steadyState = timeStepping.steady_state_solution;
	
	if (!steadyState || !Array.isArray(steadyState.values)) {
		console.warn('Steady-state solution not available');
		alert('Steady-state solution not available. It may not have been computed or the simulation may not have converged.');
		return;
	}
	
	// Apply steady-state solution to field data
	fieldData.values = steadyState.values.slice();
	
	// Update field statistics
	// Always use global min/max for colorbar (calculated from all frames)
	if (typeof globalFieldMin === 'number' && typeof globalFieldMax === 'number') {
		fieldMin = globalFieldMin;
		fieldMax = globalFieldMax;
		if (typeof steadyState.mean_value === 'number') {
			fieldMean = steadyState.mean_value;
		} else {
			calculateFieldStats(fieldData.values);
			// Re-apply global range after calculating (mean might have changed)
			if (typeof globalFieldMin === 'number' && typeof globalFieldMax === 'number') {
				fieldMin = globalFieldMin;
				fieldMax = globalFieldMax;
			}
		}
	} else {
		// Fallback: use steady-state min/max if global not available
		if (typeof steadyState.min_value === 'number' && typeof steadyState.max_value === 'number' && typeof steadyState.mean_value === 'number') {
			fieldMin = steadyState.min_value;
			fieldMax = steadyState.max_value;
			fieldMean = steadyState.mean_value;
		} else {
			calculateFieldStats(fieldData.values);
		}
	}
	
	// Update display
	updateInfo();
	createFieldMesh(currentViewMode);
	
	// Update time display to show "Steady-State"
	const timeDisplay = document.getElementById('time-display');
	if (timeDisplay) {
		timeDisplay.textContent = 't =  (Steady-State)';
	}
	
	// Disable time slider and controls while showing steady-state
	const slider = document.getElementById('time-slider');
	if (slider) {
		slider.disabled = true;
	}
	
	// Update button text
	const btn = document.getElementById('steady-state-btn');
	if (btn) {
		btn.textContent = 'Show Transient';
		btn.onclick = showTransient;
	}
	
	console.log('Displaying steady-state solution');
}

function showTransient() {
	// Restore transient view
	if (!isTransient || !Array.isArray(timeSeries) || timeSeries.length === 0) {
		return;
	}
	
	// Re-enable time slider
	const slider = document.getElementById('time-slider');
	if (slider) {
		slider.disabled = false;
	}
	
	// Restore current time step
	applyTimeStep(currentTimeIndex, { force: true });
	
	// Update button text
	const btn = document.getElementById('steady-state-btn');
	if (btn) {
		btn.textContent = 'Show Steady-State';
		btn.onclick = showSteadyState;
	}
}

function createFieldMesh(viewMode = 'all', representation = null) {
	
	// Update current view mode
	currentViewMode = viewMode;
	
	// Processing mesh data

	// Determine mesh dimension based on data
	// Check for 3D volume elements first (tetrahedrons)
	if (meshData.cells && typeof meshData.cells === 'object') {
		if (meshData.cells.tetrahedron || meshData.cells.tetrahedron_2nd) {
			meshDimension = 3; // 3D mesh with volume elements
		} else if (meshData.cells.line_2nd || meshData.cells.line) {
			meshDimension = 1; // 1D mesh
		} else if (meshData.cells.triangle || meshData.cells.triangle_2nd || meshData.cells.quad) {
			meshDimension = 2; // 2D mesh
		}
	}
	// Also check for faces (surface elements) - indicates 3D mesh
	if (meshData.faces && meshData.faces.length > 0) {
		meshDimension = 3; // 3D mesh (has surface faces)
	}
	// Default fallback
	if (typeof meshDimension === 'undefined') {
		meshDimension = 2; // Default to 2D
	}
	
	// Show/hide view controls based on mesh dimension
	const viewControls = document.getElementById('view-controls');
	if (viewControls) {
		if (meshDimension === 3) {
			viewControls.style.display = 'flex'; // Use flex to show buttons side by side
			// Update button states when controls are shown
			updateViewButtonStates();
		} else {
			viewControls.style.display = 'none';
		}
	}
	
	// Clear existing actors from renderer
	if (renderer) {
		renderer.removeAllActors();
	}
	
	if (!meshData.vertices || meshData.vertices.length === 0) {
		console.error('No mesh data available');
		throw new Error('No mesh data available');
	}

	// Create VTK polydata
	const polydata = vtk.Common.DataModel.vtkPolyData.newInstance();
	const points = vtk.Common.Core.vtkPoints.newInstance();
	const cellArray = vtk.Common.Core.vtkCellArray.newInstance();
	const lineCellArray = vtk.Common.Core.vtkCellArray.newInstance();

	// Set vertices
	// For solid mechanics, meshData.vertices contains deformed coordinates (original + displacement)
	// For other physics types, meshData.vertices contains original coordinates
	const vertices = new Float32Array(meshData.vertices.flat());
	
	// Debug: Log vertex data for solid mechanics
	if (fieldData.physics_type === 'solid_mechanics') {
		console.log('Solid mechanics visualization - using vertices:', {
			vertex_count: vertices.length / 3,
			first_vertex: [vertices[0], vertices[1], vertices[2]],
			vertex_range: {
				x: [Math.min(...Array.from(vertices.filter((_, i) => i % 3 === 0))), Math.max(...Array.from(vertices.filter((_, i) => i % 3 === 0)))],
				y: [Math.min(...Array.from(vertices.filter((_, i) => i % 3 === 1))), Math.max(...Array.from(vertices.filter((_, i) => i % 3 === 1)))],
				z: [Math.min(...Array.from(vertices.filter((_, i) => i % 3 === 2))), Math.max(...Array.from(vertices.filter((_, i) => i % 3 === 2)))]
			}
		});
	}
	
	points.setData(vertices, 3); 
	polydata.setPoints(points);
	
	

	// Set mesh connectivity - filter elements based on viewMode
	let processedElements = 0;
	
	// Process volume elements (3D meshes) - only for volume view or all view
	if (meshData.cells && typeof meshData.cells === 'object' && meshDimension === 3 && (viewMode === 'all' || viewMode === 'volume')) {
		log(`Processing volume elements for viewMode: ${viewMode}`);
	// Process volume elements
		
		// Process tetrahedron elements
		if (meshData.cells.tetrahedron && meshData.cells.tetrahedron.length > 0) {
			for (let i = 0; i < meshData.cells.tetrahedron.length; i++) {
				const tetra = meshData.cells.tetrahedron[i];
				if (Array.isArray(tetra) && tetra.length === 4) {
					cellArray.insertNextCell(tetra);
					processedElements++;
				}
			}
		}
		
		// Process second-order tetrahedron elements
		if (meshData.cells.tetrahedron_2nd && meshData.cells.tetrahedron_2nd.length > 0) {
			for (let i = 0; i < meshData.cells.tetrahedron_2nd.length; i++) {
				const tetra_2nd = meshData.cells.tetrahedron_2nd[i];
				if (Array.isArray(tetra_2nd) && tetra_2nd.length === 10) {
					// Convert P2 tetrahedron to 8 P1 tetrahedrons (like mesh preview)
					cellArray.insertNextCell([tetra_2nd[0], tetra_2nd[4], tetra_2nd[6], tetra_2nd[7]]);
					cellArray.insertNextCell([tetra_2nd[4], tetra_2nd[1], tetra_2nd[5], tetra_2nd[8]]);
					cellArray.insertNextCell([tetra_2nd[6], tetra_2nd[5], tetra_2nd[2], tetra_2nd[9]]);
					cellArray.insertNextCell([tetra_2nd[7], tetra_2nd[8], tetra_2nd[9], tetra_2nd[3]]);
					cellArray.insertNextCell([tetra_2nd[0], tetra_2nd[4], tetra_2nd[7], tetra_2nd[6]]);
					cellArray.insertNextCell([tetra_2nd[4], tetra_2nd[1], tetra_2nd[8], tetra_2nd[5]]);
					cellArray.insertNextCell([tetra_2nd[6], tetra_2nd[5], tetra_2nd[9], tetra_2nd[7]]);
					cellArray.insertNextCell([tetra_2nd[7], tetra_2nd[8], tetra_2nd[4], tetra_2nd[6]]);
					processedElements += 8;
				}
			}
		}
	}
	
	// Process surface elements (faces) - only for surface view or all view
	if ((viewMode === 'all' || viewMode === 'surface') && 
		((meshData.cells && typeof meshData.cells === 'object') || 
		(meshData.faces && meshData.faces.length > 0))) {
		log(`Processing surface elements for viewMode: ${viewMode}`);
	// Process surface elements
		
		// Process surface elements from cells dictionary
		if (meshData.cells && typeof meshData.cells === 'object') {
			// Process triangle elements
			if (meshData.cells.triangle && meshData.cells.triangle.length > 0) {
				for (let i = 0; i < meshData.cells.triangle.length; i++) {
					const triangle = meshData.cells.triangle[i];
					if (Array.isArray(triangle) && triangle.length === 3) {
						cellArray.insertNextCell(triangle);
						processedElements++;
					}
				}
			}
			
			// Process second-order triangle elements
			if (meshData.cells.triangle_2nd && meshData.cells.triangle_2nd.length > 0) {
				for (let i = 0; i < meshData.cells.triangle_2nd.length; i++) {
					const triangle_2nd = meshData.cells.triangle_2nd[i];
					if (Array.isArray(triangle_2nd) && triangle_2nd.length === 6) {
						// Convert P2 triangle to 4 P1 triangles (like mesh preview)
						cellArray.insertNextCell([triangle_2nd[0], triangle_2nd[3], triangle_2nd[5]]);
						cellArray.insertNextCell([triangle_2nd[3], triangle_2nd[1], triangle_2nd[4]]);
						cellArray.insertNextCell([triangle_2nd[4], triangle_2nd[2], triangle_2nd[5]]);
						cellArray.insertNextCell([triangle_2nd[3], triangle_2nd[4], triangle_2nd[5]]);
						processedElements += 4;
					}
				}
			}
			
			// Process quad elements
			if (meshData.cells.quad && meshData.cells.quad.length > 0) {
				for (let i = 0; i < meshData.cells.quad.length; i++) {
					const quad = meshData.cells.quad[i];
					if (Array.isArray(quad) && quad.length === 4) {
						// Split quad into two triangles
						cellArray.insertNextCell([quad[0], quad[1], quad[2]]);
						cellArray.insertNextCell([quad[0], quad[2], quad[3]]);
						processedElements += 2;
					}
				}
			}
		}
		
		// Process faces from meshData.faces (for 2D meshes) - only if viewMode allows surface elements
	if (meshData.faces && meshData.faces.length > 0 && (viewMode === 'all' || viewMode === 'surface')) {
		log(`Processing faces for viewMode: ${viewMode}`);
		// Process faces from meshData.faces
			
			for (let i = 0; i < meshData.faces.length; i++) {
				const face = meshData.faces[i];
				if (Array.isArray(face) && face.length === 3) {
					// P1 triangle
					cellArray.insertNextCell(face);
					processedElements++;
				} else if (Array.isArray(face) && face.length === 6) {
					// P2 triangle - convert to 4 P1 triangles
					cellArray.insertNextCell([face[0], face[3], face[5]]);
					cellArray.insertNextCell([face[3], face[1], face[4]]);
					cellArray.insertNextCell([face[4], face[2], face[5]]);
					cellArray.insertNextCell([face[3], face[4], face[5]]);
					processedElements += 4;
				}
			}
		}
		
		// Processed surface elements
	}
	
	// Process 1D elements (lines) - always process these regardless of view mode
	if (meshData.cells && typeof meshData.cells === 'object') {
		// Process line elements
		if (meshData.cells.line && meshData.cells.line.length > 0) {
			for (let i = 0; i < meshData.cells.line.length; i++) {
				const line = meshData.cells.line[i];
				if (Array.isArray(line) && line.length === 2) {
					cellArray.insertNextCell(line);
					processedElements++;
				}
			}
		}
		
		// Process second-order line elements (1D)
		if (meshData.cells.line_2nd && meshData.cells.line_2nd.length > 0) {
			for (let i = 0; i < meshData.cells.line_2nd.length; i++) {
				const line_2nd = meshData.cells.line_2nd[i];
				if (Array.isArray(line_2nd) && line_2nd.length === 3) {
					// Convert P2 line to 2 P1 lines
					cellArray.insertNextCell([line_2nd[0], line_2nd[1]]);
					cellArray.insertNextCell([line_2nd[1], line_2nd[2]]);
					processedElements += 2;
				}
			}
		}
	}
	
	// Set mesh connectivity
	
	// Process 1D elements (lines) - use separate cell array for lines
	let lineElements = 0;
	if (meshData.cells && typeof meshData.cells === 'object') {
		if (meshData.cells.line && meshData.cells.line.length > 0) {
			log(`Processing ${meshData.cells.line.length} line elements`);
			for (let i = 0; i < meshData.cells.line.length; i++) {
				const line = meshData.cells.line[i];
				if (Array.isArray(line) && line.length === 2) {
					lineCellArray.insertNextCell(line);
					lineElements++;
				}
			}
		}
		
		if (meshData.cells.line_2nd && meshData.cells.line_2nd.length > 0) {
			for (let i = 0; i < meshData.cells.line_2nd.length; i++) {
				const line_2nd = meshData.cells.line_2nd[i];
				if (Array.isArray(line_2nd) && line_2nd.length === 3) {
					// Convert P2 line to 2 P1 lines
					lineCellArray.insertNextCell([line_2nd[0], line_2nd[1]]);
					lineCellArray.insertNextCell([line_2nd[1], line_2nd[2]]);
					lineElements += 2;
				}
			}
		}
	}
	
	// Set the appropriate cell data based on what we have
	// Set mesh connectivity
	if (processedElements > 0) {
		polydata.setPolys(cellArray);
	}
	if (lineElements > 0) {
		polydata.setLines(lineCellArray);
	}
	
	// Debug element counts
	log(`=== ELEMENT PROCESSING SUMMARY ===`);
	log(`View mode: ${viewMode}`);
	log(`Processed surface/volume elements: ${processedElements}`);
	log(`Processed line elements: ${lineElements}`);
	log(`Total elements: ${processedElements + lineElements}`);

	// Add field data for coloring
	// Check if fieldData is properly loaded
	if (typeof fieldData === 'undefined') {
		console.error('fieldData is undefined!');
		return;
	}
	if (!fieldData.values) {
		console.error('fieldData.values is undefined!');
		return;
	}
	
	// Handle mesh-only visualization (no field data)
	if (!fieldData.values || fieldData.values.length === 0) {
		// Create mesh without field data
		createMeshOnly();
		return;
	}
	
	if (fieldData.values.length !== meshData.vertices.length) {
		console.warn(`WARNING: Field values length (${fieldData.values.length}) does not match vertices length (${meshData.vertices.length})`);
	}
	
	// CRITICAL: Ensure scalar array matches mesh points exactly
	// Validate scalar data
	const numPoints = polydata.getPoints().getNumberOfPoints();
	const numValues = fieldData.values.length;
	
	log('=== SCALAR DATA VALIDATION ===');
	log('Polydata points count:', numPoints);
	log('Field values count:', numValues);
	log('Values match points:', numPoints === numValues);
	
	if (numPoints !== numValues) {
		console.error(`CRITICAL ERROR: Point count (${numPoints}) != Value count (${numValues})`);
		console.error('This will cause scalar coloring to fail!');
		
		// Try to fix by truncating or padding values
		let fixedValues = fieldData.values;
		if (numValues > numPoints) {
			fixedValues = fieldData.values.slice(0, numPoints);
			log(`Truncated values to ${numPoints} to match points`);
		} else if (numValues < numPoints) {
			// Pad with last value
			const lastValue = fieldData.values[fieldData.values.length - 1];
			fixedValues = [...fieldData.values, ...Array(numPoints - numValues).fill(lastValue)];
			log(`Padded values to ${numPoints} to match points`);
		}
		fieldData.values = fixedValues;
	}
	
	// Create scalar array
	const scalarValues = new Float32Array(fieldData.values.slice(0, numPoints));
	
	// Create scalar array
	let scalars = null;
	try {
		scalars = vtk.Common.Core.vtkDataArray.newInstance({
			name: 'values',
		numberOfComponents: 1,
			values: scalarValues
		});
	} catch (e) {
		console.error('Failed to create scalars:', e);
	}
	
	if (!scalars) {
		try {
			scalars = vtk.Common.Core.vtkDataArray.newInstance({
				name: 'values',
				numberOfComponents: 1,
				size: numPoints
			});
			for (let i = 0; i < numPoints; i++) {
				scalars.setValue(i, scalarValues[i]);
			}
		} catch (e) {
			console.error('Failed to create scalars:', e);
		}
	}
	
	if (scalars) {
		// Bind scalar data to polydata using Method 1 (Direct setScalars)
		polydata.getPointData().setScalars(scalars);
		polydata.modified();
	} else {
		console.error('CRITICAL: Failed to create scalar array!');
	}
	
	// Verify scalar binding
	log('=== SCALAR BINDING VERIFICATION ===');
	log('Scalars set on polydata:', polydata.getPointData().getScalars() ? 'YES' : 'NO');
	log('Active scalars set:', polydata.getPointData().getActiveScalars() ? 'YES' : 'NO');
	log('Scalar array size:', scalars.getNumberOfTuples());
	log('Scalar array components:', scalars.getNumberOfComponents());
	
	// Check for invalid values
	const scalarArrayValues = Array.from(scalars.getData());
	const hasNaN = scalarArrayValues.some(v => isNaN(v));
	const hasInf = scalarArrayValues.some(v => !isFinite(v));
	const allZero = scalarArrayValues.every(v => v === 0);
	
	log('=== SCALAR VALUE VALIDATION ===');
	log('Has NaN values:', hasNaN);
	log('Has infinite values:', hasInf);
	log('All values zero:', allZero);
	log('Min value:', Math.min(...scalarArrayValues));
	log('Max value:', Math.max(...scalarArrayValues));
	
	if (hasNaN || hasInf) {
		console.error('CRITICAL: Scalar array contains NaN or infinite values!');
	}
	if (allZero) {
		console.error('CRITICAL: All scalar values are zero!');
	}
	

	// Create mapper and actor
	const mapper = vtk.Rendering.Core.vtkMapper.newInstance();
	
	// CRITICAL: Set input data AFTER scalar data is bound
	mapper.setInputData(polydata);
	
	// Force mapper to update with the new polydata
	mapper.modified();
	
	// CRITICAL: Configure mapper for point data scalars
	mapper.setScalarVisibility(true);
	mapper.setScalarModeToUsePointData();
	mapper.setColorModeToMapScalars();
	mapper.setColorByArrayName('values');
	
	// Ensure fieldMin < fieldMax for correct color mapping
	const actualMin = Math.min(fieldMin, fieldMax);
	const actualMax = Math.max(fieldMin, fieldMax);
	
	mapper.setScalarRange(actualMin, actualMax);
	
	// Force scalar visibility - this is critical for coloring
	mapper.setScalarVisibility(true);
	
	// Additional mapper configuration
	if (mapper.setScalarArrayName) {
		mapper.setScalarArrayName('values');
	}
	
	// CRITICAL: Ensure mapper uses the scalar data for coloring
	mapper.setScalarModeToUsePointData();
	mapper.setColorModeToMapScalars();
	
	// Verify mapper configuration
	log('=== MAPPER CONFIGURATION VERIFICATION ===');
	log('Mapper scalar visibility:', mapper.getScalarVisibility());
	log('Mapper scalar mode:', mapper.getScalarMode());
	log('Mapper scalar range:', mapper.getScalarRange());
	log('Mapper color by array name:', mapper.getColorByArrayName());
	log('Mapper color mode:', mapper.getColorMode());
	
	// Verify mapper input
	const mapperInput = mapper.getInputData();
	if (mapperInput) {
		const pointData = mapperInput.getPointData();
		log('Mapper input has point data:', pointData ? 'YES' : 'NO');
		log('Mapper input has scalars:', pointData.getScalars() ? 'YES' : 'NO');
		if (pointData.getScalars()) {
			log('Mapper input scalar count:', pointData.getScalars().getNumberOfTuples());
			log('Mapper input scalar name:', pointData.getScalars().getName ? pointData.getScalars().getName() : 'No name method');
		}
	}

	// Use ColorTransferFunction for scalar coloring (VTK.js standard approach)
	const lutData = fieldData.lookup_table;
	let lut = null;
	
	// Always use ColorTransferFunction - it's the standard VTK.js approach for scalar coloring
	lut = vtk.Rendering.Core.vtkColorTransferFunction.newInstance();
	
	if (lutData && lutData.colors && lutData.colors.length > 0) {
		// CRITICAL: Use actualMin/actualMax (from field values) for mapping range, not lutData.range
		// This ensures the lookup table range matches the mapper's scalar range exactly
		// lutData.range might be from backend calculation and could be inverted or different
		const lutMin = actualMin; // Use actualMin from field values (ensures correct order)
		const lutMax = actualMax; // Use actualMax from field values (ensures correct order)
		
		// Verify range is valid
		if (lutMin >= lutMax) {
			log('WARNING: Invalid range for lookup table, using fieldMin/fieldMax instead');
			const lutMin_fallback = Math.min(fieldMin, fieldMax);
			const lutMax_fallback = Math.max(fieldMin, fieldMax);
			lut.setMappingRange(lutMin_fallback, lutMax_fallback);
		} else {
			// Set the mapping range to match mapper's scalar range
		lut.setMappingRange(lutMin, lutMax);
		}
		
		// Add color points to the transfer function
		// Standard colormap: first color maps to minimum, last color to maximum
		const range = lutMax - lutMin;
		if (range > 0) {
		for (let i = 0; i < lutData.colors.length; i++) {
				const color = lutData.colors[i]; // Use color in original order
				const scalarValue = lutMin + (i / (lutData.colors.length - 1)) * range;
			lut.addRGBPoint(scalarValue, color[0], color[1], color[2]);
			}
		} else {
			log('WARNING: Zero range for lookup table, using single color');
			const color = lutData.colors[0];
			lut.addRGBPoint(lutMin, color[0], color[1], color[2]);
		}
	} else {
		// Create a default viridis-like gradient
		// Standard colormap: Purple for minimum, Yellow for maximum
		lut.setMappingRange(actualMin, actualMax);
		
		const range = actualMax - actualMin;
		if (range > 0) {
			// Standard viridis colormap order
			lut.addRGBPoint(actualMin, 0.267, 0.004, 0.329); // Dark purple (low values)
			lut.addRGBPoint(actualMin + range * 0.25, 0.282, 0.140, 0.457); // Purple-blue
			lut.addRGBPoint(actualMin + range * 0.5, 0.253, 0.265, 0.529); // Blue
			lut.addRGBPoint(actualMin + range * 0.75, 0.206, 0.371, 0.406); // Blue-green
			lut.addRGBPoint(actualMax, 0.993, 0.906, 0.144); // Yellow (high values)
		}
	}
	
	// Set the lookup table on the mapper
	mapper.setLookupTable(lut);

	actor = vtk.Rendering.Core.vtkActor.newInstance();
	actor.setMapper(mapper);

	// Set actor properties (like mesh visualization)
	const actorProps = actor.getProperty();
	
	// CRITICAL: Don't set actor color - let scalar field coloring work
	// actorProps.setColor() would override scalar coloring
	
	// Set representation based on mesh dimension and parameter
	if (meshData.vertices && meshData.vertices.length > 0) {
		// Use the computed meshDimension to choose behavior
		if (meshDimension === 1) {
			// 1D mesh - use wireframe for line visibility (like mesh visualization)
			actorProps.setRepresentation(1); // Wireframe
			actorProps.setLineWidth(15); // Very thick lines for visibility (like mesh visualization)
			// Don't set color - let scalar field coloring work
			log('Set 1D mesh wireframe with thick lines');
			log('Actor representation:', actorProps.getRepresentation());
			log('Actor line width:', actorProps.getLineWidth());
		} else {
			// 2D/3D mesh - use representation parameter if provided, otherwise default to surface
			const repValue = representation !== null ? representation : 2; // Default to surface
			actorProps.setRepresentation(repValue);
			log(`Set ${meshDimension}D mesh representation to:`, repValue);
			
			// Set additional properties based on representation
			if (repValue === 0) {
				// Points representation
				actorProps.setPointSize(meshDimension === 2 ? 5 : 3);
			} else if (repValue === 1) {
				// Wireframe representation
				actorProps.setLineWidth(2);
				actorProps.setEdgeVisibility(true);
			} else if (repValue === 2) {
				// Surface representation
				actorProps.setOpacity(0.8);
				actorProps.setEdgeVisibility(true);
			}
		}
	}
	
	// Debug actor properties
	// Set actor properties

	// Add to renderer
	renderer.addActor(actor);
	window.actor = actor; // Store globally like mesh visualization
	window.renderer = renderer; // Store globally like mesh visualization
	window.renderWindow = renderWindow; // Store globally like mesh visualization

	// Reset camera to fit the mesh
	renderer.resetCamera();
	
	// Get camera for positioning and debugging
	const camera = renderer.getActiveCamera();
	
	// For 1D meshes, ensure proper camera positioning (like mesh visualization)
	if (meshDimension === 1) {
		// Calculate actual mesh bounds and center (like mesh visualization)
		const bounds = polydata.getBounds();
		const center = [
			(bounds[0] + bounds[1]) / 2,
			(bounds[2] + bounds[3]) / 2,
			(bounds[4] + bounds[5]) / 2
		];
		
		// Position camera above the mesh center (like mesh visualization)
		camera.setPosition(center[0], center[1], center[2] + 2);
		camera.setFocalPoint(center[0], center[1], center[2]);
		camera.setViewUp(0, 1, 0);
		
		// Set camera clipping planes to ensure 1D line is visible
		camera.setClippingRange(0.1, 100);
		
		renderer.resetCamera();
		
		// Debug scalar coloring
	log('=== SCALAR COLORING DEBUG ===');
	log('Mapper scalar visibility:', mapper.getScalarVisibility());
	log('Mapper scalar mode:', mapper.getScalarMode());
	log('Mapper scalar range:', mapper.getScalarRange());
	log('Actor representation:', actorProps.getRepresentation());
	log('Actor line width:', actorProps.getLineWidth());
	}
	
	// Show colorbar for field visualization
	showColorbar();
	
	// Final debug check for scalar coloring
	// Final verification
	log('=== FINAL SCALAR COLORING CHECK ===');
	log('Polydata has scalars:', polydata.getPointData().getScalars() ? 'YES' : 'NO');
	log('Mapper scalar visibility:', mapper.getScalarVisibility());
	log('Mapper scalar mode:', mapper.getScalarMode());
	log('Mapper lookup table:', mapper.getLookupTable() ? 'SET' : 'NOT SET');
	log('Actor added to renderer:', renderer.getActors().length > 0);
	
	// Force render to ensure mesh is visible
	renderWindow.render();
}

function setupControls() {
	// Colormap is now fixed to viridis - no controls needed

	// Opacity change

	// Range selection removed - no longer needed
	initializeTimeControls();
}

function updateInfo() {
	document.getElementById('field-min').textContent = fieldMin.toFixed(3);
	document.getElementById('field-max').textContent = fieldMax.toFixed(3);
	document.getElementById('field-mean').textContent = fieldMean.toFixed(3);
}

function showColorbar() {
	const colorbar = document.getElementById('colorbar');
	if (colorbar) {
		colorbar.style.display = 'block';
	updateColorbar();
	}
}

function updateVTKColormap() {
	if (!window.actor || !window.actor.getMapper()) {
		console.error('Actor or mapper not available');
		return;
	}
	
	const mapper = window.actor.getMapper();
	const lut = mapper.getLookupTable();
	
	if (!lut) {
		console.error('Lookup table not available');
		return;
	}
        
        // Always use viridis colormap
        const vtkPresetName = 'viridis';
        
        // Update the lookup table with new colormap
        lut.setRange(fieldMin, fieldMax);
        lut.setNumberOfColors(256); // Use standard 256 colors
        
        // Apply the built-in colormap preset
        try {
            // Try to use VTK.js built-in colormap if available
            if (vtk.Rendering.Core.ColorTransferFunction && vtk.Rendering.Core.ColorTransferFunction.ColorMaps) {
                log('Available VTK colormaps:', vtk.Rendering.Core.ColorTransferFunction.ColorMaps.getPresetNames());
                const preset = vtk.Rendering.Core.ColorTransferFunction.ColorMaps.getPresetByName(vtkPresetName);
                if (preset) {
                    log('Using VTK preset:', vtkPresetName);
                    lut.applyColorMap(preset);
                } else {
                    log('VTK preset not found:', vtkPresetName, 'using fallback');
                    // Fallback to default colormap
                    lut.setHueRange(0.0, 0.67); // Blue to red
                }
            } else {
                // Fallback to default colormap
                lut.setHueRange(0.0, 0.67); // Blue to red
            }
        } catch (error) {
            log('Using fallback colormap:', error);
            // Fallback to default colormap
            lut.setHueRange(0.0, 0.67); // Blue to red
        }
        
	// Force the mapper to update
	mapper.setScalarRange(fieldMin, fieldMax);
	
	// Force render
	if (window.renderWindow) {
		window.renderWindow.render();
	}
}

function updateColorbar() {
	const gradient = document.getElementById('colorbar-gradient');
	
	// Always use viridis gradient
	const gradientCSS = 'linear-gradient(to right, #440154, #482777, #3f4a8a, #31678e, #26838f, #1f9d8a, #6cce5a, #b6de2b, #fee825)';
	
	if (gradient) {
		gradient.style.background = gradientCSS;
	}

	// Update labels
	document.getElementById('max-label').textContent = fieldMax.toFixed(2);
	document.getElementById('min-label').textContent = fieldMin.toFixed(2);
}

function showError(message) {
	document.getElementById('loading').style.display = 'none';
	document.getElementById('error').style.display = 'block';
	document.getElementById('error').textContent = message;
}

// Fit to view function (like mesh visualization)
function fitToView() {
	
	if (window.renderer && window.actor && window.renderWindow) {
		window.renderer.resetCamera();
		window.renderWindow.render();
	} else {
	}
}

// Change representation function (like mesh visualization)
function updateViewButtonStates() {
	const surfaceButton = document.getElementById('surfaceViewBtn');
	const volumeButton = document.getElementById('volumeViewBtn');
	
	if (surfaceButton && volumeButton) {
		// Reset both buttons to default state
		surfaceButton.style.backgroundColor = '#001100';
		surfaceButton.style.color = '#00ff00';
		surfaceButton.style.border = '1px solid #00ff00';
		volumeButton.style.backgroundColor = '#001100';
		volumeButton.style.color = '#00ff00';
		volumeButton.style.border = '1px solid #00ff00';
		
		// Highlight active button based on current view mode
		if (currentViewMode === 'surface') {
			surfaceButton.style.backgroundColor = '#003300';
			surfaceButton.style.border = '2px solid #00ff00';
		} else if (currentViewMode === 'volume') {
			volumeButton.style.backgroundColor = '#003300';
			volumeButton.style.border = '2px solid #00ff00';
		}
	}
}

function showSurfaceView() {
	currentViewMode = 'surface';
	updateViewButtonStates();
	
	// Get current representation
	const representationSelect = document.getElementById('representation-select');
	const currentRepresentation = representationSelect ? parseInt(representationSelect.value) : 2;
	
	// Check if field display is "none"
	const fieldDisplaySelect = document.getElementById('field-display-select');
	const displayType = fieldDisplaySelect ? fieldDisplaySelect.value : 'field';
	
	if (displayType === 'none') {
		// For mesh-only view, recreate mesh with surface elements
		createMeshOnly();
	} else {
		// For field visualization, recreate with surface view
		createFieldMesh('surface', currentRepresentation);
	}
	
	renderWindow.render();
}

function showVolumeView() {
	currentViewMode = 'volume';
	updateViewButtonStates();
	
	// Get current representation
	const representationSelect = document.getElementById('representation-select');
	const currentRepresentation = representationSelect ? parseInt(representationSelect.value) : 2;
	
	// Check if field display is "none"
	const fieldDisplaySelect = document.getElementById('field-display-select');
	const displayType = fieldDisplaySelect ? fieldDisplaySelect.value : 'field';
	
	if (displayType === 'none') {
		// For mesh-only view, recreate mesh with volume elements
		createMeshOnly();
	} else {
		// For field visualization, recreate with volume view
		createFieldMesh('volume', currentRepresentation);
	}
	
	renderWindow.render();
}


function changeRepresentation(value) {
	
	const repValue = parseInt(value);
	
	// Check if field display is "none"
	const fieldDisplaySelect = document.getElementById('field-display-select');
	const displayType = fieldDisplaySelect ? fieldDisplaySelect.value : 'field';
	
	if (meshDimension === 1) {
		// For 1D meshes, handle points and wireframe representations only
		if (window.actor && window.renderWindow) {
			if (repValue === 0) {
				// Points representation
				const actorProps = window.actor.getProperty();
				actorProps.setRepresentation(0); // Points
				actorProps.setPointSize(8); // Large points for visibility
				actorProps.setLineWidth(1); // Reset line width
			} else if (repValue === 1) {
				// Wireframe representation - recreate mesh with proper line connectivity
				if (displayType === 'none') {
					createMeshOnly();
				} else {
					createFieldMesh(currentViewMode, 1);
				}
			}
			
			// Force render
			window.renderWindow.render();
		}
	} else if (meshDimension === 2) {
		// For 2D meshes, handle points, wireframe, and surface representations
		if (window.actor && window.renderWindow) {
			const actorProps = window.actor.getProperty();
			
			if (repValue === 0) {
				// Points representation
				actorProps.setRepresentation(0); // Points
				actorProps.setPointSize(5);
				actorProps.setLineWidth(1);
				actorProps.setEdgeVisibility(false);
			} else if (repValue === 1) {
				// Wireframe representation - recreate mesh to preserve view mode
				if (displayType === 'none') {
					createMeshOnly();
				} else {
					createFieldMesh(currentViewMode, 1);
				}
			} else if (repValue === 2) {
				// Surface representation
				actorProps.setRepresentation(2); // Surface
				actorProps.setOpacity(0.8);
				actorProps.setPointSize(1);
				actorProps.setLineWidth(1);
				actorProps.setEdgeVisibility(true); // Show edges on surface
			}
			
			// Don't reset camera - keep current camera position
			window.renderWindow.render();
		}
	} else if (meshDimension === 3) {
		// For 3D meshes, handle points, wireframe, and surface representations
		if (window.actor && window.renderWindow) {
			const actorProps = window.actor.getProperty();
			
			if (repValue === 0) {
				// Points representation
				actorProps.setRepresentation(0); // Points
				actorProps.setPointSize(3);
			} else if (repValue === 1) {
				// Wireframe representation - recreate mesh to preserve view mode
				log('Recreating 3D mesh with wireframe representation...');
				if (displayType === 'none') {
					createMeshOnly();
				} else {
					createFieldMesh(currentViewMode, 1);
				}
			} else if (repValue === 2) {
				// Surface representation
				actorProps.setRepresentation(2); // Surface
				actorProps.setOpacity(0.8);
				actorProps.setEdgeVisibility(true);
				actorProps.setLineWidth(1);
			}
			
			// Don't reset camera - keep current camera position
			window.renderWindow.render();
		}
	}
	
	log('Representation changed to:', value);
}

// Handle window resize
window.addEventListener('resize', function() {
	if (renderWindow) {
		const openGLRenderWindow = renderWindow.getViews()[0];
		openGLRenderWindow.setSize(window.innerWidth, window.innerHeight);
		renderWindow.render();
	}
});

// Start when page loads
window.addEventListener('load', init);
</script>
</body>
</html>
