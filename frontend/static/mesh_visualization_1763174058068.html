<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Mesh Visualization</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #2a2a2a;
            font-family: 'Courier New', monospace;
            overflow: hidden;
        }
        
        #container {
            width: 100vw;
            height: 100vh;
            position: relative;
            background-color: #2a2a2a;
            border: 2px solid #00ff00;
        }
        
        #vtk-container {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1;
        }
        
        #loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 18px;
            z-index: 200;
        }
        
        
        #info {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
            z-index: 1000;
            pointer-events: auto;
        }
        
        #controls {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.9);
            color: #00ff00;
            padding: 8px;
            border-radius: 3px;
            font-size: 11px;
            z-index: 1000;
            min-width: 140px;
            max-width: 160px;
            border: 1px solid #00ff00;
            pointer-events: auto;
        }
        
        .control-group {
            margin-bottom: 6px;
        }
        
        .control-group label {
            display: block;
            margin-bottom: 3px;
            color: #00ff00;
            font-size: 10px;
        }
        
        .control-group input, .control-group select {
            width: 100%;
            padding: 2px;
            background: #001100;
            color: #00ff00;
            border: 1px solid #00ff00;
            border-radius: 2px;
            font-size: 10px;
        }
        
        /* Colorbar removed from mesh preview - no field visualization */
    </style>
</head>
<body>
    <div id="container">
        <div id="vtk-container"></div>
        <div id="loading">Loading visualization... Generating mesh with GMSH...</div>
        <div id="info">
            <div><strong>Mesh Statistics:</strong></div>
            <div>Vertices: <span id="vertex-count">-</span></div>
            <div>Faces: <span id="face-count">-</span></div>
            <div>Type: <span id="mesh-type">-</span></div>
        </div>
        <div id="controls">
            <div class="control-group">
                <label>Representation:</label>
                <select id="representation-select" onchange="changeRepresentation(this.value);">
                    <option value="0">Points</option>
                    <option value="1">Wireframe</option>
                    <option value="2" id="surface-option">Surface</option>
                </select>
            </div>
            
            <div class="control-group">
                <label>Background:</label>
                <select id="background-select" onchange="changeBackground(this.value);">
                    <option value="#1a1a1a">Dark</option>
                    <option value="#ffffff">Light</option>
                    <option value="#000000">Black</option>
                </select>
            </div>
            <div class="control-group">
                <button id="fit-view" onclick="fitToView();" style="width: 100%; padding: 4px; background: #001100; color: #00ff00; border: 1px solid #00ff00; border-radius: 2px; cursor: pointer; margin-bottom: 3px; font-size: 10px; transition: all 0.2s ease;" onmouseover="this.style.background='#003300'; this.style.border='2px solid #00ff00';" onmouseout="this.style.background='#001100'; this.style.border='1px solid #00ff00';">Fit to View</button>
                <button id="surface-view-btn" onclick="showSurfaceView();" style="width: 100%; padding: 4px; background: #001100; color: #00ff00; border: 1px solid #00ff00; border-radius: 2px; cursor: pointer; margin-bottom: 3px; font-size: 10px; transition: all 0.2s ease;" onmouseover="this.style.background='#003300'; this.style.border='2px solid #00ff00';" onmouseout="this.style.background='#001100'; this.style.border='1px solid #00ff00';">Surface View</button>
                <button id="volume-view-btn" onclick="showVolumeView();" style="width: 100%; padding: 4px; background: #001100; color: #00ff00; border: 1px solid #00ff00; border-radius: 2px; cursor: pointer; font-size: 10px; transition: all 0.2s ease;" onmouseover="this.style.background='#003300'; this.style.border='2px solid #00ff00';" onmouseout="this.style.background='#001100'; this.style.border='1px solid #00ff00';">Volume View</button>
        </div>
            <div class="control-group">
                <div style="font-size: 9px; color: #00ff00; margin-top: 5px; line-height: 1.2;">
                    <strong>Controls:</strong><br>
                    • LMB: Rotate<br>
                    • MMB: Pan<br>
                    • RMB: Zoom<br>
                    • Wheel: Zoom
                </div>
            </div>
        </div>
        
    </div>

    <!-- VTK.js loaded locally to avoid CDN issues -->
    <script src="/static/js/vtk.js" onerror="console.error('Failed to load VTK.js script');"></script>
    
    <script>
        // Get mesh dimension from template data
        const meshDimension = 2;
        window.meshDimension = meshDimension;
        
        // Get mesh data from template data
        const fullMeshData = {"vertices": [[1.5, 0.0, 0.0], [1.4871672920607157, 0.19578928833007708, 0.0], [1.4488887394336025, 0.38822856765378044, 0.0], [1.3858192987669307, 0.5740251485476336, 0.0], [1.2990381056766587, 0.7499999999999988, 0.0], [1.190030010436854, 0.9131421435130795, 0.0], [1.0606601717798227, 1.0606601717798196, 0.0], [0.913142143513083, 1.1900300104368513, 0.0], [0.7500000000000024, 1.2990381056766567, 0.0], [0.5740251485476375, 1.3858192987669289, 0.0], [0.388228567653784, 1.4488887394336016, 0.0], [0.1957892883300799, 1.4871672920607153, 0.0], [2.42331686164888e-15, 1.5, 0.0], [-0.19578928833007508, 1.487167292060716, 0.0], [-0.388228567653779, 1.448888739433603, 0.0], [-0.5740251485476326, 1.3858192987669309, 0.0], [-0.749999999999998, 1.2990381056766591, 0.0], [-0.9131421435130784, 1.1900300104368546, 0.0], [-1.0606601717798183, 1.060660171779824, 0.0], [-1.1900300104368498, 0.913142143513085, 0.0], [-1.2990381056766551, 0.7500000000000051, 0.0], [-1.3858192987669273, 0.574025148547641, 0.0], [-1.4488887394336005, 0.3882285676537886, 0.0], [-1.4871672920607146, 0.19578928833008527, 0.0], [-1.5, 9.509570426723418e-15, 0.0], [-1.4871672920607168, -0.19578928833006776, 0.0], [-1.4488887394336052, -0.38822856765377023, 0.0], [-1.3858192987669347, -0.574025148547624, 0.0], [-1.2990381056766647, -0.7499999999999887, 0.0], [-1.1900300104368609, -0.9131421435130703, 0.0], [-1.0606601717798314, -1.0606601717798112, 0.0], [-0.913142143513093, -1.1900300104368435, 0.0], [-0.7500000000000144, -1.2990381056766496, 0.0], [-0.5740251485476491, -1.3858192987669242, 0.0], [-0.3882285676537951, -1.4488887394335985, 0.0], [-0.19578928833009063, -1.487167292060714, 0.0], [-1.3598221825310033e-14, -1.5, 0.0], [0.1957892883300663, -1.487167292060717, 0.0], [0.38822856765377145, -1.448888739433605, 0.0], [0.5740251485476263, -1.3858192987669335, 0.0], [0.749999999999992, -1.2990381056766624, 0.0], [0.9131421435130757, -1.1900300104368569, 0.0], [1.0606601717798174, -1.0606601717798254, 0.0], [1.190030010436849, -0.9131421435130856, 0.0], [1.2990381056766556, -0.7500000000000042, 0.0], [1.3858192987669293, -0.5740251485476369, 0.0], [1.448888739433602, -0.38822856765378233, 0.0], [1.4871672920607155, -0.19578928833007886, 0.0], [1.496788384857905, 0.09810469384521445, 0.0], [1.4711779206048459, 0.2926354830241919, 0.0], [1.420395194242659, 0.48215919795474155, 0.0], [1.345309112299033, 0.6634330353285007, 0.0], [1.247204418453819, 0.8333553495294019, 0.0], [1.1277597112184674, 0.9890187226501019, 0.0], [0.989018722650105, 1.1277597112184645, 0.0], [0.8333553495294056, 1.2472044184538165, 0.0], [0.6634330353285046, 1.3453091122990313, 0.0], [0.48215919795474504, 1.4203951942426576, 0.0], [0.29263548302419506, 1.4711779206048452, 0.0], [0.09810469384521724, 1.496788384857905, 0.0], [-0.0981046938452124, 1.4967883848579053, 0.0], [-0.29263548302419, 1.471177920604846, 0.0], [-0.4821591979547405, 1.4203951942426591, 0.0], [-0.6634330353285, 1.3453091122990335, 0.0], [-0.8333553495294008, 1.2472044184538196, 0.0], [-0.9890187226501008, 1.1277597112184683, 0.0], [-1.127759711218463, 0.9890187226501069, 0.0], [-1.2472044184538151, 0.8333553495294076, 0.0], [-1.3453091122990295, 0.663433035328508, 0.0], [-1.4203951942426563, 0.48215919795474893, 0.0], [-1.471177920604844, 0.29263548302420006, 0.0], [-1.4967883848579047, 0.09810469384522331, 0.0], [-1.496788384857906, -0.098104693845205, 0.0], [-1.4711779206048476, -0.2926354830241821, 0.0], [-1.4203951942426623, -0.48215919795473156, 0.0], [-1.345309112299038, -0.6634330353284908, 0.0], [-1.2472044184538251, -0.8333553495293923, 0.0], [-1.1277597112184754, -0.9890187226500928, 0.0], [-0.9890187226501141, -1.1277597112184565, 0.0], [-0.8333553495294166, -1.247204418453809, 0.0], [-0.6634330353285164, -1.3453091122990255, 0.0], [-0.4821591979547566, -1.4203951942426536, 0.0], [-0.29263548302420606, -1.471177920604843, 0.0], [-0.09810469384522873, -1.4967883848579044, 0.0], [0.09810469384520158, -1.496788384857906, 0.0], [0.292635483024182, -1.4711779206048479, 0.0], [0.4821591979547334, -1.4203951942426616, 0.0], [0.6634330353284932, -1.3453091122990366, 0.0], [0.8333553495293962, -1.2472044184538227, 0.0], [0.9890187226500986, -1.1277597112184703, 0.0], [1.1277597112184619, -0.9890187226501082, 0.0], [1.247204418453815, -0.8333553495294077, 0.0], [1.3453091122990306, -0.6634330353285057, 0.0], [1.4203951942426578, -0.48215919795474405, 0.0], [1.4711779206048452, -0.2926354830241944, 0.0], [1.496788384857905, -0.0981046938452155, 0.0], [-0.7605243354652773, -1.1187654613223332, 0.0], [0.7313763428443739, 1.1079064931747702, 0.0], [-1.107782339418174, 0.7162978296129591, 0.0], [1.09946250246277, -0.7565074453597729, 0.0], [-1.3303711266261264, -0.2875862095264071, 0.0], [1.3003017108598294, 0.2748101140997041, 0.0], [0.2585559322845871, -1.295993325066759, 0.0], [-0.2588587289967476, 1.3013707111668624, 0.0], [-1.10999643512782, -0.7156699084476392, 0.0], [-1.3141689939293617, 0.26038379500433606, 0.0], [-0.7325559889908614, 1.1163788035811746, 0.0], [1.3125398039634248, -0.2707441955676703, 0.0], [0.7371672920607095, -1.103248817346584, 0.0], [1.1182434556258438, 0.7350205592117943, 0.0], [0.258858728996752, 1.3013707111668615, 0.0], [-0.281251167910675, -1.3313110535227706, 0.0], [0.5781385535820088, -1.2117897694623294, 0.0], [0.561309501886469, -1.0247626531959182, 0.0], [0.7193923764309683, -0.9096637008435775, 0.0], [0.5436815572598961, -0.8276891819979302, 0.0], [0.7033903885017411, -0.7137628410866095, 0.0], [0.525367377639689, -0.6320678951879292, 0.0], [0.3656897906085625, -0.7459274470379001, 0.0], [0.3470814281499718, -0.5504222672092108, 0.0], [0.5068861614428603, -0.43664522704277337, 0.0], [0.3284347207513961, -0.35510528823553483, 0.0], [0.16860630887364877, -0.4689070801378032, 0.0], [0.14996384273946484, -0.2735851516310089, 0.0], [0.30979642808347463, -0.15977978318368494, 0.0], [0.1313226202361145, -0.07826239608721769, 0.0], [-0.028510108884496805, -0.19206795103156946, 0.0], [-0.0471520574627004, 0.0032539645123512264, 0.0], [0.11268058305138956, 0.11705938098488769, 0.0], [-0.06579409806807276, 0.19857576577547376, 0.0], [-0.22562669256712586, 0.08477037447048669, 0.0], [0.09403849597691041, 0.3123811603062337, 0.0], [-0.0844361623254212, 0.3938975483671849, 0.0], [0.2725131887920792, 0.2308647900628868, 0.0], [0.25387108932049746, 0.42618655475858874, 0.0], [0.43234573981721147, 0.34467016873288875, 0.0], [0.41370367342789494, 0.5399919441297654, 0.0], [0.2352290181013633, 0.6215083313567973, 0.0], [0.59217832696854, 0.45847555593133976, 0.0], [0.610820397754067, 0.2631537913521275, 0.0], [0.7706529819042774, 0.3769591696919673, 0.0], [0.7892950464365115, 0.18163739123902262, 0.0], [0.39506160751627356, 0.7353137219558974, 0.0], [0.21658695245696516, 0.8168301096473165, 0.0], [0.3764195426133904, 0.9306355004689568, 0.0], [0.7520109162600946, 0.5722809460632787, 0.0], [0.6294624741530023, 0.06783196950156735, 0.0], [0.8079371137444845, -0.013684425448992944, 0.0], [0.05675436258456372, 0.7030247189461268, 0.0], [0.03811229795548473, 0.8983464976240714, 0.0], [-0.12172029210796889, 0.7845411068499868, 0.0], [0.966268214354796, 0.09997768887946132, 0.0], [0.9841542404561903, -0.09240557424435554, 0.0], [0.8262029060963384, -0.2085404008047167, 0.0], [0.9993221328362751, -0.28747353950008875, 0.0], [0.5528292741863456, 0.8445981023944245, 0.0], [-0.13851972964056075, 0.9772750306694583, 0.0], [-0.2998878421788866, 0.8656261856510334, 0.0], [-0.2815016981251356, 0.670663831203565, 0.0], [-0.4599678219840766, 0.7521682383561143, 0.0], [-0.44136698914136535, 0.5569043668624167, 0.0], [-0.6198470938335879, 0.6384284092326584, 0.0], [-0.6012128096649303, 0.4431175574342049, 0.0], [-0.779651355901432, 0.5245832335406614, 0.0], [-0.7610428834762109, 0.3293086327302053, 0.0], [-0.5825748906057928, 0.24780160065809606, 0.0], [-0.7424071085852713, 0.13399568730549422, 0.0], [-0.5639337763126542, 0.05248115637532075, 0.0], [-0.7237662507443783, -0.06132439680603713, 0.0], [-0.5452918177835715, -0.14284047358421062, 0.0], [-0.7051244050391691, -0.25664586831149805, 0.0], [-0.5266498044916362, -0.3381621804547958, 0.0], [-0.6864823855627652, -0.4519675838677895, 0.0], [-0.5080077385266856, -0.5334839613013593, 0.0], [-0.9022408860057454, 0.020191964090689782, 0.0], [-0.6678403283456594, -0.6472893524285493, 0.0], [-0.4893656754200306, -0.7288057381336248, 0.0], [-0.32953308521865127, -0.6150003475434994, 0.0], [-0.3108910209576977, -0.8103221259969058, 0.0], [-0.8649570385973668, -0.3704511980096683, 0.0], [-0.1510584269012453, -0.6965167355649078, 0.0], [-0.1324163658049196, -0.8918385139538599, 0.0], [-0.9394788052605605, 0.41077062295721734, 0.0], [-0.7929726140370997, 0.7123656289778838, 0.0], [0.8442222646932204, -0.403788191482726, 0.0], [0.027417571710704285, -0.7780335657099436, 0.0], [0.04605953608809133, -0.9733550680833902, 0.0], [-0.3668172058804079, -0.22435680165655836, 0.0], [-0.16970048943754512, -0.5011949582469133, 0.0], [-0.4640031985182451, -0.9234861014941377, 0.0], [0.924414692447649, 0.4880038440444968, 0.0], [0.018356958204487763, 1.0838040583573345, 0.0], [1.1486652749158974, 0.016004411605699934, 0.0], [-0.4739635469427296, 0.9409645223656035, 0.0], [1.01244380102573, -0.4757615253591596, 0.0], [-0.11651945354809849, -1.078762378724313, 0.0], [0.06470035250702047, -1.1686766805688509, 0.0], [0.22686790956253028, -1.0658498897631419, 0.0], [0.9002000004283953, -0.784963629546041, 0.0], [0.5382409802196335, 1.027527269392114, 0.0], [0.40875982381618925, -1.140754272719738, 0.0], [0.3488527953934346, 1.1387537007344617, 0.0], [0.9312917507523253, 0.7011624438391103, 0.0], [0.8585863128068638, -0.5876991025529734, 0.0], [0.385367600116778, -0.9440889184308399, 0.0], [0.6841998326963714, -0.5161291985438571, 0.0], [0.4882663832495508, -0.24130095755677256, 0.0], [0.18724438333635135, -0.6642586287464726, 0.0], [0.4696288410571441, -0.04597454243785888, 0.0], [0.29115539711273736, 0.035543012054300535, 0.0], [-0.009868137236044091, -0.3873899441997653, 0.0], [-0.2069846505830518, -0.11055143371353739, 0.0], [-0.24426875364700626, 0.28009215671257665, 0.0], [-0.2628992064563075, 0.47539762963041554, 0.0], [0.07539642932950906, 0.5077029403049854, 0.0], [0.73420114894355, 0.7648408973025032, 0.0], [0.8581654652050907, 0.862978451747599, 0.0], [0.9463640888518886, 0.2948154697006165, 0.0], [1.119353318370308, 0.4129529870431613, 0.0], [-0.8835990086850006, -0.17512955181682957, 0.0], [-1.052423536704529, -0.09269207032740913, 0.0], [-1.071947046139557, 0.09547822001429218, 0.0], [-1.2052580747919692, -0.006538876062460922, 0.0], [-1.0295034780746102, -0.28760549133403923, 0.0], [-1.0296851128943219, -0.5161237637573638, 0.0], [-0.8463149846294611, -0.5657729620071297, 0.0], [-0.816470106226936, -0.7570111045966041, 0.0], [0.1934683827936978, 1.0065024873249677, 0.0], [-0.31981881657993977, 1.0966233772385683, 0.0], [-0.5217950063786391, 1.1209279286365568, 0.0], [0.5733308245504497, 0.652583527962868, 0.0], [-0.4227373321448317, 0.3616000131832401, 0.0], [-0.3854592477467333, -0.029035068384461283, 0.0], [-0.10306776118346005, 0.5892046292170441, 0.0], [-0.6321671119999074, 0.8248601603397582, 0.0], [-0.81465345687235, 0.9123116249256152, 0.0], [-0.9194124377487192, 0.21446261133612166, 0.0], [-0.3481751472284102, -0.4196785711401428, 0.0], [-0.6380009085876137, -0.8379205202432752, 0.0], [-0.2968234274623906, -0.9967822887723249, 0.0], [-0.45081077970411787, -1.1131003378810964, 0.0], [-1.1228363805011112, 0.292811608747858, 0.0], [-1.1063745531242402, 0.5105659168028462, 0.0], [-0.404100115504024, 0.16628503883587648, 0.0], [-0.18834262320832595, -0.3058732766647477, 0.0], [0.008773535057644978, -0.5827168187676341, 0.0], [0.6664373394340112, -0.32245745034773227, 0.0], [0.45098767311437354, 0.14934819821098533, 0.0], [0.6480221329042349, -0.1273930625890958, 0.0], [0.2064411319038363, -0.8619189196286146, 0.0], [-0.9546209662452182, 0.6056555917254975, 0.0], [1.1329118614937377, 0.2035039497918255, 0.0], [0.8920957752732629, -0.9899568115536157, 0.0], [-1.1808397983382293, -0.3897680277481412, 0.0], [-0.13780645068548614, 1.1839532127709989, 0.0], [-0.0019287978959174356, 1.2847483414941356, 0.0], [1.1635998691948486, -0.3718560496024594, 0.0], [1.1813555456798823, -0.5714710257736827, 0.0], [1.15408977027578, -0.17313375663203023, 0.0], [1.3255575125990924, -0.08735834214266082, 0.0], [0.5569688250766648, 1.2112870912884137, 0.0], [-0.800092417104778, -0.9368464087410882, 0.0], [-0.9772983765083315, -0.8727312488510962, 0.0], [0.08665697801719432, -1.344943296264201, 0.0], [-0.10674736551138422, -1.2953851454555834, 0.0], [1.209584554699111, 0.5824832773830478, 0.0], [-1.2180829947490637, -0.5746298712225817, 0.0], [-1.0045929654170542, 0.8993007205424514, 0.0], [1.2927895244259564, 0.4465000189454654, 0.0], [-0.5951076090143966, -1.2084215506783758, 0.0], [-1.2741536830318063, 0.43509713562146557, 0.0], [0.7058026840467768, 0.9371145512341562, 0.0], [1.0284896920762188, -0.9010460403504681, 0.0], [-0.43240870869094333, -1.2740627162218332, 0.0], [1.3157672753215452, 0.10045823694744094, 0.0], [-0.43422729322353326, 1.2768853142412762, 0.0], [0.15967238071722775, 1.183450082164134, 0.0], [-0.6003853836441335, -1.0300777277740067, 0.0], [-1.349502373975497, 0.0840810488112182, 0.0], [-1.2295931754293798, 0.6063682503423128, 0.0], [1.053892890205613, 0.588005663105178, 0.0], [-0.9582300394822194, -0.6777835379853391, 0.0], [0.8790871695862609, 1.0372752203851596, 0.0], [-0.6350270222368976, 0.9830886079697416, 0.0], [1.3020159461201049, -0.44054414905019174, 0.0], [-1.3651308996941323, -0.09298949293531958, 0.0], [0.4423581909899448, -1.3016544858564072, 0.0], [-0.9095111077886182, 1.0370986522087924, 0.0], [-0.3050289793150267, -1.156835317048233, 0.0], [-0.9449207062065159, 0.7562939012144327, 0.0], [-0.9066942928932563, -1.0373974613128625, 0.0], [1.0301841801231033, 0.8791769810179072, 0.0], [-0.6116754107524209, 1.2403550321352768, 0.0], [-1.1749076209657021, -0.1986017894282438, 0.0], [0.12424424894481834, 1.3592781381746977, 0.0], [-0.12606958920423916, 1.3598977576996343, 0.0], [1.0075123719863375, -0.6317623608071223, 0.0], [-1.2162282919827958, 0.14492136104682882, 0.0], [-1.3150652773812006, -0.44441299550426255, 0.0], [0.4179384903682982, 1.3004964144801958, 0.0], [0.6534844125383336, 1.2551625984825352, 0.0], [0.6441725839605194, 1.159596792231592, 0.0], [0.7406881714221881, 1.2034722994257134, 0.0], [-1.1238840538216928, -0.5453768174899727, 0.0], [-1.1640397149384418, -0.6451498898351105, 0.0], [-1.069840774011071, -0.6158968361025015, 0.0], [1.2322162751187213, 0.05823132427657044, 0.0], [1.2243395684076415, 0.15198109336963322, 0.0], [1.1407885682048176, 0.10975418069876272, 0.0], [-1.0341132373050197, -0.6967267232164891, 0.0], [-0.9939575761882707, -0.5969536508713514, 0.0], [0.24271192092355873, -1.1809216074149504, 0.0], [0.14578413103477536, -1.1172632851659965, 0.0], [0.1616281423958038, -1.232335002817805, 0.0], [-0.3465430111101404, 1.2891280127040692, 0.0], [-0.3770230549017365, 1.1867543457399221, 0.0], [-0.2893387727883437, 1.1989970442027154, 0.0], [-0.053373682755698905, -1.3976925727277916, 0.0], [-0.1512683269207374, -1.3912762187581487, 0.0], [1.3080344930906873, 0.1876341755235725, 0.0], [1.2166067861767835, 0.2391570319457648, 0.0], [0.5476049026481492, 1.1194071803402639, 0.0], [0.6348086615320038, 1.067716881283442, 0.0], [-0.2107742164315626, -1.117798847886273, 0.0], [-0.20588817241320545, -1.226110231251908, 0.0], [-0.11163340952974135, -1.1870737620899483, 0.0], [-0.2931400736128509, -1.2440731852855018, 0.0], [-0.1939992667110296, -1.3133480994891769, 0.0], [0.33365787805038816, -1.2183737988932486, 0.0], [0.31781386668935974, -1.10330208124144, 0.0], [0.5654969868121512, 1.2985531950276714, 0.0], [-1.0304977596847291, 0.5581107542641719, 0.0], [-1.031201652831696, 0.6609767106692284, 0.0], [-1.107078446271207, 0.6134318732079027, 0.0], [-0.47801114980108617, 1.1989066214389164, 0.0], [-0.4208069114792894, 1.1087756529375625, 0.0], [-0.22881263363271295, 1.1402882950047837, 0.0], [-0.19833258984111687, 1.2426619619689308, 0.0], [1.126132589932023, 0.3082284684174934, 0.0], [1.2098275146150685, 0.3438815505714327, 0.0], [-1.1686877574237768, 0.6613330399776359, 0.0], [-1.1679838642768101, 0.5584670835725796, 0.0], [-0.2385202281203828, -1.4092391727917422, 0.0], [1.296545617642893, 0.3606550665225848, 0.0], [1.206071421398132, 0.42972650299431336, 0.0], [-0.6837915056138795, 1.049733705775458, 0.0], [-0.5784110143077683, 1.0520082683031493, 0.0], [-0.6271754976847502, 1.1186533661088656, 0.0], [-0.5667352085655301, 1.1806414803859169, 0.0], [-0.6721156998716412, 1.1783669178582257, 0.0], [-1.2700192603299172, -0.14579564118178168, 0.0], [-1.1900828478788357, -0.10257033274535236, 0.0], [-1.2851944872430507, -0.049764184498890245, 0.0], [0.4733385510016235, -0.984425785813379, 0.0], [0.3970637119664836, -1.042421595575289, 0.0], [0.4850346628513291, -1.0827584629578282, 0.0], [-0.010045193747094951, -1.3201642208598923, 0.0], [0.04332848900859037, -1.4224716481321005, 0.0], [-0.7002389003744557, -0.9834620682575475, 0.0], [-0.6191931461158736, -0.9339991240086409, 0.0], [-0.7190466628461959, -0.8873834644921816, 0.0], [-1.0189792741440815, -0.9666957103154536, 0.0], [-1.0836641934725961, -0.8929366961820833, 0.0], [-1.2526393737959143, -0.24309399947732546, 0.0], [-1.3477510131601294, -0.19028785123086334, 0.0], [0.30611775483965414, -1.004969404096991, 0.0], [0.0756786652621074, -1.256809988416526, 0.0], [0.17260645515089074, -1.32046831066548, 0.0], [-1.1984950317664587, 0.3639543721846618, 0.0], [-1.294161338480584, 0.3477404653129008, 0.0], [-1.2185026872152365, 0.27659770187609706, 0.0], [1.240196825678269, -0.6607355128868435, 0.0], [1.1404090240713263, -0.6639892355667278, 0.0], [1.1992503040697127, -0.7532537226798885, 0.0], [0.954635674854682, 0.9582261007015334, 0.0], [1.045422175951463, 0.9699185763988634, 0.0], [0.9698736706830418, 1.0489676960824896, 0.0], [-1.1902641180780233, 0.4728315262121559, 0.0], [-1.1146054668126757, 0.40168876277535215, 0.0], [1.0742138178744736, 0.8070987701148508, 0.0], [0.9807379654377143, 0.7901697124285088, 0.0], [1.0247676031890847, 0.7180915015254523, 0.0], [0.49344918869909904, -1.1762720210910338, 0.0], [0.5697240277342389, -1.1182762113291238, 0.0], [1.406362402329904, -0.14157381523636983, 0.0], [1.3190486582812586, -0.1790512688551656, 0.0], [1.3998535480120702, -0.2332667419488746, 0.0], [0.944174822664097, 0.8710777163827531, 0.0], [0.894728607978708, 0.7820704477933547, 0.0], [1.0534874372245537, -0.6941349030834476, 0.0], [0.9538561862073663, -0.7083629951765817, 0.0], [0.9998312514455826, -0.770735537452907, 0.0], [0.8686263173956758, 0.9501268360663793, 0.0], [-1.0436474058180756, -0.7942005786493678, 0.0], [-1.1500132227823405, -0.8144060259803547, 0.0], [1.2835874222234058, -0.5727480871606598, 0.0], [1.4127787562995462, -0.04367917107133041, 0.0], [-0.6804548595547054, -1.0744215945481699, 0.0], [-0.7803083762850277, -1.0278059350317106, 0.0], [-1.1994613965436465, -0.4821989494853614, 0.0], [-1.1052624556162756, -0.45294589575275246, 0.0], [0.964344846252307, -0.8430048349482546, 0.0], [1.0639760972694945, -0.8287767428551205, 0.0], [1.1588448197353143, -0.27249490311724484, 0.0], [1.0767059515560276, -0.2303036480660595, 0.0], [1.0814610010155619, -0.32966479455127407, 0.0], [1.3206623939603188, 0.00654994740239005, 0.0], [1.237111393757495, -0.035676965268480444, 0.0], [0.28606546125619936, -0.8039231833332574, 0.0], [0.2959043660103071, -0.9030039190297272, 0.0], [0.37552869536267025, -0.8450081827343701, 0.0], [0.21665452073318328, -0.9638844046958782, 0.0], [0.4645245786883371, -0.885889050214385, 0.0], [0.4546856739342293, -0.7868083145179152, 0.0], [0.7642110486947958, -0.4599586950132915, 0.0], [0.7713930727516176, -0.5519141505484153, 0.0], [0.851404288750042, -0.4957436470178497, 0.0], [0.9355150569162968, -0.5317303139560665, 0.0], [0.9283330328594751, -0.4397748584209428, 0.0], [0.6937951105990562, -0.6149460198152332, 0.0], [0.7809883506543024, -0.6507309718197914, 0.0], [0.6753185860651912, -0.41929332444579465, 0.0], [0.5866617504384357, -0.3795513386952528, 0.0], [0.5955429970696159, -0.4763872127933152, 0.0], [0.7553298020636158, -0.3631228209152291, 0.0], [0.6047836051680302, -0.5740985468658931, 0.0], [0.5161267695412747, -0.5343565611153513, 0.0], [0.12625033399596383, -0.9176369938560024, 0.0], [0.1169293518072703, -0.8199762426692792, 0.0], [0.03673855389939781, -0.8756943168966669, 0.0], [0.19684275762009382, -0.7630887741875436, 0.0], [0.10733097752352783, -0.7211460972282081, 0.0], [0.08868992196564687, -0.5258119494527187, 0.0], [0.09800895919699817, -0.6234877237570533, 0.0], [0.17792534610500008, -0.5665828544421379, 0.0], [0.1364637228253108, -1.019602478923266, 0.0], [0.018095553384174633, -0.6803751922387888, 0.0], [0.26716290574316154, -0.6073404479778417, 0.0], [0.2578438685118103, -0.5096646736735071, 0.0], [0.7371125195002867, -0.16796673169690624, 0.0], [0.6572297361691231, -0.22492525646841405, 0.0], [0.7463201227651748, -0.2654989255762245, 0.0], [0.21123900867442594, -0.02135969201645858, 0.0], [0.2019179900820635, 0.0763011965195941, 0.0], [0.12200160164375203, 0.019398492448834997, 0.0], [0.6387423035286186, -0.029780546543764237, 0.0], [0.7279796233243597, -0.07053874401904436, 0.0], [0.7186997939487434, 0.0270737720262872, 0.0], [0.5402250736336879, 0.10859008385627633, 0.0], [0.46030825708575884, 0.05168682788656323, 0.0], [0.5495456576050731, 0.01092871353185423, 0.0], [0.8352125853947794, -0.30616429614372137, 0.0], [0.37107153511355545, 0.09244560513264294, 0.0], [0.38039211908494075, -0.005215765191779176, 0.0], [0.28183429295240825, 0.13320390105859364, 0.0], [0.19259688592173438, 0.17396208552388726, 0.0], [0.300475912598106, -0.06211838556469221, 0.0], [0.22055952415979457, -0.11902108963545131, 0.0], [0.47894761215334747, -0.1436377499973157, 0.0], [0.38971263457030936, -0.10287716281077192, 0.0], [0.39903140566651274, -0.20054037037022876, 0.0], [0.40835055200047343, -0.2982031228961537, 0.0], [0.3191155744174354, -0.2574425357096099, 0.0], [0.5588254869806896, -0.08668380251347735, 0.0], [-0.07114244592180016, -0.639616777166271, 0.0], [-0.08046347718995006, -0.5419558885072737, 0.0], [-0.16037945816939522, -0.5988558469059105, 0.0], [0.5681442580768928, -0.1843470100729342, 0.0], [0.577351861341781, -0.2818792039522524, 0.0], [0.8170700099204115, -0.11111241312685483, 0.0], [-0.0005473010891995579, -0.4850533814836997, 0.0], [-0.0897843133367946, -0.44429245122333927, 0.0], [-0.10842636604641138, -0.24897061384815855, 0.0], [-0.09910538022218503, -0.3466316104322565, 0.0], [-0.019189123060270447, -0.28972894761566736, 0.0], [-0.06182042759527051, -0.7372751506374258, 0.0], [-0.17902155632293554, -0.40353411745583045, 0.0], [0.07004785275171038, -0.3304875479153871, 0.0], [0.060726866927484024, -0.23282655133128916, 0.0], [-0.2682588852183681, -0.36277592390244523, 0.0], [-0.2775799145443669, -0.265115039160653, 0.0], [-0.357496176554409, -0.32201768639835054, 0.0], [-0.19766363689568886, -0.20821235518914252, 0.0], [-0.28690092823172986, -0.16745411768504787, 0.0], [-0.2589378183329777, -0.460436764693528, 0.0], [-0.11774737973377429, -0.15130969237255343, 0.0], [-0.1270683540228761, -0.05364873460059308, 0.0], [-0.0378310831735986, -0.0944069932596091, 0.0], [-0.29622194916489253, -0.06979325104899933, 0.0], [-0.37613822681357056, -0.1266959350205098, 0.0], [-0.3055429701569296, 0.0278676530430127, 0.0], [-0.21630567157508881, -0.01289052962152536, 0.0], [-0.32418443457551516, 0.22318859777422656, 0.0], [-0.31486340403557495, 0.12552770665318158, 0.0], [-0.23494772310706605, 0.18243126559153167, 0.0], [-0.3947796816253787, 0.06862498522570759, 0.0], [-0.1550314258575395, 0.2393339612440252, 0.0], [-0.1457103953175993, 0.14167307012298022, 0.0], [-0.511975070904881, 0.4023587853087225, 0.0], [-0.43205216064309854, 0.4592521900228284, 0.0], [-0.5212898994031478, 0.5000109621483108, 0.0], [-0.17366768439086433, 0.43464758899880024, 0.0], [-0.2535839800516569, 0.3777448931714961, 0.0], [-0.16435245798621373, 0.33699485253988076, 0.0], [-0.3428182693005696, 0.4184988214068278, 0.0], [-0.33350304289591903, 0.3208460849479084, 0.0], [-0.013835665926975495, 0.5484537847610147, 0.0], [-0.09375196175444062, 0.4915510887921145, 0.0], [-0.004519866497956079, 0.4508002443360852, 0.0], [-0.5026561113753123, 0.3047008069206681, 0.0], [-0.5918938501353616, 0.3454595790461505, 0.0], [-0.3521330977988364, 0.5161509982464161, 0.0], [-0.18298348381988375, 0.5323011294237298, 0.0], [0.08471746265320973, 0.4100420503056096, 0.0], [0.004801166825744605, 0.3531393543367093, 0.0], [0.06607539595703639, 0.6053638296255561, 0.0], [0.15531272371543617, 0.5646056358308913, 0.0], [0.1459916903429635, 0.6622665251514621, 0.0], [-0.023156699299448167, 0.6461146740815855, 0.0], [0.16463375932500326, 0.4669447475317871, 0.0], [0.2445500537109304, 0.5238474430576929, 0.0], [0.5630800493683977, 0.7485908151786462, 0.0], [0.6537659867469999, 0.7087122126326856, 0.0], [0.6435152115649478, 0.8047194998484638, 0.0], [0.4841962160333616, 0.6939486249593827, 0.0], [0.47394544085130963, 0.7899559121751609, 0.0], [0.8251547177868926, -1.1466394138917204, 0.0], [0.7435836460303508, -1.2011434615116232, 0.0], [-0.7943617068620848, -0.2158877100641638, 0.0], [-0.8742780236411837, -0.2727903749132489, 0.0], [-0.7850407218182679, -0.3135485331605832, 0.0], [0.11579034037459127, 0.9524244924745195, 0.0], [0.10591267049909278, 1.045153272841151, 0.0], [0.028234628079986245, 0.9910752779907029, 0.0], [-0.7663986850961132, -0.5088702729374597, 0.0], [-0.7570776564875602, -0.6065311572178396, 0.0], [-0.6771613569542123, -0.5496284681481695, 0.0], [1.1447462564498094, -0.8348247944364293, 0.0], [-0.8313925454281986, -0.6613920333018669, 0.0], [-0.7421552172862977, -0.7021502285125767, 0.0], [-0.9565512433798055, -0.2313675215754344, 0.0], [-0.9472302583359885, -0.32902834467185377, 0.0], [-1.0295942954844661, -0.40186462754570146, 0.0], [-0.9473210757458445, -0.44328748088351605, 0.0], [0.4935172489891723, 0.5962877360463167, 0.0], [0.4043826404720843, 0.6376528330428314, 0.0], [-0.8036826297146894, -0.11822697431143335, 0.0], [-0.7144453278917736, -0.1589851325587676, 0.0], [-1.2045172704022424, -0.732834954223814, 0.0], [0.8222592431787284, 1.1489682518058109, 0.0], [0.20502766762533148, 0.9116662984861421, 0.0], [0.12734962520622495, 0.8575883036356939, 0.0], [0.6626708704052722, 0.6124322370130734, 0.0], [0.7431060326018223, 0.6685609216828909, 0.0], [-1.2034102225474146, 0.733148914806482, 0.0], [-1.1489061749275118, 0.814719986563022, 0.0], [-1.1386025604657632, 0.04446967197591563, 0.0], [-1.128840805748249, -0.04961547319493502, 0.0], [-1.0621852914220429, 0.0013930748434415163, 0.0], [-0.69974922486751, 0.58150582138666, 0.0], [-0.6904320827831811, 0.4838503954874332, 0.0], [-0.6105299517492592, 0.5407729833334316, 0.0], [-0.855636011613414, -0.46811208000839893, 0.0], [-0.775719712080066, -0.41120939093872894, 0.0], [1.0328587036110983, 0.3538842283718889, 0.0], [1.0218840054089786, 0.45047841554382906, 0.0], [0.9353893906497688, 0.39140965687255663, 0.0], [-1.400668142995038, 0.22808654166721065, 0.0], [-1.3815288666814811, 0.32430618132906236, 0.0], [-0.840227660612465, 0.27188562203316347, 0.0], [-0.8309097731669952, 0.17422914932080794, 0.0], [-0.751724996030741, 0.23165216001784975, 0.0], [-0.9870939660726513, 0.05783509205249099, 0.0], [-0.9773322113551371, -0.036250053118359674, 0.0], [0.858508535378083, 0.3358873196962919, 0.0], [0.8475338371759632, 0.43248150686823206, 0.0], [-0.8223239972955083, 0.077093825698092, 0.0], [-0.8130035683750618, -0.020566216357673674, 0.0], [-0.7330866796648248, 0.03633564524972854, 0.0], [-0.3235436483252633, 1.3751297253002326, 0.0], [-0.22732400866341132, 1.394269001613789, 0.0], [0.38574057506483195, 0.8329746112124271, 0.0], [0.29650324753517776, 0.8737328050581367, 0.0], [0.3058242799866193, 0.776071915801607, 0.0], [0.28494396270354405, 0.9685689938969623, 0.0], [-0.450667405562721, 0.6545363026092655, 0.0], [-0.36143434363325044, 0.6137840990329908, 0.0], [-0.3707347600546061, 0.7114160347798397, 0.0], [-0.8929199473453729, -0.0774687938630699, 0.0], [0.7961833070743204, 0.8139096745250511, 0.0], [0.8327464498479377, 0.7330016705708067, 0.0], [1.3807142716985135, -0.32948638161072635, 0.0], [0.761331949082186, 0.474620057877623, 0.0], [0.6720946216143173, 0.5153782509973093, 0.0], [0.6814156544364087, 0.41771736281165356, 0.0], [0.5827545757594949, 0.5555295419471038, 0.0], [0.7000577220952893, 0.22239559129557507, 0.0], [0.7799740141703945, 0.27929828046549493, 0.0], [0.6907366898291722, 0.32005648052204744, 0.0], [0.8678295676442, 0.23822643046981956, 0.0], [0.9563161516033424, 0.1973965792900389, 0.0], [0.8777816303956537, 0.14080754005924195, 0.0], [-0.11239402664571446, 0.6868728680335154, 0.0], [-0.03248296476170258, 0.7437829128980569, 0.0], [-0.7064098539353438, 0.6753970191052712, 0.0], [-0.7863119849692658, 0.6184744312592726, 0.0], [-0.9680112726947648, -0.13391081107211936, 0.0], [-0.2496167873280982, -0.5580976528952064, 0.0], [-0.24029575605994827, -0.6557585415542035, 0.0], [1.374595225146716, 0.33151934087674223, 0.0], [1.3937345014602727, 0.23529970121489058, 0.0], [0.32339224996917926, -1.3724410322501819, 0.0], [0.22717261030732674, -1.391580308563738, 0.0], [0.8382128043538718, 0.5301423950538877, 0.0], [0.798616080090498, 0.08397648289501485, 0.0], [0.7093787602947569, 0.12473468037029498, 0.0], [0.04743333027002422, 0.800685608285099, 0.0], [0.13667065752076443, 0.7599274142967216, 0.0], [0.5455351272029896, 0.9360626858932692, 0.0], [0.45733026141651195, 0.9790813849305354, 0.0], [0.464624408399868, 0.8876168014316906, 0.0], [0.2711605890935662, 1.0726280940297146, 0.0], [0.3626361690034125, 1.0346946006017093, 0.0], [-0.041803997076242085, 0.8414438022370291, 0.0], [-0.29069477015201106, 0.7681450084272992, 0.0], [-0.20161099511655223, 0.7276024690267759, 0.0], [-0.21080406714342773, 0.8250836462505101, 0.0], [-0.1922847296542978, 0.6299342302103046, 0.0], [-0.38692569456080805, 0.9032953540083184, 0.0], [-0.4669656844634031, 0.846566380360859, 0.0], [-0.3799278320814816, 0.8088972120035739, 0.0], [-0.6531704424489627, 0.09323842184040748, 0.0], [-0.5732543334592235, 0.1501413785167084, 0.0], [-0.662490999595532, 0.19089864398179512, 0.0], [-0.33885411622353073, -0.5173394593418211, 0.0], [0.22732400866341598, 1.3942690016137884, 0.0], [0.323543648325268, 1.3751297253002317, 0.0], [-0.82284906625197, 1.1532044070090146, 0.0], [-0.7412779944954296, 1.207708454628917, 0.0], [-0.3347398677822351, -1.3900998964781845, 0.0], [0.8871026640496403, 0.04314663171523419, 0.0], [-0.050203715842538015, 0.9378107641467648, 0.0], [-0.1301200108742648, 0.8809080687597226, 0.0], [-0.06008138571803649, 1.0305395445133965, 0.0], [-0.21920378590972364, 0.9214506081602458, 0.0], [0.9127625194663068, -0.24800697015240272, 0.0], [0.9917381866462327, -0.18993955687222214, 0.0], [0.9051785732762644, -0.1504729875245361, 0.0], [1.0058829669310025, -0.3816175324296242, 0.0], [0.9217721987647477, -0.34563086549140737, 0.0], [-0.5530653294713185, 0.8829123413526808, 0.0], [-0.5460674669919919, 0.7885141993479363, 0.0], [-0.8595650805809962, 0.4676769282489394, 0.0], [-0.8502608443683857, 0.3700396278437113, 0.0], [-0.7703471196888214, 0.42694593313543333, 0.0], [-0.6345290342639749, -0.10208243519512387, 0.0], [-0.5546127970481128, -0.045179658604444936, 0.0], [-0.6438500135285162, -0.004421620215358193, 0.0], [-0.6252081114113702, -0.19974317094785432, 0.0], [-0.6958033953009671, -0.3543067260896438, 0.0], [-0.052499397047107654, -0.8349360398319018, 0.0], [-0.14173739635308244, -0.7941776247593839, 0.0], [0.6201414359535347, 0.16549288042684743, 0.0], [0.84165133350621, 0.6367216949511945, 0.0], [0.8960456771003374, -0.05304499984667424, 0.0], [-0.5306070414874766, 0.5976663880475376, 0.0], [-0.6811278465705706, 0.3862130950822051, 0.0], [-0.9294456215046398, 0.3126166171466695, 0.0], [-0.6065660950272007, -0.39506488216129265, 0.0], [-0.6158871047654026, -0.2974040243831469, 0.0], [-0.043178414858414144, -0.932596791018625, 0.0], [-0.4978792766606843, 1.0309462255010802, 0.0], [-0.39689118176133464, 1.018793949802086, 0.0], [-1.0409635073895696, -0.19014878083072417, 0.0], [0.22590798527916423, 0.7191692205020569, 0.0], [0.3151453128088184, 0.6784110266563473, 0.0], [0.6014993623613035, 0.36081467364173364, 0.0], [0.44354688780653406, 1.083140485063288, 0.0], [1.0664097576860438, -0.0382005813193278, 0.0], [1.0574667446353467, 0.05799105024258063, 0.0], [0.9752112274054932, 0.0037860573175528796, 0.0], [-0.27220045229072154, 0.5730307304169903, 0.0], [-0.5399074579088322, 0.6952983237943864, 0.0], [-0.5972450620447254, -0.4927257725845744, 0.0], [-0.5173287715091609, -0.43582307087807753, 0.0], [-0.7272355074072748, -0.7974658124199396, 0.0], [-0.6529206184666366, -0.7426049363359123, 0.0], [-0.22165369338130866, -0.8510803199753829, 0.0], [-0.2309747239294715, -0.7534194307809068, 0.0], [-0.12446790967650906, -0.9853004463390864, 0.0], [-0.03522995873000358, -1.0260587234038516, 0.0], [-1.0229266791924003, 0.4606682698800318, 0.0], [-1.0311575928808359, 0.3517911158525377, 0.0], [0.9278532215999872, 0.5945831439418036, 0.0], [-0.6718088870410018, 0.2885551166941507, 0.0], [-0.9108266618772323, 0.11732728771340573, 0.0], [-0.4653755327651524, -0.08593777098433594, 0.0], [-0.47469651202969376, 0.01172304399542973, 0.0], [-0.44673350518602206, -0.2812594910556771, 0.0], [-0.4560545118319897, -0.18359863762038447, 0.0], [-0.5359708111376039, -0.24050132701950322, 0.0], [-0.47668443696913787, -0.8261459198138812, 0.0], [-0.3874471097379714, -0.8669041137455218, 0.0], [-0.40012834818886417, -0.7695639320652653, 0.0], [-0.4574069891111815, -1.018293219687617, 0.0], [-0.37381710358325426, -1.0549413133267107, 0.0], [-0.3804133129903179, -0.9601341951332313, 0.0], [-0.5879240334361725, -0.5903866568649543, 0.0], [-0.32021205308817446, -0.7126612367702025, 0.0], [-0.9380000487618915, -0.5409483628822467, 0.0], [-0.21461989663365508, -0.9443104013630924, 0.0], [-0.20667144050524452, -1.037772333748319, 0.0], [0.0553799442975559, -1.0710158743261204, 0.0], [0.5215830687856392, 0.30391198004250813, 0.0], [0.5122620333928757, 0.40157286233211426, 0.0], [0.5029410001982174, 0.4992337500305526, 0.0], [-0.40944938031934097, -0.6719030428385622, 0.0], [-0.4187704118726684, -0.5742421544224294, 0.0], [-0.4986867069733581, -0.6311448497174921, 0.0], [-0.5636832920038222, -0.78336312918845, 0.0], [-0.5510020535529294, -0.8807033108687065, 0.0], [-0.30385722421004413, -0.9035522073846154, 0.0], [-0.7234102844361286, 0.8685858926326867, 0.0], [-0.8038130354547249, 0.8123386269517495, 0.0], [-0.7125698630185036, 0.768612894658821, 0.0], [-1.0211244091249152, 0.2536371100419898, 0.0], [-1.0973917133203341, 0.1941449143810751, 0.0], [-0.9956797419441382, 0.15497041567520692, 0.0], [1.1541367330313488, 0.824081351362437, 0.0], [1.2086407806512511, 0.7425102796058966, 0.0], [-1.3896299330298658, -0.3379073885900887, 0.0], [-1.4087692093434216, -0.24168774892823744, 0.0], [0.32446634576462907, 0.5807501377432813, 0.0], [-0.22916927311025023, 1.0369492039540134, 0.0], [-0.3098533293794132, 0.9811247814448009, 0.0], [-0.6260071029167477, 0.7316442847862084, 0.0], [-0.42809144287754786, -0.47658126622075103, 0.0], [-0.02590955052053902, -1.123719529646582, 0.0], [-0.4374124758600232, -0.3789203757974693, 0.0], [-0.5786030018828451, -0.688047545281087, 0.0], [-0.7552621677326459, -1.2089017834994915, 0.0], [-0.8368332394891852, -1.1543977358795883, 0.0], [0.33378738137419617, 0.4830892494441771, 0.0], [0.4230247066225532, 0.4423310564313271, 0.0], [0.34310841456885444, 0.38542836174573875, 0.0], [0.35242946430464533, 0.28776747939788777, 0.0], [0.26319213905628835, 0.32852567241073777, 0.0], [0.17395479264870395, 0.3692838575324112, 0.0], [0.18327584238449482, 0.27162297518456024, 0.0], [-0.07511513019674698, 0.29623665707132935, 0.0], [0.014122198954418822, 0.2554784630408537, 0.0], [-0.13638937501491313, 0.04401216949141896, 0.0], [0.10335953951414999, 0.2147202706455607, 0.0], [-0.4933375030549084, 0.20704331974698625, 0.0], [-0.4134187238244279, 0.2639425260095583, 0.0], [-0.4840169459083391, 0.10938309760559861, 0.0], [-0.056473077765386584, 0.1009148651439125, 0.0], [0.023443242491658394, 0.1578175733801807, 0.0], [0.03276426279434458, 0.06015667274861946, 0.0], [0.042085281386707044, -0.03750421578743323, 0.0], [0.05140625567580885, -0.13516517355939356, 0.0], [0.14064323148778965, -0.17592377385911329, 0.0], [0.22988013541146976, -0.21668246740734692, 0.0], [0.2391992817454305, -0.31434521993327186, 0.0], [0.07936908581880235, -0.42814851216878425, 0.0], [0.1592850758065568, -0.37124611588440604, 0.0], [0.24852051481252246, -0.412006184186669, 0.0], [0.36175043095322634, 0.19010649413693606, 0.0], [0.44166670646579254, 0.24700918347193704, 0.0], [0.5309040354342203, 0.20625099478155642, 0.0], [0.4975762723462055, -0.33897309229977296, 0.0], [0.4176604410971282, -0.3958752576391541, 0.0], [0.33775807445068395, -0.4527637777223728, 0.0], [0.426983794796416, -0.4935337471259921, 0.0], [0.4362244028948304, -0.59124508119857, 0.0], [0.2764670869724569, -0.7050930378921864, 0.0], [0.3563856093792671, -0.6481748571235555, 0.0], [0.44552858412412577, -0.6889976711129147, 0.0], [0.8793931566176295, -0.6863313660495072, 0.0], [0.8017951944650682, -0.7493632353163253, 0.0], [0.5345244674497925, -0.7298785385929296, 0.0], [0.614378883070715, -0.6729153681372693, 0.0], [0.8097961884296818, -0.8473136651948092, 0.0], [0.7113913824663547, -0.8117132709650935, 0.0], [0.6235359728808186, -0.7707260115422698, 0.0], [-0.873796790141159, 0.6590106103516906, 0.0], [-0.8671361610733251, 0.5651194126330794, 0.0], [-0.9470498857528894, 0.5082131073413574, 0.0], [0.6315369668454321, -0.8686764414207538, 0.0], [0.5524955295731825, -0.9262259175969242, 0.0], [0.6403509391587187, -0.9672131770197478, 0.0], [0.6220218321332052, 0.9823209103131352, 0.0], [0.7185895134455754, 1.0225105222044633, 0.0], [0.7282798342458389, -1.0064562590950807, 0.0], [0.6492383969735892, -1.064005735271251, 0.0], [0.8057440758521156, -0.9498102561985966, 0.0], [0.8961478878508291, -0.8874602205498283, 0.0], [1.039637975172813, 0.249159709746221, 0.0], [1.0495900379242669, 0.15174081933564343, 0.0], [1.2333147871196024, -0.22193897609985028, 0.0], [1.2380698365791367, -0.32130012258506485, 0.0], [0.9763779735265401, -1.0253084916667206, 0.0], [0.9026189593931693, -1.0899934109952363, 0.0], [0.8146315336669862, -1.0466028144500998, 0.0], [-0.13816309016302344, 1.0806141217202285, 0.0], [1.2511870395625337, 0.5144916481642566, 0.0], [1.1644689365347096, 0.4977181322131046, 0.0], [1.0691220053659851, -0.13276966543819288, 0.0], [-0.7248402395546237, 0.9477001164476784, 0.0], [-0.7736047229316058, 1.0143452142533949, 0.0], [1.131738722452362, 0.5852444702441129, 0.0], [1.0866231042879604, 0.5004793250741696, 0.0], [0.2092655548569899, 1.2424103966654978, 0.0], [0.2542625880553312, 1.1611018914492979, 0.0], [0.3038557621950933, 1.2200622059506616, 0.0], [-0.02102350650218188, -1.2320309130122171, 0.0], [0.06115772552445045, 1.3220132398344167, 0.0], [0.06212212447241038, 1.4296390690873488, 0.0], [-0.0009643989479575062, 1.3923741707470678, 0.0], [-0.06303479460211836, 1.4299488788498171, 0.0], [-0.0639991935500783, 1.322323049596885, 0.0], [0.6293159791165612, 0.8908563268142904, 0.0], [0.7819840746259338, 0.9000465014908776, 0.0], [0.7200019164951634, 0.8509777242683296, 0.0], [0.7924449268165189, 0.987194885809658, 0.0], [1.2398236414374362, -0.13024604938734552, 0.0], [-0.9747568358117852, 0.827797310878442, 0.0], [-0.879787081539433, 0.8343027630700239, 0.0], [-0.9096232111447021, 0.9058061727340333, 0.0], [0.008214080154285165, 1.1842761999257352, 0.0], [-0.06986762429070179, 1.2343507771325672, 0.0], [-0.059724746240499185, 1.1338786355641668, 0.0], [0.17657038175546277, 1.094976284744551, 0.0], [-0.5321942910811893, -0.9767819146340722, 0.0], [1.0944339588331098, -0.6016166932904026, 0.0], [1.1513775225958387, -0.07856467251316515, 0.0], [-0.9022725120558402, -0.6217782499962343, 0.0], [-0.5544952845898136, 0.9620265651676725, 0.0], [-0.6335970671184025, 0.9039743841547498, 0.0], [-1.1051716382064196, -0.33868675954109023, 0.0], [-0.8689466601218078, 0.7343297650961582, 0.0], [0.9330493423966005, -0.6097307316800479, 0.0], [-0.3009262033887087, -1.076808802910279, 0.0], [-1.1136655788351155, -0.14564692987782646, 0.0], [0.6576529228213591, -1.1575192934044567, 0.0], [0.08901466946085776, 1.1336270702607343, 0.0], [0.07887179141065516, 1.2340992118291347, 0.0], [1.096899673352806, -0.5236162755664212, 0.0], [1.1724777074373653, -0.471663537688071, 0.0], [1.0880218351102893, -0.42380878748080947, 0.0], [0.1412231331736303, -1.416055294162459, 0.0], [-1.2651986429560789, 0.20265257802558245, 0.0], [-1.1695323362419536, 0.2188664848973434, 0.0], [0.4529108102350497, 1.1750203960114378, 0.0], [-0.808281261665857, -0.8469287566688461, 0.0], [-0.8210335483897399, 1.0767387278949836, 0.0], [-0.8620822823304841, 0.9747051385672039, 0.0], [-0.8968842413676338, -0.8148711767238501, 0.0], [-0.8886953968065547, -0.9047888287960921, 0.0], [0.6640692767910005, -1.255413937569496, 0.0], [0.5760818510648176, -1.2988045341146315, 0.0], [-1.0561876524176141, 0.8077992750777052, 0.0], [-1.097311487926952, 0.9062214320277682, 0.0], [1.1639140051624774, 0.6587519182974211, 0.0], [1.254311330187885, 0.6662416386915233, 0.0], [-1.0326265685984364, 0.9799804461611377, 0.0], [1.297701926733021, 0.5782542129653407, 0.0], [-1.2585605502128643, -0.6623149356112852, 0.0], [-1.3019511467579992, -0.5743275098851028, 0.0], [0.350457061637266, -1.298823905461583, 0.0], [0.425559007403067, -1.2212043792880727, 0.0], [-0.9677642079952754, -0.7752573934182176, 0.0], [-0.8873500728545777, -0.7173973212909717, 0.0], [1.0099780865060337, -0.553761943083141, 0.0], [-0.13193801994486265, 1.2719254852353166, 0.0], [0.14195831483102303, 1.271364110169416, 0.0], [1.3708391319297795, 0.41736429329962293, 0.0], [-0.6725538045072056, -1.2537298281775127, 0.0], [-0.677815972239837, -1.1635935060003546, 0.0], [-1.3615212112327035, 0.4116628516376271, 0.0], [-1.3299864908993668, 0.5045611420845533, 0.0], [0.5102483722859769, -1.2567221276593683, 0.0], [1.3393044115964434, 0.5102625837465495, 0.0], [-0.5845663787810228, -1.29712042472265, 0.0], [-0.35682993830080917, -1.3026868848723019, 0.0], [-0.41031863817236924, -1.3614757278277159, 0.0], [0.989153791326631, 0.5380047535748373, 0.0], [1.4014672836911304, 0.148123762638759, 0.0], [1.4078836376607726, 0.05022911847372047, 0.0], [-0.9836772323365439, -1.0490288165463368, 0.0], [-0.9419963347007939, -0.9550643550819793, 0.0], [-0.5041262208855829, 1.3313523065041035, 0.0], [-0.41122793043865613, 1.3628870268374396, 0.0], [-1.4247511869877485, 0.04204052440561386, 0.0], [-1.4183348330181058, 0.13993516857065175, 0.0], [0.8052317562153174, 1.072590856779965, 0.0], [1.109259851256534, -0.9070940919317769, 0.0], [0.3833956428808664, 1.2196250576073289, 0.0], [0.3383986096825251, 1.3009335628235288, 0.0], [0.9602927336747408, -0.9455014259520419, 0.0], [1.0445749319280182, -0.9808531060651468, 0.0], [-1.2643156405530176, 0.6781841251711589, 0.0], [-1.1022055495201561, -0.24310364038114152, 0.0], [-1.1778737096519656, -0.2941849085881925, 0.0], [-1.255605462482178, -0.3386771186372742, 0.0], [-0.9570520366028362, 0.9681996863756219, 0.0], [0.8961146565496719, 1.1136526154110054, 0.0], [-1.1440876690611765, 0.1201997905305605, 0.0], [1.3072778750417648, -0.35564417230893103, 0.0], [1.3754523427768535, -0.41438635835198706, 0.0], [-1.4261490958774246, -0.14438939063269368, 0.0], [0.4152933793218581, -1.375271612645006, 0.0], [-0.9113266256508483, 1.1135643313228236, 0.0], [-0.8336093141792668, -1.078081461317598, 0.0], [-0.9099182182031746, -1.113713735874853, 0.0], [1.1101070952799788, 0.8961595622654934, 0.0], [-0.6808377053762095, 1.2696965689059678, 0.0], [0.16001676863744912, 1.4232227151177064, 0.0], [-0.16092943876715712, 1.4235325248801751, 0.0], [0.4030835290110411, 1.3746925769568987, 0.0], [0.4959818194579679, 1.3431578566235625, 0.0], [-1.3819770084074028, -0.41632078157901636, 0.0], [-1.3227182020036636, -0.36599960251533487, 0.0], [-0.1924641591004934, 1.3306342344332482, 0.0], [-1.4325654498470661, -0.04649474646765503, 0.0], [-1.3573166368348146, -0.004454222062050694, 0.0], [-0.5032169286192962, -1.3299410074943787, 0.0], [0.9925923204789692, 0.6445840534721441, 0.0], [1.0860681729157284, 0.6615131111584862, 0.0], [-1.247952537859715, -0.41709051162620187, 0.0], [-1.2665741360651321, -0.5095214333634221, 0.0], [-0.5928502796500268, 1.3130871654511038, 0.0], [-0.522951351987977, 1.2586201731882765, 0.0], [-0.5255980816741257, -1.0715890328275517, 0.0], [-1.3318356839524292, 0.17223242190777713, 0.0], [-1.3077062370981536, 0.5901966994449769, 0.0], [-1.277380224383733, 0.03877108637437864, 0.0], [1.2328079076574767, -0.40620009932632556, 0.0], [-1.251873429230593, 0.5207326929818892, 0.0], [-0.36871884400298505, -1.2154490166350331, 0.0], [-0.597746496329265, -1.1192496392261913, 0.0], [1.343917622443517, -0.5072846487989143, 0.0], [-0.51375815885267, -1.2412421334501045, 0.0], [-0.44160974419753063, -1.1935815270514647, 0.0], [-0.5229591943592572, -1.160760944279736, 0.0], [-0.8533933549990171, -0.9871219350269753, 0.0], [0.4874536577224815, 1.2558917528843048, 0.0], [-0.9497708362258671, 0.6809747464699651, 0.0], [-1.026351522812345, 0.736295865413696, 0.0], [0.5081916697687855, -1.3437368923116704, 0.0], [-0.9850856397842184, 1.0488794119943083, 0.0], [-0.3779198795095723, -1.1349678274646648, 0.0], [-1.2107431833873825, 0.06919124249218395, 0.0], [0.1915514889707852, 1.3303244246707795, 0.0], [-1.3504422880740676, -0.5092190720259433, 0.0], [1.2416857458999937, -0.5060075874119372, 0.0], [-1.2828653329791464, 0.1145012049290235, 0.0]], "faces": [[8, 260, 97], [224, 266, 104], [192, 274, 251], [104, 281, 224], [102, 197, 196], [103, 275, 228], [36, 264, 35], [251, 274, 101], [97, 260, 199], [195, 288, 264], [264, 288, 111], [102, 200, 197], [9, 260, 8], [242, 250, 98], [228, 275, 229], [228, 254, 103], [218, 251, 101], [98, 279, 242], [35, 264, 111], [101, 268, 218], [106, 283, 229], [229, 292, 106], [285, 293, 222], [113, 204, 200], [263, 264, 36], [261, 277, 238], [30, 262, 29], [100, 293, 285], [200, 204, 197], [196, 263, 102], [241, 270, 105], [44, 257, 99], [282, 291, 6], [242, 270, 241], [109, 291, 202], [113, 200, 112], [47, 259, 107], [202, 291, 216], [99, 296, 198], [216, 291, 282], [29, 262, 104], [45, 257, 44], [0, 259, 47], [96, 277, 261], [253, 266, 224], [198, 272, 99], [256, 258, 154], [259, 274, 192], [118, 249, 204], [204, 249, 197], [118, 204, 115], [184, 205, 203], [184, 203, 194], [203, 205, 116], [205, 246, 120], [184, 246, 205], [117, 205, 120], [186, 249, 185], [185, 249, 207], [122, 245, 207], [197, 249, 186], [207, 245, 185], [122, 207, 119], [153, 248, 246], [125, 209, 128], [146, 248, 147], [146, 247, 208], [153, 246, 184], [208, 247, 209], [128, 209, 133], [124, 209, 125], [206, 208, 124], [121, 206, 124], [208, 248, 146], [180, 245, 188], [246, 248, 206], [147, 248, 153], [188, 245, 210], [126, 244, 210], [185, 245, 180], [210, 244, 188], [126, 210, 123], [208, 209, 124], [237, 244, 187], [187, 244, 211], [188, 244, 237], [211, 244, 126], [127, 211, 126], [211, 232, 187], [130, 232, 211], [212, 243, 130], [130, 243, 232], [129, 212, 130], [162, 231, 160], [132, 213, 212], [213, 231, 212], [214, 233, 132], [165, 231, 162], [160, 231, 213], [132, 233, 213], [131, 214, 132], [148, 214, 137], [148, 233, 214], [137, 214, 134], [155, 230, 215], [142, 230, 155], [41, 108, 40], [170, 219, 179], [149, 227, 191], [172, 225, 175], [44, 99, 43], [225, 226, 175], [219, 223, 179], [223, 224, 179], [136, 230, 142], [168, 219, 170], [29, 104, 28], [8, 97, 7], [143, 227, 149], [215, 230, 145], [20, 98, 19], [221, 222, 220], [161, 163, 162], [179, 225, 172], [217, 218, 190], [23, 105, 22], [164, 236, 166], [174, 221, 220], [140, 217, 190], [166, 174, 168], [14, 103, 13], [142, 144, 143], [144, 227, 143], [159, 160, 158], [174, 219, 168], [202, 216, 215], [47, 107, 46], [140, 145, 138], [145, 230, 138], [139, 141, 140], [141, 217, 140], [151, 217, 141], [150, 233, 148], [161, 183, 163], [174, 220, 219], [180, 188, 177], [2, 101, 1], [38, 102, 37], [140, 190, 145], [146, 147, 141], [143, 149, 148], [155, 199, 144], [201, 227, 144], [149, 150, 148], [157, 158, 150], [158, 233, 150], [157, 193, 159], [166, 167, 165], [188, 237, 177], [11, 110, 10], [17, 106, 16], [35, 111, 34], [147, 151, 141], [149, 156, 150], [149, 191, 156], [156, 157, 150], [153, 154, 152], [184, 194, 154], [193, 234, 159], [163, 182, 164], [168, 169, 167], [168, 170, 169], [170, 179, 172], [181, 185, 180], [139, 146, 141], [202, 215, 145], [147, 153, 152], [153, 184, 154], [161, 162, 160], [163, 164, 162], [182, 236, 164], [166, 168, 167], [170, 172, 171], [181, 186, 185], [228, 229, 193], [220, 223, 219], [142, 143, 137], [143, 148, 137], [139, 140, 138], [142, 155, 144], [199, 201, 144], [152, 192, 151], [160, 213, 158], [213, 233, 158], [159, 161, 160], [172, 173, 171], [226, 238, 175], [178, 181, 180], [181, 195, 186], [182, 242, 241], [190, 202, 145], [147, 152, 151], [157, 159, 158], [164, 166, 165], [166, 236, 174], [169, 232, 167], [171, 187, 169], [176, 189, 178], [189, 240, 239], [164, 165, 162], [187, 232, 169], [172, 175, 173], [178, 180, 177], [224, 225, 179], [181, 239, 195], [196, 197, 186], [135, 139, 138], [138, 230, 136], [176, 177, 173], [176, 238, 189], [178, 239, 181], [234, 235, 183], [236, 241, 221], [5, 109, 4], [26, 100, 25], [136, 142, 137], [156, 228, 157], [157, 228, 193], [159, 234, 161], [177, 237, 173], [176, 178, 177], [189, 239, 178], [195, 196, 186], [171, 237, 187], [174, 236, 221], [161, 234, 183], [170, 171, 169], [175, 238, 176], [182, 241, 236], [173, 237, 171], [175, 176, 173], [32, 96, 31], [136, 137, 134], [135, 138, 136], [135, 136, 134], [133, 135, 134], [134, 214, 131], [133, 134, 131], [132, 212, 129], [131, 132, 129], [130, 211, 127], [128, 133, 131], [165, 243, 231], [167, 243, 165], [231, 243, 212], [232, 243, 167], [129, 130, 127], [128, 131, 129], [128, 129, 127], [125, 128, 127], [125, 127, 126], [125, 126, 123], [124, 125, 123], [121, 124, 123], [123, 210, 122], [210, 245, 122], [121, 123, 122], [209, 247, 133], [133, 247, 135], [139, 247, 146], [120, 206, 121], [121, 122, 119], [120, 246, 206], [135, 247, 139], [206, 248, 208], [120, 121, 119], [117, 120, 119], [119, 207, 118], [207, 249, 118], [117, 119, 118], [198, 203, 116], [117, 118, 115], [116, 205, 117], [114, 198, 116], [116, 117, 115], [183, 250, 163], [182, 250, 242], [114, 116, 115], [115, 204, 113], [163, 250, 182], [114, 115, 113], [199, 271, 97], [108, 114, 113], [114, 252, 198], [217, 251, 218], [192, 251, 151], [107, 258, 256], [42, 252, 41], [41, 252, 108], [156, 254, 228], [218, 268, 265], [154, 258, 152], [151, 251, 217], [235, 283, 106], [265, 280, 218], [110, 276, 201], [195, 264, 196], [255, 294, 12], [12, 295, 255], [155, 271, 199], [216, 271, 215], [216, 282, 271], [108, 252, 114], [107, 259, 258], [267, 289, 235], [191, 255, 254], [201, 276, 227], [238, 277, 189], [257, 296, 99], [258, 259, 192], [224, 281, 225], [229, 283, 193], [234, 283, 235], [223, 253, 224], [235, 289, 183], [198, 296, 203], [239, 288, 195], [222, 293, 220], [108, 113, 112], [191, 276, 255], [191, 254, 156], [194, 257, 256], [194, 256, 154], [152, 258, 192], [37, 263, 36], [102, 263, 37], [105, 297, 241], [199, 260, 201], [226, 261, 238], [106, 287, 235], [226, 262, 261], [108, 112, 40], [40, 112, 39], [98, 267, 19], [109, 265, 4], [19, 267, 18], [4, 265, 3], [28, 266, 27], [104, 266, 28], [102, 286, 200], [262, 281, 104], [226, 281, 262], [194, 296, 257], [255, 295, 254], [276, 294, 255], [2, 268, 101], [32, 269, 96], [22, 270, 21], [200, 286, 112], [3, 268, 2], [33, 269, 32], [111, 273, 34], [105, 270, 22], [218, 280, 190], [1, 274, 0], [30, 290, 262], [15, 275, 14], [24, 278, 23], [271, 282, 97], [99, 272, 43], [201, 299, 110], [252, 272, 198], [43, 272, 42], [20, 279, 98], [223, 293, 253], [253, 293, 100], [235, 287, 267], [215, 271, 155], [7, 282, 6], [241, 297, 221], [107, 284, 46], [100, 285, 25], [38, 286, 102], [17, 287, 106], [96, 290, 31], [6, 291, 5], [106, 292, 16], [0, 274, 259], [12, 294, 11], [13, 295, 12], [10, 299, 9], [26, 298, 100], [254, 295, 103], [24, 285, 278], [34, 273, 33], [196, 264, 263], [202, 280, 109], [253, 298, 266], [101, 274, 1], [15, 292, 275], [190, 280, 202], [14, 275, 103], [42, 272, 252], [227, 276, 191], [189, 277, 240], [23, 278, 105], [265, 268, 3], [21, 279, 20], [278, 285, 222], [100, 298, 253], [225, 281, 226], [97, 282, 7], [193, 283, 234], [256, 284, 107], [275, 292, 229], [270, 279, 21], [111, 288, 273], [269, 277, 96], [46, 284, 45], [33, 273, 269], [269, 273, 240], [262, 290, 261], [9, 299, 260], [250, 289, 98], [25, 285, 24], [261, 290, 96], [39, 286, 38], [18, 287, 17], [242, 279, 270], [240, 277, 269], [240, 288, 239], [183, 289, 250], [31, 290, 30], [221, 297, 222], [5, 291, 109], [16, 292, 15], [260, 299, 201], [112, 286, 39], [220, 293, 223], [267, 287, 18], [110, 294, 276], [11, 294, 110], [203, 296, 194], [103, 295, 13], [273, 288, 240], [266, 298, 27], [27, 298, 26], [257, 284, 256], [45, 284, 257], [110, 299, 10], [109, 280, 265], [98, 289, 267], [222, 297, 278], [278, 297, 105]], "cells": {"triangle_2nd": [[8, 260, 97, 300, 301, 302], [224, 266, 104, 303, 304, 305], [192, 274, 251, 306, 307, 308], [104, 281, 224, 309, 310, 305], [102, 197, 196, 311, 312, 313], [103, 275, 228, 314, 315, 316], [36, 264, 35, 317, 318, 83], [251, 274, 101, 307, 319, 320], [97, 260, 199, 301, 321, 322], [195, 288, 264, 323, 324, 325], [264, 288, 111, 324, 326, 327], [102, 200, 197, 328, 329, 311], [9, 260, 8, 330, 300, 56], [242, 250, 98, 331, 332, 333], [228, 275, 229, 315, 334, 335], [228, 254, 103, 336, 337, 316], [218, 251, 101, 338, 320, 339], [98, 279, 242, 340, 341, 333], [35, 264, 111, 318, 327, 342], [101, 268, 218, 343, 344, 339], [106, 283, 229, 345, 346, 347], [229, 292, 106, 348, 349, 347], [285, 293, 222, 350, 351, 352], [113, 204, 200, 353, 354, 355], [263, 264, 36, 356, 317, 357], [261, 277, 238, 358, 359, 360], [30, 262, 29, 361, 362, 77], [100, 293, 285, 363, 350, 364], [200, 204, 197, 354, 365, 329], [196, 263, 102, 366, 367, 313], [241, 270, 105, 368, 369, 370], [44, 257, 99, 371, 372, 373], [282, 291, 6, 374, 375, 376], [242, 270, 241, 377, 368, 378], [109, 291, 202, 379, 380, 381], [113, 200, 112, 355, 382, 383], [47, 259, 107, 384, 385, 386], [202, 291, 216, 380, 387, 388], [99, 296, 198, 389, 390, 391], [216, 291, 282, 387, 374, 392], [29, 262, 104, 362, 393, 394], [45, 257, 44, 395, 371, 92], [0, 259, 47, 396, 384, 95], [96, 277, 261, 397, 358, 398], [253, 266, 224, 399, 303, 400], [198, 272, 99, 401, 402, 391], [256, 258, 154, 403, 404, 405], [259, 274, 192, 406, 306, 407], [118, 249, 204, 408, 409, 410], [204, 249, 197, 409, 411, 365], [118, 204, 115, 410, 412, 413], [184, 205, 203, 414, 415, 416], [184, 203, 194, 416, 417, 418], [203, 205, 116, 415, 419, 420], [205, 246, 120, 421, 422, 423], [184, 246, 205, 424, 421, 414], [117, 205, 120, 425, 423, 426], [186, 249, 185, 427, 428, 429], [185, 249, 207, 428, 430, 431], [122, 245, 207, 432, 433, 434], [197, 249, 186, 411, 427, 435], [207, 245, 185, 433, 436, 431], [122, 207, 119, 434, 437, 438], [153, 248, 246, 439, 440, 441], [125, 209, 128, 442, 443, 444], [146, 248, 147, 445, 446, 447], [146, 247, 208, 448, 449, 450], [153, 246, 184, 441, 424, 451], [208, 247, 209, 449, 452, 453], [128, 209, 133, 443, 454, 455], [124, 209, 125, 456, 442, 457], [206, 208, 124, 458, 459, 460], [121, 206, 124, 461, 460, 462], [208, 248, 146, 463, 445, 450], [180, 245, 188, 464, 465, 466], [246, 248, 206, 440, 467, 468], [147, 248, 153, 446, 439, 469], [188, 245, 210, 465, 470, 471], [126, 244, 210, 472, 473, 474], [185, 245, 180, 436, 464, 475], [210, 244, 188, 473, 476, 471], [126, 210, 123, 474, 477, 478], [208, 209, 124, 453, 456, 459], [237, 244, 187, 479, 480, 481], [187, 244, 211, 480, 482, 483], [188, 244, 237, 476, 479, 484], [211, 244, 126, 482, 472, 485], [127, 211, 126, 486, 485, 487], [211, 232, 187, 488, 489, 483], [130, 232, 211, 490, 488, 491], [212, 243, 130, 492, 493, 494], [130, 243, 232, 493, 495, 490], [129, 212, 130, 496, 494, 497], [162, 231, 160, 498, 499, 500], [132, 213, 212, 501, 502, 503], [213, 231, 212, 504, 505, 502], [214, 233, 132, 506, 507, 508], [165, 231, 162, 509, 498, 510], [160, 231, 213, 499, 504, 511], [132, 233, 213, 507, 512, 501], [131, 214, 132, 513, 508, 514], [148, 214, 137, 515, 516, 517], [148, 233, 214, 518, 506, 515], [137, 214, 134, 516, 519, 520], [155, 230, 215, 521, 522, 523], [142, 230, 155, 524, 521, 525], [41, 108, 40, 526, 527, 88], [170, 219, 179, 528, 529, 530], [149, 227, 191, 531, 532, 533], [172, 225, 175, 534, 535, 536], [44, 99, 43, 373, 537, 91], [225, 226, 175, 538, 539, 535], [219, 223, 179, 540, 541, 529], [223, 224, 179, 542, 543, 541], [136, 230, 142, 544, 524, 545], [168, 219, 170, 546, 528, 547], [29, 104, 28, 394, 548, 76], [8, 97, 7, 302, 549, 55], [143, 227, 149, 550, 531, 551], [215, 230, 145, 522, 552, 553], [20, 98, 19, 554, 555, 67], [221, 222, 220, 556, 557, 558], [161, 163, 162, 559, 560, 561], [179, 225, 172, 562, 534, 563], [217, 218, 190, 564, 565, 566], [23, 105, 22, 567, 568, 70], [164, 236, 166, 569, 570, 571], [174, 221, 220, 572, 558, 573], [140, 217, 190, 574, 566, 575], [166, 174, 168, 576, 577, 578], [14, 103, 13, 579, 580, 61], [142, 144, 143, 581, 582, 583], [144, 227, 143, 584, 550, 582], [159, 160, 158, 585, 586, 587], [174, 219, 168, 588, 546, 577], [202, 216, 215, 388, 589, 590], [47, 107, 46, 386, 591, 94], [140, 145, 138, 592, 593, 594], [145, 230, 138, 552, 595, 593], [139, 141, 140, 596, 597, 598], [141, 217, 140, 599, 574, 597], [151, 217, 141, 600, 599, 601], [150, 233, 148, 602, 518, 603], [161, 183, 163, 604, 605, 559], [174, 220, 219, 573, 606, 588], [180, 188, 177, 466, 607, 608], [2, 101, 1, 609, 610, 49], [38, 102, 37, 611, 612, 85], [140, 190, 145, 575, 613, 592], [146, 147, 141, 447, 614, 615], [143, 149, 148, 551, 616, 617], [155, 199, 144, 618, 619, 620], [201, 227, 144, 621, 584, 622], [149, 150, 148, 623, 603, 616], [157, 158, 150, 624, 625, 626], [158, 233, 150, 627, 602, 625], [157, 193, 159, 628, 629, 630], [166, 167, 165, 631, 632, 633], [188, 237, 177, 484, 634, 607], [11, 110, 10, 635, 636, 58], [17, 106, 16, 637, 638, 64], [35, 111, 34, 342, 639, 82], [147, 151, 141, 640, 601, 614], [149, 156, 150, 641, 642, 623], [149, 191, 156, 533, 643, 641], [156, 157, 150, 644, 626, 642], [153, 154, 152, 645, 646, 647], [184, 194, 154, 418, 648, 649], [193, 234, 159, 650, 651, 629], [163, 182, 164, 652, 653, 654], [168, 169, 167, 655, 656, 657], [168, 170, 169, 547, 658, 655], [170, 179, 172, 530, 563, 659], [181, 185, 180, 660, 475, 661], [139, 146, 141, 662, 615, 596], [202, 215, 145, 590, 553, 663], [147, 153, 152, 469, 647, 664], [153, 184, 154, 451, 649, 645], [161, 162, 160, 561, 500, 665], [163, 164, 162, 654, 666, 560], [182, 236, 164, 667, 569, 653], [166, 168, 167, 578, 657, 631], [170, 172, 171, 659, 668, 669], [181, 186, 185, 670, 429, 660], [228, 229, 193, 335, 671, 672], [220, 223, 219, 673, 540, 606], [142, 143, 137, 583, 674, 675], [143, 148, 137, 617, 517, 674], [139, 140, 138, 598, 594, 676], [142, 155, 144, 525, 620, 581], [199, 201, 144, 677, 622, 619], [152, 192, 151, 678, 679, 680], [160, 213, 158, 511, 681, 586], [213, 233, 158, 512, 627, 681], [159, 161, 160, 682, 665, 585], [172, 173, 171, 683, 684, 668], [226, 238, 175, 685, 686, 539], [178, 181, 180, 687, 661, 688], [181, 195, 186, 689, 690, 670], [182, 242, 241, 691, 378, 692], [190, 202, 145, 693, 663, 613], [147, 152, 151, 664, 680, 640], [157, 159, 158, 630, 587, 624], [164, 166, 165, 571, 633, 694], [166, 236, 174, 570, 695, 576], [169, 232, 167, 696, 697, 656], [171, 187, 169, 698, 699, 700], [176, 189, 178, 701, 702, 703], [189, 240, 239, 704, 705, 706], [164, 165, 162, 694, 510, 666], [187, 232, 169, 489, 696, 699], [172, 175, 173, 536, 707, 683], [178, 180, 177, 688, 608, 708], [224, 225, 179, 709, 562, 543], [181, 239, 195, 710, 711, 689], [196, 197, 186, 312, 435, 712], [135, 139, 138, 713, 676, 714], [138, 230, 136, 595, 544, 715], [176, 177, 173, 716, 717, 718], [176, 238, 189, 719, 720, 701], [178, 239, 181, 721, 710, 687], [234, 235, 183, 722, 723, 724], [236, 241, 221, 725, 726, 727], [5, 109, 4, 728, 729, 52], [26, 100, 25, 730, 731, 73], [136, 142, 137, 545, 675, 732], [156, 228, 157, 733, 734, 644], [157, 228, 193, 734, 672, 628], [159, 234, 161, 651, 735, 682], [177, 237, 173, 634, 736, 717], [176, 178, 177, 703, 708, 716], [189, 239, 178, 706, 721, 702], [195, 196, 186, 737, 712, 690], [171, 237, 187, 738, 481, 698], [174, 236, 221, 695, 727, 572], [161, 234, 183, 735, 724, 604], [170, 171, 169, 669, 700, 658], [175, 238, 176, 686, 719, 739], [182, 241, 236, 692, 725, 667], [173, 237, 171, 736, 738, 684], [175, 176, 173, 739, 718, 707], [32, 96, 31, 740, 741, 79], [136, 137, 134, 732, 520, 742], [135, 138, 136, 714, 715, 743], [135, 136, 134, 743, 742, 744], [133, 135, 134, 745, 744, 746], [134, 214, 131, 519, 513, 747], [133, 134, 131, 746, 747, 748], [132, 212, 129, 503, 496, 749], [131, 132, 129, 514, 749, 750], [130, 211, 127, 491, 486, 751], [128, 133, 131, 455, 748, 752], [165, 243, 231, 753, 754, 509], [167, 243, 165, 755, 753, 632], [231, 243, 212, 754, 492, 505], [232, 243, 167, 495, 755, 697], [129, 130, 127, 497, 751, 756], [128, 131, 129, 752, 750, 757], [128, 129, 127, 757, 756, 758], [125, 128, 127, 444, 758, 759], [125, 127, 126, 759, 487, 760], [125, 126, 123, 760, 478, 761], [124, 125, 123, 457, 761, 762], [121, 124, 123, 462, 762, 763], [123, 210, 122, 477, 764, 765], [210, 245, 122, 470, 432, 764], [121, 123, 122, 763, 765, 766], [209, 247, 133, 452, 767, 454], [133, 247, 135, 767, 768, 745], [139, 247, 146, 769, 448, 662], [120, 206, 121, 770, 461, 771], [121, 122, 119, 766, 438, 772], [120, 246, 206, 422, 468, 770], [135, 247, 139, 768, 769, 713], [206, 248, 208, 467, 463, 458], [120, 121, 119, 771, 772, 773], [117, 120, 119, 426, 773, 774], [119, 207, 118, 437, 775, 776], [207, 249, 118, 430, 408, 775], [117, 119, 118, 774, 776, 777], [198, 203, 116, 778, 420, 779], [117, 118, 115, 777, 413, 780], [116, 205, 117, 419, 425, 781], [114, 198, 116, 782, 779, 783], [116, 117, 115, 781, 780, 784], [183, 250, 163, 785, 786, 605], [182, 250, 242, 787, 331, 691], [114, 116, 115, 783, 784, 788], [115, 204, 113, 412, 353, 789], [163, 250, 182, 786, 787, 652], [114, 115, 113, 788, 789, 790], [199, 271, 97, 791, 792, 322], [108, 114, 113, 793, 790, 794], [114, 252, 198, 795, 796, 782], [217, 251, 218, 797, 338, 564], [192, 251, 151, 308, 798, 679], [107, 258, 256, 799, 403, 800], [42, 252, 41, 801, 802, 89], [41, 252, 108, 802, 803, 526], [156, 254, 228, 804, 336, 733], [218, 268, 265, 344, 805, 806], [154, 258, 152, 404, 807, 646], [151, 251, 217, 798, 797, 600], [235, 283, 106, 808, 345, 809], [265, 280, 218, 810, 811, 806], [110, 276, 201, 812, 813, 814], [195, 264, 196, 325, 815, 737], [255, 294, 12, 816, 817, 818], [12, 295, 255, 819, 820, 818], [155, 271, 199, 821, 791, 618], [216, 271, 215, 822, 823, 589], [216, 282, 271, 392, 824, 822], [108, 252, 114, 803, 795, 793], [107, 259, 258, 385, 825, 799], [267, 289, 235, 826, 827, 828], [191, 255, 254, 829, 830, 831], [201, 276, 227, 813, 832, 621], [238, 277, 189, 359, 833, 720], [257, 296, 99, 834, 389, 372], [258, 259, 192, 825, 407, 835], [224, 281, 225, 310, 836, 709], [229, 283, 193, 346, 837, 671], [234, 283, 235, 838, 808, 722], [223, 253, 224, 839, 400, 542], [235, 289, 183, 827, 840, 723], [198, 296, 203, 390, 841, 778], [239, 288, 195, 842, 323, 711], [222, 293, 220, 351, 843, 557], [108, 113, 112, 794, 383, 844], [191, 276, 255, 845, 846, 829], [191, 254, 156, 831, 804, 643], [194, 257, 256, 847, 848, 849], [194, 256, 154, 849, 405, 648], [152, 258, 192, 807, 835, 678], [37, 263, 36, 850, 357, 84], [102, 263, 37, 367, 850, 612], [105, 297, 241, 851, 852, 370], [199, 260, 201, 321, 853, 677], [226, 261, 238, 854, 360, 685], [106, 287, 235, 855, 856, 809], [226, 262, 261, 857, 858, 854], [108, 112, 40, 844, 859, 527], [40, 112, 39, 859, 860, 87], [98, 267, 19, 861, 862, 555], [109, 265, 4, 863, 864, 729], [19, 267, 18, 862, 865, 66], [4, 265, 3, 864, 866, 51], [28, 266, 27, 867, 868, 75], [104, 266, 28, 304, 867, 548], [102, 286, 200, 869, 870, 328], [262, 281, 104, 871, 309, 393], [226, 281, 262, 872, 871, 857], [194, 296, 257, 873, 834, 847], [255, 295, 254, 820, 874, 830], [276, 294, 255, 875, 816, 846], [2, 268, 101, 876, 343, 609], [32, 269, 96, 877, 878, 740], [22, 270, 21, 879, 880, 69], [200, 286, 112, 870, 881, 382], [3, 268, 2, 882, 876, 50], [33, 269, 32, 883, 877, 80], [111, 273, 34, 884, 885, 639], [105, 270, 22, 369, 879, 568], [218, 280, 190, 811, 886, 565], [1, 274, 0, 887, 888, 48], [30, 290, 262, 889, 890, 361], [15, 275, 14, 891, 892, 62], [24, 278, 23, 893, 894, 71], [271, 282, 97, 824, 895, 792], [99, 272, 43, 402, 896, 537], [201, 299, 110, 897, 898, 814], [252, 272, 198, 899, 401, 796], [43, 272, 42, 896, 900, 90], [20, 279, 98, 901, 340, 554], [223, 293, 253, 902, 903, 839], [253, 293, 100, 903, 363, 904], [235, 287, 267, 856, 905, 828], [215, 271, 155, 823, 821, 523], [7, 282, 6, 906, 376, 54], [241, 297, 221, 852, 907, 726], [107, 284, 46, 908, 909, 591], [100, 285, 25, 364, 910, 731], [38, 286, 102, 911, 869, 611], [17, 287, 106, 912, 855, 637], [96, 290, 31, 913, 914, 741], [6, 291, 5, 375, 915, 53], [106, 292, 16, 349, 916, 638], [0, 274, 259, 888, 406, 396], [12, 294, 11, 817, 917, 59], [13, 295, 12, 918, 819, 60], [10, 299, 9, 919, 920, 57], [26, 298, 100, 921, 922, 730], [254, 295, 103, 874, 923, 337], [24, 285, 278, 924, 925, 893], [34, 273, 33, 885, 926, 81], [196, 264, 263, 815, 356, 366], [202, 280, 109, 927, 928, 381], [253, 298, 266, 929, 930, 399], [101, 274, 1, 319, 887, 610], [15, 292, 275, 931, 932, 891], [190, 280, 202, 886, 927, 693], [14, 275, 103, 892, 314, 579], [42, 272, 252, 900, 899, 801], [227, 276, 191, 832, 845, 532], [189, 277, 240, 833, 933, 704], [23, 278, 105, 894, 934, 567], [265, 268, 3, 805, 882, 866], [21, 279, 20, 935, 901, 68], [278, 285, 222, 925, 352, 936], [100, 298, 253, 922, 929, 904], [225, 281, 226, 836, 872, 538], [97, 282, 7, 895, 906, 549], [193, 283, 234, 837, 838, 650], [256, 284, 107, 937, 908, 800], [275, 292, 229, 932, 348, 334], [270, 279, 21, 938, 935, 880], [111, 288, 273, 326, 939, 884], [269, 277, 96, 940, 397, 878], [46, 284, 45, 909, 941, 93], [33, 273, 269, 926, 942, 883], [269, 273, 240, 942, 943, 944], [262, 290, 261, 890, 945, 858], [9, 299, 260, 920, 946, 330], [250, 289, 98, 947, 948, 332], [25, 285, 24, 910, 924, 72], [261, 290, 96, 945, 913, 398], [39, 286, 38, 949, 911, 86], [18, 287, 17, 950, 912, 65], [242, 279, 270, 341, 938, 377], [240, 277, 269, 933, 940, 944], [240, 288, 239, 951, 842, 705], [183, 289, 250, 840, 947, 785], [31, 290, 30, 914, 889, 78], [221, 297, 222, 907, 952, 556], [5, 291, 109, 915, 379, 728], [16, 292, 15, 916, 931, 63], [260, 299, 201, 946, 897, 853], [112, 286, 39, 881, 949, 860], [220, 293, 223, 843, 902, 673], [267, 287, 18, 905, 950, 865], [110, 294, 276, 953, 875, 812], [11, 294, 110, 917, 953, 635], [203, 296, 194, 841, 873, 417], [103, 295, 13, 923, 918, 580], [273, 288, 240, 939, 951, 943], [266, 298, 27, 930, 954, 868], [27, 298, 26, 954, 921, 74], [257, 284, 256, 955, 937, 848], [45, 284, 257, 941, 955, 395], [110, 299, 10, 898, 919, 636], [109, 280, 265, 928, 810, 863], [98, 289, 267, 948, 826, 861], [222, 297, 278, 952, 956, 936], [278, 297, 105, 956, 851, 934]], "line_2nd": [[0, 1, 48], [1, 2, 49], [2, 3, 50], [3, 4, 51], [4, 5, 52], [5, 6, 53], [6, 7, 54], [7, 8, 55], [8, 9, 56], [9, 10, 57], [10, 11, 58], [11, 12, 59], [12, 13, 60], [13, 14, 61], [14, 15, 62], [15, 16, 63], [16, 17, 64], [17, 18, 65], [18, 19, 66], [19, 20, 67], [20, 21, 68], [21, 22, 69], [22, 23, 70], [23, 24, 71], [24, 25, 72], [25, 26, 73], [26, 27, 74], [27, 28, 75], [28, 29, 76], [29, 30, 77], [30, 31, 78], [31, 32, 79], [32, 33, 80], [33, 34, 81], [34, 35, 82], [35, 36, 83], [36, 37, 84], [37, 38, 85], [38, 39, 86], [39, 40, 87], [40, 41, 88], [41, 42, 89], [42, 43, 90], [43, 44, 91], [44, 45, 92], [45, 46, 93], [46, 47, 94], [47, 0, 95]]}, "num_vertices": 957, "num_faces": 454, "num_cells": 502, "mesh_dimension": 2};
        window.meshData = fullMeshData;
        
        // Set cells data from template
        window.cells = fullMeshData.cells || {};
        window.faces = fullMeshData.faces || [];
        
        // Debug: Log cells data
        console.log('=== MESH DATA DEBUG ===');
        console.log('Vertices:', fullMeshData.vertices ? fullMeshData.vertices.length : 'undefined');
        console.log('Faces:', window.faces.length);
        console.log('Cells:', window.cells);
        console.log('Cells type:', typeof window.cells);
        console.log('Cells keys:', Object.keys(window.cells));
        
        // Debug all available cell types
        Object.keys(window.cells).forEach(cellType => {
            console.log(`${cellType}:`, window.cells[cellType].length, 'elements');
        });
        
        // Field data removed from mesh preview
        
        // Configure controls based on mesh dimension
        function configureControlsForDimension() {
            const surfaceOption = document.getElementById('surface-option');
            const surfaceViewBtn = document.getElementById('surface-view-btn');
            const volumeViewBtn = document.getElementById('volume-view-btn');
            const representationSelect = document.getElementById('representation-select');
            
            console.log('Mesh dimension:', meshDimension);
            console.log('Surface button found:', !!surfaceViewBtn);
            console.log('Volume button found:', !!volumeViewBtn);
            
            if (meshDimension === 1) {
                // 1D meshes: Only points and wireframe, no surface/volume buttons
                if (surfaceViewBtn) {
                    surfaceViewBtn.style.display = 'none';
                    console.log('Hidden surface button for 1D mesh');
                }
                if (volumeViewBtn) {
                    volumeViewBtn.style.display = 'none';
                    console.log('Hidden volume button for 1D mesh');
                }
                // Hide surface option in representation select
                if (surfaceOption) {
                    surfaceOption.style.display = 'none';
                    console.log('Hidden surface option for 1D mesh');
                }
            } else if (meshDimension === 2) {
                // 2D meshes: Points, wireframe, surface - no volume button
                if (surfaceViewBtn) {
                    surfaceViewBtn.style.display = 'none';
                    console.log('Hidden surface button for 2D mesh (use representation select)');
                }
                if (volumeViewBtn) {
                    volumeViewBtn.style.display = 'none';
                    console.log('Hidden volume button for 2D mesh');
                }
                // Show surface option in representation select
                if (surfaceOption) {
                    surfaceOption.style.display = 'block';
                    console.log('Shown surface option for 2D mesh');
                }
            } else if (meshDimension === 3) {
                // 3D meshes: Full functionality - show all buttons
                if (surfaceViewBtn) {
                    surfaceViewBtn.style.display = 'inline-block';
                    console.log('Shown surface button for 3D mesh');
                }
                if (volumeViewBtn) {
                    volumeViewBtn.style.display = 'inline-block';
                    console.log('Shown volume button for 3D mesh');
                }
                // Show surface option in representation select
                if (surfaceOption) {
                surfaceOption.style.display = 'block';
                    console.log('Shown surface option for 3D mesh');
                }
            }
            
            // No field configuration in mesh preview - use field_visualization.html for field visualization
            
            // Dimension-specific configuration handled above
            
        }
        
        // Make functions globally accessible immediately
        function fitToView() {
            console.log('*** FIT TO VIEW CLICKED ***');
            console.log('Renderer available:', !!window.renderer);
            console.log('Actor available:', !!window.actor);
            console.log('RenderWindow available:', !!window.renderWindow);
            
            if (window.renderer && window.actor && window.renderWindow) {
                window.renderer.resetCamera();
                window.renderWindow.render();
                console.log('Camera reset to fit mesh');
                        } else {
                console.log('VTK objects not available for fit to view');
                console.log('Renderer:', window.renderer);
                console.log('Actor:', window.actor);
                console.log('RenderWindow:', window.renderWindow);
            }
        }
        
        function showSurfaceView() {
            console.log('*** SURFACE VIEW TOGGLE CLICKED ***');
            console.log('Switching to surface view');
            
            // Check if we have surface elements available
            if (!window.cells || Object.keys(window.cells).length === 0) {
                console.log('No surface elements available');
                alert('No surface elements found in this mesh. Cells data: ' + JSON.stringify(window.cells));
                return;
            }
            
            // Update button states
            updateViewButtonStates();
            
            // Get current representation and recreate mesh with surface elements only
            const representationSelect = document.getElementById('representation-select');
            const currentRepresentation = representationSelect ? parseInt(representationSelect.value) : 2;
            createUnifiedMeshWithRepresentation(currentRepresentation, 'surface');
            
            console.log('Switched to surface view mode');
        }
        
        function showVolumeView() {
            console.log('*** VOLUME VIEW TOGGLE CLICKED ***');
            console.log('Cells data:', window.cells);
            
            if (!window.cells || Object.keys(window.cells).length === 0) {
                console.log('No volume elements available');
                alert('No volume elements found in this mesh. Cells data: ' + JSON.stringify(window.cells));
                return;
            }
            
            console.log('Switching to volume view');
            
            // Update button states
            updateViewButtonStates();
            
            // Get current representation and recreate mesh with volume elements
            const representationSelect = document.getElementById('representation-select');
            const currentRepresentation = representationSelect ? parseInt(representationSelect.value) : 2;
            createUnifiedMeshWithRepresentation(currentRepresentation, 'volume');
            
            // Log details about each cell type
            for (const [cellType, cellData] of Object.entries(window.cells)) {
                console.log(`${cellType}: ${cellData ? cellData.length : 0} elements`);
                if (cellData && cellData.length > 0) {
                    console.log(`Sample ${cellType}:`, cellData[0]);
                }
            }
            
            console.log('Switched to volume view mode');
        }
        
        function changeRepresentation(value) {
            console.log('*** REPRESENTATION CHANGED TO:', value, '***');
            console.log('Mesh dimension:', meshDimension);
            
            const repValue = parseInt(value);
            
            if (meshDimension === 1) {
                // For 1D meshes, handle points and wireframe representations only
                if (window.actor && window.renderWindow) {
                    // No field actors in mesh preview
                        
                    // No colorbar in mesh preview
                        
                        if (repValue === 0) {
                            // Points representation
                        console.log('Setting 1D mesh to points representation');
                        const actorProps = window.actor.getProperty();
                            actorProps.setRepresentation(0); // Points
                            actorProps.setPointSize(8); // Large points for visibility
                            actorProps.setLineWidth(1); // Reset line width
                        } else if (repValue === 1) {
                        // Wireframe representation - recreate mesh with proper line connectivity
                        console.log('Creating 1D wireframe mesh...');
                        create1DMesh();
                    }
                    
                    // Force render
                        window.renderWindow.render();
                }
            } else if (meshDimension === 2) {
                // For 2D meshes, handle points, wireframe, surface, and field representations
                if (window.actor && window.renderWindow) {
                    // Field representation removed from mesh preview
                    {
                        // No field actors in mesh preview
                        
                        // No colorbar in mesh preview
                        
                        // Points, wireframe, or surface representation
                        const actorProps = window.actor.getProperty();
                        
                        if (repValue === 0) {
                            // Points representation
                            actorProps.setRepresentation(0); // Points
                            actorProps.setPointSize(5);
                            actorProps.setLineWidth(1);
                            actorProps.setEdgeVisibility(false);
                        } else if (repValue === 1) {
                            // Wireframe representation
                            actorProps.setRepresentation(1); // Wireframe
                            // Don't set color - preserve default wireframe color
                        } else if (repValue === 2) {
                            // Surface representation
                            actorProps.setRepresentation(2); // Surface
                            actorProps.setOpacity(0.8);
                            actorProps.setPointSize(1);
                            actorProps.setLineWidth(1);
                            actorProps.setEdgeVisibility(true); // Show edges on surface
                            actorProps.setColor(0, 1, 0); // Green surface
                        }
                        
                        // Don't reset camera - keep current camera position
                        window.renderWindow.render();
                    }
                }
            } else if (meshDimension === 3) {
                // For 3D meshes, handle points, wireframe, surface, and field representations
                if (window.actor && window.renderWindow) {
                    // Field representation removed from mesh preview
                    {
                        // No field actors in mesh preview
                        
                        // No colorbar in mesh preview
                        
                        // Points, wireframe, or surface representation
                        const actorProps = window.actor.getProperty();
                        
                        if (repValue === 0) {
                            // Points representation
                            actorProps.setRepresentation(0); // Points
                            actorProps.setPointSize(3);
                            actorProps.setColor(0, 1, 0); // Green
                        } else if (repValue === 1) {
                            // Wireframe representation
                            actorProps.setRepresentation(1); // Wireframe
                            actorProps.setLineWidth(2);
                            actorProps.setEdgeVisibility(true);
                            // Don't set color - preserve default wireframe color
                        } else if (repValue === 2) {
                            // Surface representation
                            actorProps.setRepresentation(2); // Surface
                            actorProps.setOpacity(0.8);
                            actorProps.setColor(0, 1, 0); // Green
                            actorProps.setEdgeVisibility(true);
                            actorProps.setLineWidth(1);
                        }
                        
                        // Don't reset camera - keep current camera position
                        window.renderWindow.render();
                    }
                }
            } else {
                createMeshWithCurrentMode(repValue);
            }
            
            console.log('Representation changed to:', value);
        }
        
        // Field visualization removed from mesh preview - use field_visualization.html instead
        
        function changeBackground(color) {
            console.log('*** BACKGROUND CHANGED TO:', color, '***');
            if (window.renderer) {
                const r = parseInt(color.substr(1, 2), 16) / 255;
                const g = parseInt(color.substr(3, 2), 16) / 255;
                const b = parseInt(color.substr(5, 2), 16) / 255;
                window.renderer.setBackground(r, g, b);
                window.renderWindow.render();
                console.log('Background changed to:', color);
            } else {
                console.log('Renderer not available for background change');
            }
        }
        
        function createMeshWithCurrentMode(representation) {
            if (window.actor && window.renderWindow) {
                // Remove current actor
                window.renderer.removeActor(window.actor);
                
                // Create new mesh based on current mode and representation
                if (meshDimension === 1) {
                    // For 1D meshes, use current representation setting
                    const representationSelect = document.getElementById('representation-select');
                    const currentRepresentation = representationSelect ? parseInt(representationSelect.value) : 1;
                    createUnifiedMeshWithRepresentation(currentRepresentation, 'surface');
                } else if (meshDimension === 2) {
                    // For 2D meshes, use the 2D mesh creation function
                    create2DMesh();
                } else {
                    // Default to surface mode for mesh preview
                    createUnifiedMeshWithRepresentation(representation, 'surface');
                }
                
                window.renderWindow.render();
            } else {
                console.log('VTK objects not available for mesh creation');
            }
        }
        
        function updateViewButtonStates() {
            // Simplified button state management for mesh preview
            const surfaceButton = document.getElementById('surface-view-btn');
            const volumeButton = document.getElementById('volume-view-btn');
            
            if (surfaceButton && volumeButton) {
                // Default styling for mesh preview
                    surfaceButton.style.backgroundColor = '#001100';
                    surfaceButton.style.color = '#00ff00';
                surfaceButton.style.border = '1px solid #00ff00';
                    volumeButton.style.backgroundColor = '#001100';
                    volumeButton.style.color = '#00ff00';
                volumeButton.style.border = '1px solid #00ff00';
            }
        }
        
        // Make functions globally accessible
        window.fitToView = fitToView;
        window.showSurfaceView = showSurfaceView;
        window.showVolumeView = showVolumeView;
        window.changeRepresentation = changeRepresentation;
        // changeField removed from mesh preview
        window.changeBackground = changeBackground;
        
        // Test functions removed from mesh preview
        
        // Duplicate data assignments removed
        
        // Field data debugging removed
        
        // Mesh preview doesn't need field tracking
        
                const meshData = window.meshData.vertices || window.meshData;
                const faces = window.meshData.faces || window.faces;
                const cells = window.meshData.cells || window.cells;
        const settings = window.settings;
        
                console.log('Starting VTK.js visualization...');
                console.log('Mesh data:', meshData);
                console.log('Faces:', faces);
                console.log('Cells:', cells);
                console.log('Settings:', settings);
                
                // Debug: Check what volume elements we have
                if (cells) {
                    console.log('Available cell types:', Object.keys(cells));
                    for (const [cellType, cellData] of Object.entries(cells)) {
                        console.log(`${cellType}: ${cellData ? cellData.length : 0} elements`);
                            }
                } else {
                    console.log('No cells data available');
                }
        
        let vtk, fullScreenRenderer;
        window.renderer = null;
        window.renderWindow = null;
        window.actor = null;
        let mapper;
        let isVolumeMode = false;
        let originalMeshData = null;
        
        
        
        // Test if functions are accessible on page load
        console.log('Page loaded, testing function accessibility:');
        console.log('fitToView function:', typeof fitToView);
        console.log('window.fitToView function:', typeof window.fitToView);
        
        // Test if onclick handlers work at all
        console.log('Testing onclick handler accessibility...');
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, testing button access...');
            
            // Configure controls based on mesh dimension
            configureControlsForDimension();
            
            const fitButton = document.getElementById('fit-view');
            const surfaceButton = document.getElementById('surface-view-btn');
            const volumeButton = document.getElementById('volume-view-btn');
            console.log('Fit button found:', !!fitButton);
            console.log('Surface button found:', !!surfaceButton);
            console.log('Volume button found:', !!volumeButton);
            
            if (fitButton) {
                console.log('Fit button onclick:', fitButton.onclick);
                console.log('Fit button has onclick attribute:', fitButton.hasAttribute('onclick'));
                
                // Add event listeners as backup
                fitButton.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('Fit button clicked via addEventListener!');
                    fitToView();
                });
                
                surfaceButton.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('Surface button clicked via addEventListener!');
                    showSurfaceView();
                });
                
                volumeButton.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('Volume button clicked via addEventListener!');
                    showVolumeView();
                });
                
                console.log('Added event listeners to all buttons');
            }
        });
        
        // Wait for VTK.js to load
        window.addEventListener('load', function() {
            setTimeout(function() {
                try {
                    vtk = window.vtk;
                    console.log('VTK loaded:', !!vtk);
                        
                        if (vtk) {
                        console.log('VTK object keys:', Object.keys(vtk));
                                initVTK();
                } else {
                        console.error('VTK.js not available in window.vtk');
                    }
                } catch (error) {
                    console.error('VTK check error:', error);
                }
            }, 100); // Small delay to ensure script is loaded
        });
        
        function initVTK() {
            try {
                console.log('Initializing VTK.js...');
                
                // Create render window and attach to VTK container only
                window.vtkContainer = document.getElementById('vtk-container');
                const mainContainer = document.getElementById('container');
                window.renderWindow = vtk.Rendering.Core.vtkRenderWindow.newInstance();
                renderWindow = window.renderWindow;
                
                // Create OpenGL render window and attach to VTK container only
                const openGLRenderWindow = vtk.Rendering.OpenGL.vtkRenderWindow.newInstance();
                openGLRenderWindow.setContainer(window.vtkContainer);
                
                // Enable high-quality rendering (using supported methods)
                openGLRenderWindow.setUseOffScreen(false);
                openGLRenderWindow.setSize(window.vtkContainer.clientWidth, window.vtkContainer.clientHeight);
                
                console.log('VTK container attached to render window');
                console.log('VTK container size:', window.vtkContainer.clientWidth, 'x', window.vtkContainer.clientHeight);
                console.log('VTK container element:', window.vtkContainer);
                
                renderWindow.addView(openGLRenderWindow);
                
                // Create renderer
                window.renderer = vtk.Rendering.Core.vtkRenderer.newInstance();
                renderWindow.addRenderer(window.renderer);
                renderer = window.renderer;
                
                console.log('Renderer created and assigned to window:', !!window.renderer);
                
                // Create interactor with mouse controls - bind only to VTK container
                const interactor = vtk.Rendering.Core.vtkRenderWindowInteractor.newInstance();
                interactor.setView(openGLRenderWindow);
                interactor.initialize();
                interactor.bindEvents(window.vtkContainer);
                
                // Set up mouse controls
                interactor.setInteractorStyle(vtk.Interaction.Style.vtkInteractorStyleTrackballCamera.newInstance());
                
                console.log('Interactor created and configured for mouse controls');
                console.log('Mouse controls enabled - Left: Rotate, Middle: Pan, Right: Zoom, Wheel: Zoom');
                
                // Create mesh
                createMesh();
                
                // Update button states
                updateViewButtonStates();
                
                // Controls are now handled by onclick handlers in HTML
                
                // Update info
                updateInfo();
                
                // Hide loading
                document.getElementById('loading').style.display = 'none';
                
                // Render
                renderWindow.render();
                
                // Force a second render after a short delay to ensure visibility
                setTimeout(() => {
                    renderWindow.render();
                    console.log('Second render completed');
                    
                    // Field selection logic removed from mesh preview
                }, 100);
                
                console.log('VTK.js visualization initialized successfully');
                
                // Ensure 1D mesh buttons are hidden after initialization
                if (meshDimension === 1) {
                    setTimeout(() => {
                        const surfaceBtn = document.getElementById('surface-view-btn');
                        const volumeBtn = document.getElementById('volume-view-btn');
                        if (surfaceBtn) surfaceBtn.style.display = 'none';
                        if (volumeBtn) volumeBtn.style.display = 'none';
                        console.log('Ensured 1D mesh buttons are hidden');
                    }, 100);
                }
                
            } catch (error) {
                console.error('VTK initialization error:', error);
            }
        }
        
        function createMesh() {
            try {
                console.log('Creating mesh from data...');
                console.log('Mesh dimension:', meshDimension);
                
                if (!window.meshData || window.meshData.length === 0) {
                    console.error('No mesh data available');
                    return;
                }
                
                // Handle 1D meshes differently
                if (meshDimension === 1) {
                    // Use current representation setting for 1D meshes
                    const representationSelect = document.getElementById('representation-select');
                    const currentRepresentation = representationSelect ? parseInt(representationSelect.value) : 1;
                    createUnifiedMeshWithRepresentation(currentRepresentation, 'surface');
                    return;
                }
                
                // Handle 2D meshes differently
                if (meshDimension === 2) {
                    create2DMesh();
                    return;
                }
                
                // For 3D meshes, create initial mesh based on current mode
                const representationSelect = document.getElementById('representation-select');
                const currentRepresentation = representationSelect ? parseInt(representationSelect.value) : 2;
                
                // Create initial mesh - default to surface mode for mesh preview
                    createUnifiedMeshWithRepresentation(currentRepresentation, 'surface');
                
            } catch (error) {
                console.error('Mesh creation error:', error);
            }
        }
        
        function setupControls() {
            console.log('Setting up controls...');
            console.log('Actor available:', !!actor);
            console.log('Renderer available:', !!renderer);
            console.log('RenderWindow available:', !!renderWindow);
            
            // Representation selector (following VTK.js docs pattern)
            const representationSelector = document.getElementById('representation-select');
            console.log('Representation selector found:', !!representationSelector);
            if (representationSelector) {
                representationSelector.addEventListener('change', (e) => {
                    console.log('Representation changed to:', e.target.value);
                if (actor) {
                        const newRepValue = Number(e.target.value);
                        actor.getProperty().setRepresentation(newRepValue);
                    renderWindow.render();
                        console.log('Changed representation to:', e.target.options[e.target.selectedIndex].text);
                } else {
                        console.error('Actor not available for representation change');
                }
            });
            }
            
            // Background color selector
            const backgroundSelector = document.getElementById('background-select');
            if (backgroundSelector) {
                backgroundSelector.addEventListener('change', (e) => {
                    const color = e.target.value;
                    const r = parseInt(color.substr(1, 2), 16) / 255;
                    const g = parseInt(color.substr(3, 2), 16) / 255;
                    const b = parseInt(color.substr(5, 2), 16) / 255;
                    renderer.setBackground(r, g, b);
                    renderWindow.render();
                    console.log('Changed background to:', color);
                });
            }
        }
        
        
        function create1DMesh() {
            try {
                console.log('Creating 1D mesh...');
                
                // Remove existing actor if it exists
                if (window.actor) {
                    window.renderer.removeActor(window.actor);
                    window.actor = null;
                }
                
                if (!window.meshData || (window.meshData.vertices ? window.meshData.vertices.length === 0 : window.meshData.length === 0)) {
                    console.error('No mesh data available for 1D mesh');
                    return;
                }
                
                // Create polydata for 1D mesh
                const polydata = vtk.Common.DataModel.vtkPolyData.newInstance();
                const points = vtk.Common.Core.vtkPoints.newInstance();
                const cellArray = vtk.Common.Core.vtkCellArray.newInstance();
                
                // Set vertices
                let vertices;
                const meshData = window.meshData.vertices || window.meshData;
                
                // Debug: Check the actual data structure
                console.log('Mesh data structure:', meshData);
                console.log('Mesh data length:', meshData ? meshData.length : 'undefined');
                console.log('First element:', meshData ? meshData[0] : 'undefined');
                console.log('Is first element array:', Array.isArray(meshData ? meshData[0] : null));
                
                // Handle vertices correctly - they should be in [x,y,z] format
                if (Array.isArray(meshData) && meshData.length > 0 && Array.isArray(meshData[0])) {
                    // Vertices are in [x,y,z] format - flatten them
                    vertices = meshData.flat();
                    console.log('Vertices in [x,y,z] format, flattened to:', vertices.length / 3, 'vertices');
                } else if (Array.isArray(meshData) && meshData.length > 0) {
                    // Vertices are already flattened
                    vertices = meshData;
                    console.log('Vertices already flattened:', vertices.length / 3, 'vertices');
                } else {
                    console.error('Invalid mesh data structure');
                    return;
                }
                
                points.setData(new Float32Array(vertices), 3);
                polydata.setPoints(points);
                
                // Create line elements from cells (1D elements)
                const lineElements = [];
                console.log('Available cell types:', window.cells ? Object.keys(window.cells) : 'no cells');
                
                if (window.cells && window.cells.line_2nd && window.cells.line_2nd.length > 0) {
                    // Use cells.line_2nd for 1D connectivity (quadratic elements)
                    console.log('Using line_2nd cells:', window.cells.line_2nd.length);
                    for (let i = 0; i < window.cells.line_2nd.length; i++) {
                        const line = window.cells.line_2nd[i];
                        if (Array.isArray(line) && line.length >= 2) {
                        if (line.length === 2) {
                            // Linear line element
                            lineElements.push(line);
                        } else if (line.length === 3) {
                            // Quadratic line element - create two line segments for proper wireframe
                            lineElements.push([line[0], line[1]]); // First segment
                            lineElements.push([line[1], line[2]]); // Second segment
                        }
                        }
                    }
                } else if (window.cells && window.cells.line && window.cells.line.length > 0) {
                    // Use cells.line for 1D connectivity (linear elements)
                    console.log('Using line cells:', window.cells.line.length);
                    for (let i = 0; i < window.cells.line.length; i++) {
                        const line = window.cells.line[i];
                        if (Array.isArray(line) && line.length >= 2) {
                            lineElements.push(line);
                        }
                    }
                } else if (window.faces && window.faces.length > 0) {
                    // Fallback to faces if cells.line not available
                    for (let i = 0; i < window.faces.length; i++) {
                        const face = window.faces[i];
                        if (Array.isArray(face) && face.length >= 2) {
                            if (face.length === 2) {
                                // Line element
                                lineElements.push(face);
                            } else if (face.length > 2) {
                                // Split into line segments
                                for (let j = 0; j < face.length; j++) {
                                    const next = (j + 1) % face.length;
                                    lineElements.push([face[j], face[next]]);
                                }
                            }
                        }
                    }
                }
                
                // Add line elements to polydata
                console.log('Adding line elements to polydata:', lineElements.length);
                for (let i = 0; i < lineElements.length; i++) {
                    cellArray.insertNextCell(lineElements[i]);
                    console.log(`Line ${i}:`, lineElements[i]);
                }
                polydata.setLines(cellArray);
                
                console.log('Polydata created with', polydata.getNumberOfPoints(), 'points and', polydata.getNumberOfCells(), 'cells');
                
                // Create mapper and actor
                const mapper = vtk.Rendering.Core.vtkMapper.newInstance();
                mapper.setInputData(polydata);
                
                const actor = vtk.Rendering.Core.vtkActor.newInstance();
                actor.setMapper(mapper);
                
                // Set actor properties for 1D mesh
                const actorProps = actor.getProperty();
                actorProps.setRepresentation(1); // Wireframe
                actorProps.setLineWidth(15); // Very thick lines for visibility
                // Keep default green color for mesh preview
                
                console.log('Set 1D mesh wireframe with thick lines');
                console.log('Line elements created:', lineElements.length);
                console.log('Actor representation:', actorProps.getRepresentation());
                console.log('Actor line width:', actorProps.getLineWidth());
                console.log('Actor color:', actorProps.getColor());
                
                // Add actor to renderer
                window.renderer.addActor(actor);
                window.actor = actor;
                
                // Set up camera for 1D mesh
                const camera = window.renderer.getActiveCamera();
                const bounds = polydata.getBounds();
                const center = [
                    (bounds[0] + bounds[1]) / 2,
                    (bounds[2] + bounds[3]) / 2,
                    (bounds[4] + bounds[5]) / 2
                ];
                
                // Position camera above the mesh center
                camera.setPosition(center[0], center[1], center[2] + 2); // Position camera above the mesh center
                camera.setFocalPoint(center[0], center[1], center[2]); // Look at center of the mesh
                camera.setViewUp(0, 1, 0); // Y-axis up
                
                // Force render
                window.renderWindow.render();
                
                // Debug: Check if mesh is visible
                console.log('=== 1D MESH DEBUG ===');
                console.log('Actor visible:', actor.getVisibility());
                console.log('Actor bounds:', actor.getBounds());
                console.log('Polydata bounds:', polydata.getBounds());
                console.log('Camera position:', camera.getPosition());
                console.log('Camera focal point:', camera.getFocalPoint());
                console.log('Renderer bounds:', window.renderer.computeVisiblePropBounds());
                
                console.log('1D mesh camera positioned at:', camera.getPosition());
                console.log('1D mesh camera looking at:', camera.getFocalPoint());
                console.log(`1D mesh created with ${vertices.length / 3} vertices and ${lineElements.length} line elements`);
            } catch (error) {
                console.error('1D mesh creation error:', error);
            }
        }

        function create2DMesh() {
            try {
                console.log('Creating 2D mesh...');
                
                if (!window.meshData || (window.meshData.vertices ? window.meshData.vertices.length === 0 : window.meshData.length === 0)) {
                    console.error('No mesh data available for 2D mesh');
                    return;
                }
                
                // Create polydata for 2D mesh
                const polydata = vtk.Common.DataModel.vtkPolyData.newInstance();
                const points = vtk.Common.Core.vtkPoints.newInstance();
                const cellArray = vtk.Common.Core.vtkCellArray.newInstance();
                
                // Set vertices
                let vertices;
                const meshData = window.meshData.vertices || window.meshData;
                
                // Handle vertices correctly - they should be in [x,y,z] format
                if (Array.isArray(meshData) && meshData.length > 0 && Array.isArray(meshData[0])) {
                    // Vertices are in [x,y,z] format - flatten them
                    vertices = meshData.flat();
                    console.log('2D mesh: Vertices in [x,y,z] format, flattened to:', vertices.length / 3, 'vertices');
                } else if (Array.isArray(meshData) && meshData.length > 0) {
                    // Vertices are already flattened
                    vertices = meshData;
                    console.log('2D mesh: Vertices already flattened:', vertices.length / 3, 'vertices');
                } else {
                    console.error('Invalid mesh data structure for 2D mesh');
                    return;
                }
                
                points.setData(new Float32Array(vertices), 3);
                polydata.setPoints(points);
                
                // Add faces to polydata
                if (window.faces && window.faces.length > 0) {
                    for (let i = 0; i < window.faces.length; i++) {
                        const face = window.faces[i];
                        if (Array.isArray(face) && face.length >= 3) {
                            if (face.length === 3) {
                                cellArray.insertNextCell(face);
                            } else if (face.length === 4) {
                                // Split quad into two triangles
                                cellArray.insertNextCell([face[0], face[1], face[2]]);
                                cellArray.insertNextCell([face[0], face[2], face[3]]);
                            }
                        }
                    }
                }
                polydata.setPolys(cellArray);
                
                // Create mapper and actor
                const mapper = vtk.Rendering.Core.vtkMapper.newInstance();
                mapper.setInputData(polydata);
                
                const actor = vtk.Rendering.Core.vtkActor.newInstance();
                actor.setMapper(mapper);
                
                // Set actor properties for 2D mesh
                const actorProps = actor.getProperty();
                actorProps.setRepresentation(2); // Surface
                actorProps.setColor(0, 1, 0); // Green
                actorProps.setOpacity(0.8);
                actorProps.setEdgeVisibility(true); // Show edges
                actorProps.setLineWidth(2); // Edge line width
                
                // Add actor to renderer
                window.renderer.addActor(actor);
                window.actor = actor;
                
                // Set up camera for 2D mesh
                const camera = window.renderer.getActiveCamera();
                const bounds = polydata.getBounds();
                const center = [
                    (bounds[0] + bounds[1]) / 2,
                    (bounds[2] + bounds[3]) / 2,
                    (bounds[4] + bounds[5]) / 2
                ];
                
                // Calculate distance based on mesh size
                const size = Math.max(bounds[1] - bounds[0], bounds[3] - bounds[2], bounds[5] - bounds[4]);
                const distance = size * 1.5;
                
                camera.setPosition(center[0], center[1], center[2] + distance);
                camera.setFocalPoint(center[0], center[1], center[2]);
                camera.setViewUp(0, 1, 0);
                
                // Force render
                window.renderWindow.render();
                
                console.log(`2D mesh created with ${vertices.length / 3} vertices`);
            } catch (error) {
                console.error('2D mesh creation error:', error);
            }
        }

        
        function createUnifiedMeshWithRepresentation(representation, viewType) {
            console.log(`Creating mesh with representation ${representation} for ${viewType} view`);
            
            // Remove existing actor to prevent overlay
            if (window.actor) {
                window.renderer.removeActor(window.actor);
                window.actor = null;
            }
            
            // Create polydata with the same base vertices for both views
            const polydata = vtk.Common.DataModel.vtkPolyData.newInstance();
            const points = vtk.Common.Core.vtkPoints.newInstance();
            const cellArray = vtk.Common.Core.vtkCellArray.newInstance();
            
            // Set vertices - ALWAYS the same for both views
            let vertices;
            const meshData = window.meshData.vertices || window.meshData;
            
            // Handle vertices correctly - they should be in [x,y,z] format
            if (Array.isArray(meshData) && meshData.length > 0 && Array.isArray(meshData[0])) {
                // Vertices are in [x,y,z] format - flatten them
                vertices = meshData.flat();
                console.log('Unified mesh: Vertices in [x,y,z] format, flattened to:', vertices.length / 3, 'vertices');
            } else if (Array.isArray(meshData) && meshData.length > 0) {
                // Vertices are already flattened
                vertices = meshData;
                console.log('Unified mesh: Vertices already flattened:', vertices.length / 3, 'vertices');
            } else {
                console.error('Invalid mesh data structure for unified mesh');
                return;
            }
            
            points.setData(new Float32Array(vertices), 3);
            polydata.setPoints(points);
            
            let totalElements = 0;
            
            // For points representation, create point cloud from all vertices
            if (representation === 0) {
            const pointArray = vtk.Common.Core.vtkCellArray.newInstance();
            for (let i = 0; i < vertices.length / 3; i++) {
                pointArray.insertNextCell([i]);
            }
            polydata.setVerts(pointArray);
            totalElements = vertices.length / 3;
            } else {
                // Handle 1D meshes (lines)
                if (window.meshDimension === 1) {
                    
                    if (window.cells && Object.keys(window.cells).length > 0) {
                        // Process 1D elements
                        if (window.cells.line && window.cells.line.length > 0) {
                            for (let i = 0; i < window.cells.line.length; i++) {
                                const line = window.cells.line[i];
                                if (Array.isArray(line) && line.length === 2) {
                                    cellArray.insertNextCell(line);
                                    totalElements++;
                                }
                            }
                        }
                        
                        if (window.cells.line_2nd && window.cells.line_2nd.length > 0) {
                            for (let i = 0; i < window.cells.line_2nd.length; i++) {
                                const line_2nd = window.cells.line_2nd[i];
                                if (Array.isArray(line_2nd) && line_2nd.length === 3) {
                                    // For second-order lines, use corner nodes only
                                    cellArray.insertNextCell([line_2nd[0], line_2nd[1]]);
                                    totalElements++;
                                }
                            }
                        }
                    }
                    
                    // Fallback to faces if no cells data available
                    if (totalElements === 0 && window.faces && window.faces.length > 0) {
                        for (let i = 0; i < window.faces.length; i++) {
                            const face = window.faces[i];
                            if (Array.isArray(face) && face.length >= 2) {
                                if (face.length === 2) {
                                    cellArray.insertNextCell(face);
                                    totalElements++;
                                } else if (face.length > 2) {
                                    // Split into line segments
                                    for (let j = 0; j < face.length; j++) {
                                        const next = (j + 1) % face.length;
                                        cellArray.insertNextCell([face[j], face[next]]);
                                        totalElements++;
                                    }
                                }
                            }
                        }
                    }
                    
                    if (totalElements > 0) {
                        polydata.setLines(cellArray);
                    }
                } else if (viewType === 'surface') {
                    // Surface view: show only surface elements (triangles, quads)
                    console.log('Processing surface elements for surface view');
                    
                    if (window.cells && Object.keys(window.cells).length > 0) {
                        // Process only surface elements
                    if (window.cells.triangle && window.cells.triangle.length > 0) {
                        for (let i = 0; i < window.cells.triangle.length; i++) {
                            const triangle = window.cells.triangle[i];
                            if (Array.isArray(triangle) && triangle.length === 3) {
                                cellArray.insertNextCell(triangle);
                                    totalElements++;
                            }
                        }
                    }
                    
                    if (window.cells.quad && window.cells.quad.length > 0) {
                        for (let i = 0; i < window.cells.quad.length; i++) {
                            const quad = window.cells.quad[i];
                            if (Array.isArray(quad) && quad.length === 4) {
                                // Split quad into two triangles
                                cellArray.insertNextCell([quad[0], quad[1], quad[2]]);
                                cellArray.insertNextCell([quad[0], quad[2], quad[3]]);
                                    totalElements += 2;
                            }
                        }
                    }
                    
                    if (window.cells.triangle_2nd && window.cells.triangle_2nd.length > 0) {
                        for (let i = 0; i < window.cells.triangle_2nd.length; i++) {
                            const triangle_2nd = window.cells.triangle_2nd[i];
                            if (Array.isArray(triangle_2nd) && triangle_2nd.length === 6) {
                                    // For second-order triangles, subdivide into 4 first-order triangles for smooth surface
                                    // Corner nodes: 0, 1, 2
                                    // Mid-edge nodes: 3, 4, 5 (between 0-1, 1-2, 2-0)
                                    
                                    // 4 triangles covering the entire second-order triangle
                                    cellArray.insertNextCell([triangle_2nd[0], triangle_2nd[3], triangle_2nd[5]]);
                                    cellArray.insertNextCell([triangle_2nd[3], triangle_2nd[1], triangle_2nd[4]]);
                                    cellArray.insertNextCell([triangle_2nd[5], triangle_2nd[4], triangle_2nd[2]]);
                                cellArray.insertNextCell([triangle_2nd[3], triangle_2nd[4], triangle_2nd[5]]);
                                    totalElements += 4;
                                }
                            }
                        }
                    }
                    
                    // Only include faces data if no cells data was processed
                    if (totalElements === 0 && window.faces && window.faces.length > 0) {
                        console.log(`Falling back to ${window.faces.length} faces for surface view`);
                    for (let i = 0; i < window.faces.length; i++) {
                        const face = window.faces[i];
                        if (Array.isArray(face) && face.length >= 3) {
                            if (face.length === 3) {
                                cellArray.insertNextCell(face);
                                    totalElements++;
                            } else if (face.length === 4) {
                                // Split quad into two triangles
                                cellArray.insertNextCell([face[0], face[1], face[2]]);
                                cellArray.insertNextCell([face[0], face[2], face[3]]);
                                    totalElements += 2;
                                }
                            }
                        }
                    }
                } else if (viewType === 'volume') {
                    // Volume view: show ALL elements (volume + surface)
                    console.log('Processing ALL elements for volume view');
                    
                    if (window.cells && Object.keys(window.cells).length > 0) {
                        // Process ALL elements from GMSH
                        for (const [cellType, cellData] of Object.entries(window.cells)) {
                            console.log(`Processing cell type: ${cellType}, count: ${cellData.length}`);
                            if (cellData && cellData.length > 0) {
                                for (let i = 0; i < cellData.length; i++) {
                                    const cell = cellData[i];
                                    if (Array.isArray(cell)) {
                                        // Process all element types
                                        if (cellType === 'tetrahedron' && cell.length === 4) {
                                            console.log(`Processing tetrahedron element ${i}`);
                                            cellArray.insertNextCell(cell);
                                            totalElements++;
                                        } else if (cellType === 'tetrahedron_2nd' && cell.length === 10) {
                                            console.log(`Processing tetrahedron_2nd element ${i}`);
                                            // For volume view, subdivide second-order tetrahedrons into 8 first-order tetrahedrons
                                            // Corner nodes: 0, 1, 2, 3
                                            // Mid-edge nodes: 4, 5, 6, 7, 8, 9 (edges 0-1, 1-2, 2-0, 0-3, 1-3, 2-3)
                                            
                                            // 8 tetrahedrons covering the entire second-order tetrahedron
                                            cellArray.insertNextCell([cell[0], cell[4], cell[6], cell[7]]);
                                            cellArray.insertNextCell([cell[4], cell[1], cell[5], cell[8]]);
                                            cellArray.insertNextCell([cell[6], cell[5], cell[2], cell[9]]);
                                            cellArray.insertNextCell([cell[7], cell[8], cell[9], cell[3]]);
                                            cellArray.insertNextCell([cell[4], cell[6], cell[7], cell[8]]);
                                            cellArray.insertNextCell([cell[4], cell[5], cell[6], cell[8]]);
                                            cellArray.insertNextCell([cell[5], cell[6], cell[8], cell[9]]);
                                            cellArray.insertNextCell([cell[6], cell[7], cell[8], cell[9]]);
                                            totalElements += 8;
                                        } else if (cellType === 'hexahedron' && cell.length === 8) {
                                            cellArray.insertNextCell(cell);
                                            totalElements++;
                                        } else if (cellType === 'triangle' && cell.length === 3) {
                                            cellArray.insertNextCell(cell);
                                            totalElements++;
                                        } else if (cellType === 'triangle_2nd' && cell.length === 6) {
                                            console.log(`Processing triangle_2nd element ${i}`);
                                            // Convert 2nd order triangle (6 nodes) to 3 linear triangles
                                            const v0 = cell[0], v1 = cell[1], v2 = cell[2];
                                            const v3 = cell[3], v4 = cell[4], v5 = cell[5];
                                            
                                            // 3 linear triangles
                                            cellArray.insertNextCell([v0, v3, v4]);
                                            cellArray.insertNextCell([v1, v4, v5]);
                                            cellArray.insertNextCell([v2, v5, v3]);
                                            totalElements += 3;
                                        } else if (cellType === 'line_2nd' && cell.length === 3) {
                                            console.log(`Processing line_2nd element ${i}`);
                                            // Convert 2nd order line (3 nodes) to 2 linear segments
                                            const v0 = cell[0], v1 = cell[1], v2 = cell[2];
                                            
                                            // 2 linear segments
                                            cellArray.insertNextCell([v0, v1]);
                                            cellArray.insertNextCell([v1, v2]);
                                            totalElements += 2;
                                        } else if (cellType === 'quad' && cell.length === 4) {
                                            cellArray.insertNextCell(cell);
                                            totalElements++;
                                        } else {
                                            console.log(`UNHANDLED cell type: ${cellType}, length: ${cell.length}`);
                                        }
                                    }
                                }
                            }
                        }
                    }
                    
                    // Fallback to faces if no cells data available
                    if (totalElements === 0 && window.faces && window.faces.length > 0) {
                        console.log(`Falling back to ${window.faces.length} regular faces for volume view`);
                for (let i = 0; i < window.faces.length; i++) {
                    const face = window.faces[i];
                            if (Array.isArray(face) && face.length >= 3) {
                                if (face.length === 3) {
                                    cellArray.insertNextCell(face);
                                    totalElements++;
                                } else if (face.length === 4) {
                                    // Split quad into two triangles
                                    cellArray.insertNextCell([face[0], face[1], face[2]]);
                                    cellArray.insertNextCell([face[0], face[2], face[3]]);
                                    totalElements += 2;
                                }
                            }
                        }
                    }
                }
                
                if (totalElements > 0) {
                    polydata.setPolys(cellArray);
                }
            }
            
            // Create mapper and actor
            const mapper = vtk.Rendering.Core.vtkMapper.newInstance();
            mapper.setInputData(polydata);
            
            const actor = vtk.Rendering.Core.vtkActor.newInstance();
            actor.setMapper(mapper);
            
            // Set actor properties based on representation
            const actorProps = actor.getProperty();
            if (representation === 0) {
                actorProps.setRepresentation(0); // Points
                actorProps.setPointSize(3);
                actorProps.setColor(0, 1, 0); // Green
            } else if (representation === 1) {
                // Wireframe representation
                actorProps.setRepresentation(1); // Wireframe
                actorProps.setLineWidth(2);
                actorProps.setEdgeVisibility(true);
                actorProps.setColor(0, 1, 0); // Green
                
                // Wireframe shows different edges based on view type
            } else {
                // Surface representation
                actorProps.setRepresentation(2); // Surface
                actorProps.setOpacity(0.8);
                actorProps.setColor(0, 1, 0); // Green
                actorProps.setEdgeVisibility(true);
                actorProps.setLineWidth(1);
            }
            
            // Add actor to renderer
            window.renderer.addActor(actor);
            window.actor = actor;
            
            // Set up camera
            const camera = window.renderer.getActiveCamera();
            const bounds = polydata.getBounds();
            const center = [
                (bounds[0] + bounds[1]) / 2,
                (bounds[2] + bounds[3]) / 2,
                (bounds[4] + bounds[5]) / 2
            ];
            
            const size = Math.max(bounds[1] - bounds[0], bounds[3] - bounds[2], bounds[5] - bounds[4]);
            const distance = size * 2;
            
            camera.setPosition(center[0], center[1], center[2] + distance);
            camera.setFocalPoint(center[0], center[1], center[2]);
            camera.setViewUp(0, 1, 0);
            
            // Force render
            window.renderWindow.render();
            
            console.log(`${viewType} mesh created: ${totalElements} elements`);
            
            // Update mesh statistics
            updateInfo();
        }
        
        function updateInfo() {
            const fullMeshData = window.meshData;
            const faces = window.faces;
            const cells = window.cells;
            
            // Extract vertices array - handle both object format and flat array format
            let vertices;
            if (fullMeshData) {
                if (fullMeshData.vertices) {
                    // Object format with vertices property
                    vertices = fullMeshData.vertices;
                } else if (Array.isArray(fullMeshData)) {
                    // Flat array format
                    vertices = fullMeshData;
                } else {
                    vertices = null;
                }
            } else {
                vertices = null;
            }
            
            // Calculate vertex count - handle both nested and flat formats
            let vertexCount = 0;
            if (vertices) {
                if (Array.isArray(vertices) && vertices.length > 0) {
                    if (Array.isArray(vertices[0])) {
                        // Nested format: [[x,y,z], [x,y,z], ...]
                        vertexCount = vertices.length;
                    } else if (typeof vertices[0] === 'number') {
                        // Flat format: [x,y,z,x,y,z,...]
                        vertexCount = vertices.length / 3;
                    }
                }
            }
            
            document.getElementById('vertex-count').textContent = vertexCount;
            document.getElementById('face-count').textContent = faces ? faces.length : 0;
            
            // Set mesh type based on dimension
            if (window.meshDimension === 1) {
                document.getElementById('mesh-type').textContent = '1D Mesh';
            } else if (window.meshDimension === 2) {
                document.getElementById('mesh-type').textContent = '2D Mesh';
            } else {
                document.getElementById('mesh-type').textContent = '3D Mesh';
            }
            
        }
        
        // Field mapping functions removed from mesh preview
        
        // All field visualization and colorbar functionality removed from mesh preview
        
        
        window.addEventListener('resize', function() {
            if (renderWindow && renderWindow.getViews()[0]) {
                const vtkContainer = document.getElementById('vtk-container');
                const openGLRenderWindow = renderWindow.getViews()[0];
                openGLRenderWindow.setSize(window.vtkContainer.clientWidth, window.vtkContainer.clientHeight);
                renderWindow.render();
            }
        });
    </script>
</body>
</html>